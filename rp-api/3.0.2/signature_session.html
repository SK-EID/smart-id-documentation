<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>signature session :: RP API integration guidance</title>
    <link rel="canonical" href="https://sk-eid.github.io/smart-id-documentation/rp-api/3.0.3/signature_session.html">
    <meta name="generator" content="Antora 3.1.7">
    <link rel="stylesheet" href="../../_/css/site.css">
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item logo" href="https://www.skidsolutions.eu/"><svg viewBox="0 0 250 59.99"><defs><style>.sk-logo{fill:#fff;}</style></defs><g><g><path class="sk-logo" d="M30,0A30,30,0,1,0,60,30,30,30,0,0,0,30,0m0,56.56A26.57,26.57,0,1,1,56.56,30,26.56,26.56,0,0,1,30,56.56m-5.89-29a5.89,5.89,0,0,1,4.68,5.93,8.52,8.52,0,0,1-.17,1.63c-.84,3.68-4.1,5.32-7.44,5.32a13.51,13.51,0,0,1-1.5-.09c-2.32-.3-6.76-2.49-6.76-5.48a2.75,2.75,0,0,1,.27-1.17,1.87,1.87,0,0,1,1.71-1.1c1.21,0,1.93,1.13,2.6,2a3.14,3.14,0,0,0,1,.78,4.65,4.65,0,0,0,2,.69l.56,0h.35c1.41,0,3.14-.72,3.14-2.48a1.6,1.6,0,0,0-.72-1.47,2.82,2.82,0,0,0-.92-.38l-.79-.22-2.69-.65-.75-.19c-3.1-.89-5.09-2.73-5.09-5.69a6.92,6.92,0,0,1,.3-2,5.91,5.91,0,0,1,2.48-3.32,8,8,0,0,1,4.48-1.25h.55a6.44,6.44,0,0,1,1,.11,7.15,7.15,0,0,1,2.21.62,8.24,8.24,0,0,1,1.79,1c1.14.92,2.34,2.13,1.39,3.77a2,2,0,0,1-1.37,1,2.08,2.08,0,0,1-1.52-.32l-.72-.6-.43-.32a4.39,4.39,0,0,0-3-1c-1,0-2.4.3-2.75,1.45a2,2,0,0,0-.1.56c0,.48.29,1.15,2.05,1.68l.55.16.38.1.84.21,1.17.3.5.07.81.22M46.68,37a2.42,2.42,0,0,1,.4,1.29,2.17,2.17,0,0,1-1.46,2.1,3.51,3.51,0,0,1-.65.09,2.35,2.35,0,0,1-1.72-.8l-6.71-7.15v5.31c0,1.22-.45,2.7-2,2.7a2.18,2.18,0,0,1-2.13-2.36v-17c0-1.27.49-2.73,2.09-2.73a1.94,1.94,0,0,1,2.09,1.83V26l6.13-6.48a2.93,2.93,0,0,1,1.43-.89,2.07,2.07,0,0,1,2.32,1.62,2.57,2.57,0,0,1-.84,2.45l-6.36,6.51,7,7.22Zm25.49,2.71c0,.45-.12.64-.57.64H69.65c-.41,0-.57-.19-.57-.64V19.34c0-.44.16-.63.57-.63H71.6c.45,0,.57.19.57.63Zm5.74.64c-.38,0-.51-.22-.51-.64V19.34c0-.44.16-.63.58-.63h6.66c5.46,0,7.27,2.29,7.27,4.91V35.48c0,2.61-1.81,4.91-7.27,4.91Zm2.59-19V37.74h4.14c2.87,0,4.15-1.05,4.15-2.77V24.13c0-1.73-1.28-2.78-4.15-2.78Zm34.92,1.79c0-1.91-1-3.25-4.75-3.25s-4.76,1.34-4.76,3.25v1.18a2.84,2.84,0,0,0,2,2.71l6.13,2.33c1.59.6,3.19,1.81,3.19,4v2.81c0,2.49-1.53,4.5-6.61,4.5s-6.63-2-6.63-4.5V34.49c0-.29.13-.41.38-.41h.93c.25,0,.38.12.38.41V36c0,1.91,1.18,3.25,4.91,3.25s5-1.34,5-3.25V33.69c0-1.72-1.41-2.48-2.65-3L107,28.43a4.07,4.07,0,0,1-2.74-3.76V23c0-2.49,1.4-4.5,6.41-4.5s6.41,2,6.41,4.5v1.56c0,.25-.1.38-.39.38h-.92c-.26,0-.35-.13-.35-.38Zm6.82-.19c0-2.49,1.53-4.5,6.64-4.5s6.69,2,6.69,4.5v13.2c0,2.49-1.56,4.5-6.69,4.5s-6.64-2-6.64-4.5Zm11.61.25c0-1.94-1.24-3.28-5-3.28s-4.95,1.34-4.95,3.28V35.89c0,2,1.25,3.29,4.95,3.29s5-1.34,5-3.29ZM143,38.92h9.44c.26,0,.39.1.39.39V40c0,.29-.13.38-.39.38H141.63c-.19,0-.32-.13-.32-.38V19.09a.34.34,0,0,1,.39-.39h1c.26,0,.35.13.35.39Zm15.57-3c0,2,1.24,3.29,5,3.29s5-1.34,5-3.29V19.09a.33.33,0,0,1,.38-.38h1c.25,0,.35.12.35.38V36.15c0,2.49-1.53,4.5-6.67,4.5s-6.66-2-6.66-4.5V19.09a.33.33,0,0,1,.38-.38h1c.25,0,.35.12.35.38Zm28.8-17.18c.25,0,.38.09.38.38v.7c0,.29-.13.38-.38.38h-5.81V40c0,.25-.09.38-.35.38h-1c-.28,0-.38-.13-.38-.38V20.17H174.1c-.29,0-.38-.09-.38-.38v-.7c0-.29.09-.38.38-.38ZM193.14,40c0,.25-.1.38-.35.38h-1a.34.34,0,0,1-.38-.38V19.09a.33.33,0,0,1,.38-.38h1c.25,0,.35.12.35.38ZM198.91,23c0-2.49,1.53-4.5,6.63-4.5s6.7,2,6.7,4.5v13.2c0,2.49-1.56,4.5-6.7,4.5s-6.63-2-6.63-4.5Zm11.61.25c0-1.94-1.25-3.28-5-3.28s-4.94,1.34-4.94,3.28V35.89c0,2,1.24,3.29,4.94,3.29s5-1.34,5-3.29ZM231.28,40c0,.25-.1.38-.35.38h-.86a.33.33,0,0,1-.35-.19L220.6,24a17.53,17.53,0,0,1-1-1.92V40c0,.25-.1.38-.35.38h-.87A.34.34,0,0,1,218,40V19.09a.33.33,0,0,1,.38-.38h.87a.35.35,0,0,1,.31.15l9.22,16.36c.29.52.93,1.82.93,1.82V19.09a.33.33,0,0,1,.38-.38h.86c.25,0,.35.12.35.38Zm16.9-16.87c0-1.91-1.05-3.25-4.75-3.25s-4.75,1.34-4.75,3.25v1.18a2.84,2.84,0,0,0,2,2.71l6.12,2.33c1.6.6,3.19,1.81,3.19,4v2.81c0,2.49-1.53,4.5-6.6,4.5s-6.63-2-6.63-4.5V34.49c0-.29.12-.41.38-.41h.92c.26,0,.39.12.39.41V36c0,1.91,1.18,3.25,4.91,3.25s5-1.34,5-3.25V33.69c0-1.72-1.4-2.48-2.64-3l-5.94-2.3A4.09,4.09,0,0,1,237,24.67V23c0-2.49,1.4-4.5,6.41-4.5s6.41,2,6.41,4.5v1.56c0,.25-.09.38-.38.38h-.93c-.25,0-.35-.13-.35-.38Z"></path></g></g></svg></a>
      <a class="navbar-item" href="https://sk-eid.github.io/smart-id-documentation">RP API integration guidance</a>
      <div class="navbar-item search hide-for-print">
        <div id="search-field" class="field">
          <input id="search-input" type="text" placeholder="Search the docs">
        </div>
      </div>
      <button class="navbar-burger" aria-controls="topbar-nav" aria-expanded="false" aria-label="Toggle main menu">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
    </div>
  </nav>
</header><div class="body">
<div class="nav-container" data-component="rp-api" data-version="3.0.2">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <button class="nav-menu-toggle" aria-label="Toggle expand/collapse all" style="display: none"></button>
    <h3 class="title"><a href="introduction.html">RP API documentation</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="introduction.html">Introduction</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="glossary.html">Terms and glossary</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="changes.html">Changes</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="sessions.html">Session types</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="authentication_session.html"><code>authentication</code> session</a>
  </li>
  <li class="nav-item is-current-page" data-depth="2">
    <a class="nav-link" href="signature_session.html"><code>signature</code> session</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="certificatechoice_session.html"><code>certificatechoice</code> session</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="session_status.html"><code>session</code> status</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="dynamic_link_flows.html">Dynamic link flows</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="notification_based_flows.html">Notification based flows</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="response_verification.html">Response verification</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="object_references.html">REST object references</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="signature_protocols.html">Signature protocols</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="interactions.html">Interactions</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="request_properties.html">Additional request properties</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="api_details.html">REST API details</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="secure.html">Secure Implementation Guide</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">RP API documentation</span>
    <span class="version">3.0.2</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <div class="title"><a href="../3.0.3/introduction.html">RP API documentation</a></div>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../3.0.3/introduction.html">3.0.3</a>
        </li>
        <li class="version is-current">
          <a href="introduction.html">3.0.2</a>
        </li>
        <li class="version">
          <a href="../3.0.1/introduction.html">3.0.1</a>
        </li>
        <li class="version">
          <a href="../3.0.0/introduction.html">3.0.0</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../3.0.3/introduction.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="introduction.html">RP API documentation</a></li>
    <li><a href="sessions.html">Session types</a></li>
    <li><a href="signature_session.html"><code>signature</code> session</a></li>
  </ul>
</nav>
<div class="page-versions">
  <button class="version-menu-toggle" title="Show other versions of page">3.0.2</button>
  <div class="version-menu">
    <a class="version" href="../3.0.3/signature_session.html">3.0.3</a>
    <a class="version is-current" href="signature_session.html">3.0.2</a>
    <a class="version" href="../3.0.1/signature_session.html">3.0.1</a>
    <a class="version" href="../3.0.0/signature_session.html">3.0.0</a>
  </div>
</div>
</div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page"><code>signature</code> session</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>There are two main modes of <code>signature</code> session and Relying Party must choose carefully between them. They look like the ones used in case of the <code>authentication</code> session, but there are important differences.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>Signature by document number.</strong> This is the main and common usage scenario. Document number can be obtained from result of <code>certificatechoice</code> session or previous <code>authentication</code> session result. Signatures utilizing any of the *AdES signature schemes that include the certificate as part of signature must use this method. Otherwise, the signature may be given by the person specified, but not using the key pair corresponding to the certificate chosen by Relying Party.</p>
</li>
<li>
<p><strong>Signature by person&#8217;s identifier.</strong> This method should only be used if it is acceptable that the end user gives the signature using any of the Smart-ID devices in their possession.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><code>signature</code> session creation requests accept QSCD (Qualified Signature Creation Device) as a certificate level parameter. This is a shortcut marking a certificate of <code>QUALIFIED</code> level which is also QSCD-capable. <code>ADVANCED</code> certificates cannot be QSCD-capable.</p>
</div>
<div class="paragraph">
<p>The signature protocol <a href="signature_protocols.html#raw_digest_signature" class="xref page"><code>RAW_DIGEST_SIGNATURE</code></a> must be used for signing.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_dynamic_link_based_signature_session"><a class="anchor" href="#_dynamic_link_based_signature_session"></a>Dynamic link based <code>signature</code> session</h2>
<div class="sectionbody">
<table class="tableblock frame-none grid-none stripes-odd stretch">
<caption class="title">Signing endpoints</caption>
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 88.8889%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Method</th>
<th class="tableblock halign-left valign-top">URL</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>POST</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>BASE/v3/signature/dynamic-link/etsi/:id-etsi-qcs-SemanticsId-Natural</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>POST</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>BASE/v3/signature/dynamic-link/document/:documentnumber</code></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>This method is the main entry point to signature logic for the dynamic link based flows.</p>
</div>
<div class="sect2">
<h3 id="_error_conditions"><a class="anchor" href="#_error_conditions"></a>Error conditions</h3>
<div class="ulist">
<ul>
<li>
<p>HTTP error code <code>403</code> - Relying Party has no permission to issue the request. This may happen when:</p>
<div class="ulist">
<ul>
<li>
<p>Relying Party has no permission to invoke operations on accounts with <code>ADVANCED</code> certificates.</p>
</li>
<li>
<p>Relying Party has no permission to use requested capability.</p>
</li>
</ul>
</div>
</li>
<li>
<p>HTTP error code <code>404</code> - object described in URL was not found, essentially meaning that the user does not have an account in Smart-ID system.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_request_parameters"><a class="anchor" href="#_request_parameters"></a>Request parameters</h3>
<table class="tableblock frame-none grid-none stripes-odd stretch">
<caption class="title">Dynamic link based <code>signature</code> request parameters</caption>
<colgroup>
<col style="width: 24%;">
<col style="width: 12%;">
<col style="width: 4%;">
<col style="width: 60%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Mandatory</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>relyingPartyUUID</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">+</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">UUID of Relying Party.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>relyingPartyName</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">+</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">RP friendly name, one of those configured for particular RP. Limited to 32 bytes in UTF-8 encoding.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>certificateLevel</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Level of certificate requested. <code>ADVANCED</code>/<code>QUALIFIED</code>/<code>QSCD</code>, <code>QUALIFIED</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>signatureProtocol</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">+</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Signature protocol. Describes the <code>signatureProtocolParameters</code> object. Currently, the only allowed value is:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>RAW_DIGEST_SIGNATURE</code> - scheme where user-provided digest is signed directly (similarly to RP-API v1 and v2). For more details see section <a href="signature_protocols.html#raw_digest_signature" class="xref page"><code>RAW_DIGEST_SIGNATURE</code></a>.</p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>signatureProtocolParameters</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">object</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">+</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An object describing the parameters for the signature algorithm. Its structure depends on the <code>signatureProtocol</code> used. See <a href="signature_protocols.html#raw_digest_signature_param" class="xref page"><code>RAW_DIGEST_SIGNATURE</code> parameters table</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>allowedInteractionsOrder</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">array of objects</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">+</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">See section <a href="interactions.html#available-interactions" class="xref page">available interactions</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>nonce</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Random string, up to 30 characters. If present, must have at least 1 character.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>requestProperties</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">object</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>A request properties object. Currently, only one property is supported:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>shareMdClientIpAddress</code> - Whether the RP API server should share user mobile device IP address with the RP. By default it is set to <code>false</code>. The RP must have proper privilege to use this property. See section <a href="request_properties.html#ip_sharing" class="xref page">IP sharing</a> for details.</p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>capabilities</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">array</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Used only when agreed with Smart-ID provider. When omitted request capabilities are derived from <code>certificateLevel</code> parameter.</p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Dynamic link based <code>signature</code> request example</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
  "relyingPartyUUID": "1f1bfa89-4f8b-420a-a98e-fb3a161a30bc",
  "relyingPartyName": "DEMO",
  "certificateLevel": "QUALIFIED",
  "signatureProtocol": "RAW_DIGEST_SIGNATURE",
  "signatureProtocolParameters": {
    "digest": "ZHNmYmhkZmdoZGcgZmRmMTM0NTM...",
    "signatureAlgorithm": "sha512WithRSAEncryption"
  },
  "nonce": "d8XkbEnA0WsE0PvBZZoxGnPI4ml9qk",
  "allowedInteractionsOrder": [
    {
      "type": "confirmationMessage",
      "displayText200": "Longer description of the transaction context"
    },
    {
      "type": "displayTextAndPIN",
      "displayText60": "Short description of the transaction context"
    }
  ],
  "requestProperties": {
    "shareMdClientIpAddress": false
  }
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_response_structure"><a class="anchor" href="#_response_structure"></a>Response structure</h3>
<table class="tableblock frame-none grid-none stripes-odd stretch">
<caption class="title">Dynamic link based <code>signature</code> session creation response parameters</caption>
<colgroup>
<col style="width: 12.5%;">
<col style="width: 12.5%;">
<col style="width: 12.5%;">
<col style="width: 62.5%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Mandatory</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>sessionID</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">+</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A string that can be used to request the operation result.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>sessionToken</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">+</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Unique random value that will be used to connect this signature attempt between the relevant parties (RP, RP-API, mobile app).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>sessionSecret</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">+</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Base64-encoded random key value that should be kept in secret and should be shared only between the RP backend and RP-API server.</p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Dynamic link based <code>signature</code> session creation response</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
  "sessionID": "de305d54-75b4-431b-adb2-eb6b9e546014",
  "sessionToken": "hyBdQYUeQtvXEPqWC7K8a97L",
  "sessionSecret": "dztL7Ur49D/YYgUzYl4sMg=="
}</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_notification_based_signature_session"><a class="anchor" href="#_notification_based_signature_session"></a>Notification based <code>signature</code> session</h2>
<div class="sectionbody">
<table class="tableblock frame-none grid-none stripes-odd stretch">
<caption class="title">Signing endpoints</caption>
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 88.8889%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Method</th>
<th class="tableblock halign-left valign-top">URL</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>POST</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>BASE/v3/signature/notification/etsi/:id-etsi-qcs-SemanticsId-Natural</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>POST</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>BASE/v3/signature/notification/document/:documentnumber</code></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>This method is the main entry point to signature logic for the notification based flows.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>In order to improve security and prevent phishing attacks, it is recommended to only allow notification based flows on devices and browsers that have successfully completed a dynamic link based flow. Setting up a unique device identifier is left to the RP to implement.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="_error_conditions_2"><a class="anchor" href="#_error_conditions_2"></a>Error conditions</h3>
<div class="ulist">
<ul>
<li>
<p>HTTP error code <code>403</code> - Relying Party has no permission to issue the request. This may happen when:</p>
<div class="ulist">
<ul>
<li>
<p>Relying Party has no permission to invoke operations on accounts with <code>ADVANCED</code> certificates.</p>
</li>
<li>
<p>Relying Party has no permission to use requested capability.</p>
</li>
</ul>
</div>
</li>
<li>
<p>HTTP error code <code>404</code> - object described in URL was not found, essentially meaning that the user does not have an account in Smart-ID system.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_request_parameters_2"><a class="anchor" href="#_request_parameters_2"></a>Request parameters</h3>
<table class="tableblock frame-none grid-none stripes-odd stretch">
<caption class="title">Notification based <code>signature</code> request parameters</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 8.3333%;">
<col style="width: 4.1666%;">
<col style="width: 62.5001%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Mandatory</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>relyingPartyUUID</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">+</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">UUID of Relying Party.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>relyingPartyName</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">+</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">RP friendly name, one of those configured for particular RP. Limited to 32 bytes in UTF-8 encoding.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>certificateLevel</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Level of certificate requested. <code>ADVANCED</code>/<code>QUALIFIED</code>/<code>QSCD</code>, <code>QUALIFIED</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>signatureProtocol</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">+</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Signature protocol. Describes the <code>signatureProtocolParameters</code> object. Currently, the only allowed value is:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>RAW_DIGEST_SIGNATURE</code> - scheme where user-provided digest is signed directly (similarly to RP-API v1 and v2). For more details see section <a href="signature_protocols.html#raw_digest_signature" class="xref page"><code>RAW_DIGEST_SIGNATURE</code></a>.</p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>signatureProtocolParameters</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">object</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">+</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An object describing the parameters for the signature algorithm. Its structure depends on the <code>signatureProtocol</code> used. See <a href="signature_protocols.html#raw_digest_signature_param" class="xref page"><code>RAW_DIGEST_SIGNATURE</code> parameters table</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>nonce</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Random string, up to 30 characters. If present, must have at least 1 character.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>allowedInteractionsOrder</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">object</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">+</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">See section <a href="interactions.html#available-interactions" class="xref page">available interactions</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>requestProperties</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">object</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>A request properties object. Currently, only one property is supported:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>shareMdClientIpAddress</code> - Whether the RP API server should share user mobile device IP address with the RP. By default it is set to <code>false</code>. The RP must have proper privilege to use this property. See section <a href="request_properties.html#ip_sharing" class="xref page">IP sharing</a> for details.</p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>capabilities</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">array</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Used only when agreed with Smart-ID provider. When omitted request capabilities are derived from <code>certificateLevel</code> parameter.</p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Notification based <code>signature</code> request example</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
  "relyingPartyUUID": "1f1bfa89-4f8b-420a-a98e-fb3a161a30bc",
  "relyingPartyName": "DEMO",
  "certificateLevel": "QUALIFIED",
  "signatureProtocol": "RAW_DIGEST_SIGNATURE",
  "signatureProtocolParameters": {
    "digest": "ZHNmYmhkZmdoZGcgZmRmMTM0NTM...",
    "signatureAlgorithm": "sha512WithRSAEncryption"
  },
  "nonce": "d8XkbEnA0WsE0PvBZZoxGnPI4ml9qk",
  "allowedInteractionsOrder": [
    {
      "type": "confirmationMessage",
      "displayText200": "Longer description of the transaction context"
    },
    {
      "type": "displayTextAndPIN",
      "displayText60": "Short description of the transaction context"
    }
  ],
  "requestProperties": {
    "shareMdClientIpAddress": false
  }
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_response_structure_2"><a class="anchor" href="#_response_structure_2"></a>Response structure</h3>
<table class="tableblock frame-none grid-none stripes-odd stretch">
<caption class="title">Notification based <code>signature</code> session creation response parameters</caption>
<colgroup>
<col style="width: 12.5%;">
<col style="width: 12.5%;">
<col style="width: 12.5%;">
<col style="width: 62.5%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Mandatory</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>sessionID</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">+</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A string that can be used to request the operation result.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>vc</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">+</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Object describing the VC code to be displayed by RP. See section <a href="notification_based_flows.html#vc-codes" class="xref page">VC codes</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>vc.type</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">+</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Type of the VC code. Currently, the only allowed type is <code>alphaNumeric4</code>. Note that the type is "alphaNumeric4" to refer to the fact that in the future the 4-symbol code might also contain letters. For the time being, only numeric values are returned for technical reasons. This may change in the future, so RPs should make no assumptions about it containing numeric data only!</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>vc.value</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">+</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Value of the VC code.</p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Notification based <code>signature</code> session creation response</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
  "sessionID": "ce305d54-45b4-a31b-2db2-fb6b9e546015",
  "vc": {
    "type": "alphaNumeric4",
    "value": "4927"
  }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</article>
  </div>
</main>
</div>
<footer class="footer">
  <p>© 2024 SK ID Solutions AS</p>
</footer>
<script id="site-script" src="../../_/js/site.js" data-ui-root-path="../../_"></script>
<script async src="../../_/js/vendor/highlight.js"></script>
<script src="../../_/js/vendor/lunr.js"></script>
<script src="../../_/js/search-ui.js" id="search-ui-script" data-site-root-path="../.." data-snippet-length="100" data-stylesheet="../../_/css/search.css"></script>
<script async src="../../search-index.js"></script>
  </body>
</html>
