<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Additional security measures :: Smart-ID documentation</title>
    <link rel="canonical" href="https://sk-eid.github.io/smart-id-documentation/rp-api/additional_security_measures.html">
    <meta name="generator" content="Antora 3.1.10">
    <link rel="stylesheet" href="../../_/css/site.css">

<link rel="icon" href="../../_/img/favicon.svg" type="image/x-icon">
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://sk-eid.github.io/smart-id-documentation">
        <img src="../../_/img/sk-id-solutions.svg" class="logo" />
      </a>
      <span class="separator"></span>
      <span class="title">Smart-ID documentation</span>
    </div>

    <div class="navbar-right">
      <div class="navbar-item search hide-for-print">
        <div id="search-field" class="field">
          <input id="search-input" type="text" placeholder="Search the docs">
        </div>
      </div>
      <button class="nav-toggle"></button>    </div>

  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="rp-api" data-version="3.1.4">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="introduction.html">Relying Party API</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <span class="nav-text">Smart-ID Documentation</span>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../index.html">Getting started</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../demo.html">Try out</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../implementation.html">Smart-ID integration</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../environments.html">Environments</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../device_link.html">Device-link fallback page</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../https_pinning.html">Implementing HTTPS pinning</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../client_libraries.html">Client libraries</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../logos.html">Logos</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../test_accounts.html">Test accounts</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../contact.html">Contact</a>
  </li>
  <li class="nav-item" data-depth="1">
    <span class="nav-text">Relying Party API</span>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../introduction.html">Introduction</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../introduction.html">Introduction</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../changes.html">Changes</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../glossary.html">Glossary</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../device_link_flows.html">Device link flows</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../authcode.html"><code>authCode</code> calculation</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../notification_based_flows.html">Notification based flows</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../api_specification.html">OpenAPI specification</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../api_details.html">API technical description</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../interactions.html">Interactions</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../signature_protocols.html">Signature protocols</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../callback_urls.html">Callback URLs</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../response_verification.html">Response verification</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../additional_security_measures.html">Additional security measures</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Relying Party API</span>
    <span class="version">3.1.4</span>
  </div>
  <ul class="components">
    <li class="component">
      <div class="title"><a href="../../index.html">Documentation</a></div>
    </li>
    <li class="component is-current">
      <div class="title"><a href="../introduction.html">Relying Party API</a></div>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../introduction.html">3.1.6</a>
        </li>
        <li class="version">
          <a href="../3.1.5/introduction.html">3.1.5</a>
        </li>
        <li class="version is-current">
          <a href="introduction.html">3.1.4</a>
        </li>
        <li class="version">
          <a href="../3.1.3/introduction.html">3.1.3</a>
        </li>
        <li class="version">
          <a href="../3.0.3/introduction.html">3.0.3</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
  <div class="content">
<aside class="toc sidebar" data-title="On this page" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">Additional security measures</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>This page lists additional security measures which can be deployed by the RP in order to protect from phishing threats and attacks.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_anonymous_flows_and_user_identifiers"><a class="anchor" href="#_anonymous_flows_and_user_identifiers"></a>Anonymous flows and user identifiers</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Commonly Smart-ID is used together with national identity numbers, however these national identity numbers might not be secret and could be enumerated. A better approach is to use anonymous device links which require the user to initiate the authentication process.</p>
</div>
<div class="paragraph">
<p>If the anonymous device links can&#8217;t be used for some reason, then the RP may ask for national identity number and a non-public identifier as well. This non-public identifier can be a username the users can choose, the account contract number or something else only the user knows.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_keeping_track_of_trusted_and_unknown_browsers"><a class="anchor" href="#_keeping_track_of_trusted_and_unknown_browsers"></a>Keeping track of trusted and unknown browsers</h2>
<div class="sectionbody">
<div class="paragraph">
<p>A useful security measure is to keep track of trusted browser instances for each user. This allows the RP to take different actions whenever the user is connecting from their usual (trusted) browser or attempting to log in from a previously unseen, unknown browser. In case of the latter, an attacker may be attempting a phishing attack and the RP could ask for more information or alert the user.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="title">IMPORTANT</div>
<div class="paragraph">
<p>Using the User-Agent field for device/browser identification is <strong>not secure</strong> and should be avoided as it can be easily spoofed by a malicious party.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The following are recommendations for setting up tracking for trusted and unknown browsers:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The tracking must be done with an HTTP cookie (or with similar client-side storage features supported by modern browsers) with the content of randomly generated identifier (<code>trackingID</code>).</p>
</li>
<li>
<p>The fact about placing such a cookie in the browser of the user must be declared in the public cookie policy.</p>
</li>
<li>
<p>The RP database must keep previously seen browsers with the randomly generated identifier hash (<code>hashedTrackingID</code>), and the RP may allow the user to edit the names of the known browsers.</p>
</li>
<li>
<p>The browser cookie must be set with <code>Secure</code> and <code>HttpOnly</code> flags, and the scope of the cookie must be the URL of the RP&#8217;s website.</p>
</li>
<li>
<p>The RP website or app must allow the user to invalidate all the cookies on the RP server.</p>
</li>
<li>
<p>A simple algorithm to set the <code>hashedTrackingID</code> for the user and browser combination can be used:</p>
<div class="ulist">
<ul>
<li>
<p>If a valid <code>trackingID</code> is not present, and authentication succeeds, set the <code>trackingID</code> and save it in the database for the particular user and browser combination.</p>
</li>
<li>
<p>If a valid <code>trackingID</code> for the particular user and browser combination is present, the browser can be trusted.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Additional security measures can be used if a new connection from an unknown browser is made, such as:</p>
<div class="ulist">
<ul>
<li>
<p>asking for the user&#8217;s national identity number,</p>
</li>
<li>
<p>sending an email or notification alert to the user,</p>
</li>
<li>
<p>using a different <code>displayText</code> for the authentication session such as "Authentication started from an unknown browser. Are you using a new computer?".</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_keeping_track_of_suspicious_and_malicious_ip_addresses"><a class="anchor" href="#_keeping_track_of_suspicious_and_malicious_ip_addresses"></a>Keeping track of suspicious and malicious IP addresses</h2>
<div class="sectionbody">
<div class="paragraph">
<p>When a user connects to the RP&#8217;s website or the app, it connects from the IP address of the user&#8217;s device. In case an attacker makes the connection or in case the attacker proxies the connection, the RP will see the attacker&#8217;s or proxy&#8217;s IP address.</p>
</div>
<div class="paragraph">
<p>There are commercial services that can provide general information about IP addresses. For example, they can tell if the IP address is known to be used for:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>sending spam messages, which may indicate the user connecting from such an IP address might be using a compromised computer,</p>
</li>
<li>
<p>is known to be an open HTTP proxy host, which may indicate that the user connecting from such an IP address might be using a compromised computer or that an attacker might be using this host to proxy their connection to the RP&#8217;s website or the app,</p>
</li>
<li>
<p>is known to be used as a TOR exit node or an anonymizing VPN service, which may indicate that the attacker could be using this to hide their connection to the RP&#8217;s website or the app,</p>
</li>
<li>
<p>is known to be an IP address of a hosting provider, data-centre or content delivery network, which may indicate that the requests might be used to perform denial-of-service or data mining attacks.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In addition to such commercial services, RP&#8217;s own incident resolution team or security monitoring team could provide a list of IP addresses that are related to known incidents or suspicious activities.</p>
</div>
<div class="paragraph">
<p>Additional security measures can be used if the IP address is determined to be suspicious, such as:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>sending an email or notification alert to the user,</p>
</li>
<li>
<p>using a different <code>displayText</code> for the authentication session such as "Authentication started from a suspicious IP address. Are you authenticating to https://rp.example.com?",</p>
</li>
<li>
<p>performing a CAPTCHA verification,</p>
</li>
<li>
<p>block connections from malicious IP addresses.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="allowing-users-to-verify-operations"><a class="anchor" href="#allowing-users-to-verify-operations"></a>Allowing users to verify operations</h2>
<div class="sectionbody">
<div class="paragraph">
<p>It is important to give the user an option to see the history of their actions. For example when the user logged in, what operations the user has executed, what orders the user has placed and so on. This provides the user visibility and transparency about what is happening on their account. It also provides an opportunity to see actions or operations the user doesn&#8217;t recognize and that could point to security incidents.</p>
</div>
<div class="paragraph">
<p>RPs <strong>must</strong> allow the user to download digitally signed documents that were created after entering PIN2. This applies to any operation that uses PIN2 for additional consent. For example, after signing the terms and conditions for the e-service or when signing a transfer order on the RP&#8217;s website the user must be allowed to download the signed document. This allows the signer to verify contents of the signed document.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_monitoring_usage_patterns"><a class="anchor" href="#_monitoring_usage_patterns"></a>Monitoring usage patterns</h2>
<div class="sectionbody">
<div class="paragraph">
<p>RP should record enough information about connections and operations users regularly attempt on the RP&#8217;s website or app. It is then possible to apply log analysis and other security intelligence to the available information (and cross-reference with other data sources) to deduce with some certainty that:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>there is an ongoing attack;</p>
</li>
<li>
<p>some source (IP address, browser, phone number, e-mail address) behaves in a weird way and perhaps should be more closely monitored or added to a blocklist;</p>
</li>
<li>
<p>some logs might indicate that there&#8217;s an unknown vulnerability in the RP&#8217;s website.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_responding_to_security_incidents"><a class="anchor" href="#_responding_to_security_incidents"></a>Responding to security incidents</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Procedures to respond to fraud and security incidents must be developed and communicated and practiced within the RP organization. The RP must be familiar with services and guidelines from law enforcement authorities and other bodies. It is useful to establish contacts with these organizations before the urgent need arises. Good opportunity to do that is to participate in exercise sessions with the local cyber defence league unit.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_personal_data_processing"><a class="anchor" href="#_personal_data_processing"></a>Personal data processing</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Some security measures described in this document require processing additional data about users (for example, which IP addresses they have used) and require placing additional information on their browser cookies. This means that the RP must re-evaluate their personal data processing guidelines and public policies.</p>
</div>
<div class="paragraph">
<p>Preferences cookies which are mentioned above for tracking trusted and unknown browsers require users' consent, and the information about using the cookie must be declared in the public cookie policy.</p>
</div>
<div class="paragraph">
<p>For processing personal data, the RP must make sure that they have a lawful basis for doing so (see GDPR art 6(1)). In case the processing is likely to result in a high risk to the rights and freedoms of data subjects a data protection impact assessment (DPIA) must be carried out. It is also useful to review the RP&#8217;s privacy policy and update it with relevant information.</p>
</div>
</div>
</div>
</article>
  </div>
</main>
</div>
<footer class="footer">
  <p>© 2024 SK ID Solutions AS</p>
</footer>
<script id="site-script" src="../../_/js/site.js" data-ui-root-path="../../_"></script>
<script async src="../../_/js/vendor/highlight.js"></script>
<script async src="../../_/js/vendor/tabs.js" data-sync-storage-key="language"></script>
<script src="../../_/js/vendor/lunr.js"></script>
<script src="../../_/js/search-ui.js" id="search-ui-script" data-site-root-path="../.." data-snippet-length="100" data-stylesheet="../../_/css/search.css"></script>
<script async src="../../search-index.js"></script>
  </body>
</html>
