<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Overview :: Smart-ID documentation</title>
    <link rel="canonical" href="https://sk-eid.github.io/smart-id-documentation/rp-api/introduction.html">
    <meta name="generator" content="Antora 3.1.10">
    <link rel="stylesheet" href="../../_/css/site.css">

<link rel="icon" href="../../_/img/favicon.svg" type="image/x-icon">
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://sk-eid.github.io/smart-id-documentation">
        <img src="../../_/img/sk-id-solutions.svg" class="logo" />
      </a>
      <span class="separator"></span>
      <span class="title">Smart-ID documentation</span>
    </div>

    <div class="navbar-right">
      <div class="navbar-item search hide-for-print">
        <div id="search-field" class="field">
          <input id="search-input" type="text" placeholder="Search the docs">
        </div>
      </div>
      <button class="nav-toggle"></button>    </div>

  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="rp-api" data-version="3.1.4">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="introduction.html">Relying Party API</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <span class="nav-text">Smart-ID Documentation</span>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../index.html">Getting started</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../demo.html">Try out</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../implementation.html">Smart-ID integration</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../environments.html">Environments</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../device_link.html">Device-link fallback page</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../https_pinning.html">Implementing HTTPS pinning</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../client_libraries.html">Client libraries</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../logos.html">Logos</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../test_accounts.html">Test accounts</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../contact.html">Contact</a>
  </li>
  <li class="nav-item" data-depth="1">
    <span class="nav-text">Relying Party API</span>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../introduction.html">Introduction</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../introduction.html">Introduction</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../changes.html">Changes</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../glossary.html">Glossary</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../device_link_flows.html">Device link flows</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../authcode.html"><code>authCode</code> calculation</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../notification_based_flows.html">Notification based flows</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../api_specification.html">OpenAPI specification</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../api_details.html">API technical description</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../interactions.html">Interactions</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../signature_protocols.html">Signature protocols</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../callback_urls.html">Callback URLs</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../response_verification.html">Response verification</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../additional_security_measures.html">Additional security measures</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Relying Party API</span>
    <span class="version">3.1.4</span>
  </div>
  <ul class="components">
    <li class="component">
      <div class="title"><a href="../../index.html">Documentation</a></div>
    </li>
    <li class="component is-current">
      <div class="title"><a href="../introduction.html">Relying Party API</a></div>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../introduction.html">3.1.6</a>
        </li>
        <li class="version">
          <a href="../3.1.5/introduction.html">3.1.5</a>
        </li>
        <li class="version is-current">
          <a href="introduction.html">3.1.4</a>
        </li>
        <li class="version">
          <a href="../3.1.3/introduction.html">3.1.3</a>
        </li>
        <li class="version">
          <a href="../3.0.3/introduction.html">3.0.3</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
  <div class="content">
<aside class="toc sidebar" data-title="On this page" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">Overview</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>The Relying Party API provides five different types of endpoints. The first four are <code>POST</code> requests that return a <code>sessionID</code> and the fifth is a <code>GET</code> request used to query for the result based on the <code>sessionID</code>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The <code>POST v3/authentication/*</code> session endpoints are used to log a user onto a system or otherwise verify the identity of a user;</p>
</li>
<li>
<p>the <code>POST v3/signature/*</code> session endpoints are used to create digital signatures;</p>
</li>
<li>
<p>the <code>POST v3/signature/certificate-choice/*</code> session endpoints are used when the document number is not known immediately prior to the <code>signature</code> session and the user&#8217;s signing certificate is required to create the object that will be signed;</p>
</li>
<li>
<p>the <code>POST v3/signature/certificate/{document-number}</code> endpoint is used to obtain the signing certificate of the requested document number;</p>
</li>
<li>
<p>finally, the <code>GET v3/session/{sessionID}</code> status endpoint provides the result of the above sessions.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The implementation details are described on the <a href="api_specification.html" class="xref page">OpenAPI specification</a> page.</p>
</div>
<div class="paragraph">
<p>There are two types of flows that can be used in <code>v3/authentication/*</code>, <code>v3/signature/*</code> and <code>v3/signature/certificate-choice/*</code> sessions - the <a href="device_link_flows.html" class="xref page">device link based flow</a> and the <a href="notification_based_flows.html" class="xref page">notification based flow</a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">NOTE</div>
<div class="paragraph">
<p>In order to improve security and prevent phishing attacks, it is recommended to only use device link based flows or only allow notification based flows on devices and browsers that have successfully completed a device link based flow beforehand. It is up to the RP to decide how to <strong>securely</strong> identify such devices/browsers and tie them to the Smart-ID <code>document-number</code> by utilizing browser cookies, local app storage or other means.</p>
</div>
<div class="paragraph">
<p>For more details on additional security measures RPs can deploy, see the <a href="additional_security_measures.html" class="xref page">additional security measures</a> page.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>There are different ways to reference users - via their issued identifier, a document number linking a specific account or even not at all (in case of device link based flows). The different object references are described on the <a href="api_specification.html" class="xref page">OpenAPI specification</a> page.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="title">IMPORTANT</div>
<div class="paragraph">
<p>Once a user has been identified within the RP session, then in subsequent signing, certificate-choice and re-authentication session requests the document number reference should be used.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The main use cases and which sessions and flows to use are described below. Utilizing the RP API as described below provides the best user experience and security.</p>
</div>
<div class="paragraph">
<p>In the URL examples below and other pages <code>BASE</code> refers to the RP API base address <code><a href="https://rp-api.smart-id.com" class="bare">https://rp-api.smart-id.com</a></code></p>
</div>
<div class="paragraph">
<p>The following diagram shows main authentication flows and which endpoints to use.</p>
</div>
<div class="imageblock sequence kroki-format-svg kroki">
<div class="content">
<a class="image" href="_images/flow-628705beb37e0bc366fd3907da5db31eaaa5b3c0.svg"><img src="_images/flow-628705beb37e0bc366fd3907da5db31eaaa5b3c0.svg" alt="flow"></a>
</div>
</div>
<div class="paragraph">
<p>The following diagram shows main signature flows and which endpoints to use.</p>
</div>
<div class="imageblock sequence kroki-format-svg kroki">
<div class="content">
<a class="image" href="_images/flow-fcac824551ca97f2b4524198f90be09713c4aed9.svg"><img src="_images/flow-fcac824551ca97f2b4524198f90be09713c4aed9.svg" alt="flow"></a>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="cross_device_use_cases"><a class="anchor" href="#cross_device_use_cases"></a>Cross-device use cases</h2>
<div class="sectionbody">
<div class="paragraph">
<p><strong>Use case:</strong> The RP session is on a separate device from the mobile phone where the Smart-ID app is installed.</p>
</div>
<div class="paragraph">
<p>For example, the user is using a PC browser to access an RP website or a tablet to access an RP application.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="same_device_use_cases"><a class="anchor" href="#same_device_use_cases"></a>Same-device use cases</h2>
<div class="sectionbody">
<div class="paragraph">
<p><strong>Use case:</strong> The RP frontend (whether an RP app or website accessed by a mobile browser) resides on the same mobile device as the Smart-ID app.</p>
</div>
<div class="paragraph">
<p>The end user is using a mobile app or RP detects that the user is on a mobile browser so it can be assumed that the user intends to use the Smart-ID app on a same device.</p>
</div>
<div class="paragraph">
<p>Strongly prefer the <code>BASE/v3/*/device-link/anonymous</code> endpoints for same-device use cases unless the user&#8217;s <code>document-number</code> has already been established for the current session. These endpoints provide a superior user experience as no user identifier entry is required while the device-links with callbacks provide the best security protections.</p>
</div>
<div class="paragraph">
<p>However, a fallback option should also be provided to switch to the <a href="#cross_device_use_cases">cross-device use cases</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_authentication"><a class="anchor" href="#_authentication"></a>Authentication</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Using the device link based flow is the most secure option and should be preferred.</p>
</div>
<div class="paragraph">
<p>RP may call the anonymous device link based <code>authentication</code> session endpoint and display a dynamic QR code that the user must scan with the Smart-ID app or show a same-device (Web2App, App2App) link the user can interact with.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>BASE/v3/authentication/device-link/anonymous</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Instead of using the anonymous <code>authentication</code> session endpoint, the RP may request the user to enter their user identifier and utilize the non-anonymous <code>authentication</code> session endpoint. This may be beneficial when the RP utilizes custom usernames and has the users' identifiers stored internally. The RP may simply always ask the user for the identifier as well.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>BASE/v3/authentication/device-link/etsi/{id-etsi-qcs-SemanticsId-Natural}</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If there is a need to re-authenticate the user, the following endpoint should be used with the previously obtained <code>document-number</code> instead:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>BASE/v3/authentication/device-link/document/{document-number}</code></p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_notification_based_authentication"><a class="anchor" href="#_notification_based_authentication"></a>Notification based authentication</h3>
<div class="paragraph">
<p>Notification based <code>authentication</code> session endpoint can also be used for the same purpose.</p>
</div>
<div class="paragraph">
<p>Using a notification based <code>authentication</code> session endpoint triggers a push notification to all the user&#8217;s devices instead of the user scanning the QR code or clicking the same-device link.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>BASE/v3/authentication/notification/etsi/{id-etsi-qcs-SemanticsId-Natural}</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If there is a need to re-authenticate the user, the following endpoint can be used with the previously obtained <code>document-number</code> instead:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>BASE/v3/authentication/notification/document/{document-number}</code></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_signing"><a class="anchor" href="#_signing"></a>Signing</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="signing_with_prior_authentication"><a class="anchor" href="#signing_with_prior_authentication"></a>Signing with prior Smart-ID authentication</h3>
<div class="paragraph">
<p>If a user has already logged onto the RP app or website using Smart-ID authentication, the RP can call the <code>certificate</code> session endpoint to obtain the user&#8217;s signing certificate. As the document number is attained from the preceding authentication call, no user interaction is required for the <code>certificate-choice</code> session and the RP API can immediately provide the certificate.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>BASE/v3/signature/certificate/{document-number}</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The RP can then call the device link based <code>signature</code> session endpoint to sign using the same Smart-ID account that was used for authentication.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>BASE/v3/signature/device-link/document/{document-number}</code></p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="_notification_based_signing_with_prior_smart_id_authentication"><a class="anchor" href="#_notification_based_signing_with_prior_smart_id_authentication"></a>Notification based signing with prior Smart-ID authentication</h4>
<div class="paragraph">
<p>The notification based <code>signature</code> session endpoint can also be used for the same purpose.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>BASE/v3/signature/notification/document/{document-number}</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_signing_without_prior_smart_id_authentication"><a class="anchor" href="#_signing_without_prior_smart_id_authentication"></a>Signing without prior Smart-ID authentication</h3>
<div class="paragraph">
<p>If possible, the Smart-ID authentication should be performed before signing and (and after that is completed, instructions in <a href="#signing_with_prior_authentication">Signing with prior Smart-ID authentication</a> should be followed).</p>
</div>
<div class="paragraph">
<p>In case no prior Smart-ID authentication has taken place, and certificate is required, the anonymous device link based <code>certificate-choice</code> session endpoint should be used.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>BASE/v3/signature/certificate-choice/device-link/anonymous</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Immediately after receiving the response with the certificate, RP must call the notification based linked <code>signature</code> session endpoint and provide the <strong>mandatory</strong> <code>linkedSessionID</code> parameter (session ID of the previous <code>certificate-choice</code> session) to connect the <code>signature</code> and <code>certificate-choice</code> sessions.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>BASE/v3/signature/notification/linked/{document-number}</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The combination of device link based <code>certificate-choice</code> and notification based linked <code>signature</code> session endpoints provides the optimal user experience where Smart-ID app is launched only once and a verification code (VC) is not shown. If the <code>certificate-choice</code> session was completed using a same-device device link, after the flow is completed, the Smart-ID app will launch the <code>callbackUrl</code> <strong>given in the device link based <code>certificate-choice</code></strong>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">NOTE</div>
<div class="paragraph">
<p>In the flow described above, it is recommended to stop showing the QR code, Web2App or App2App link in the RP UI after the certificate is obtained.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If the certificate is not required, or is already known, the device link based <code>signature</code> session endpoint should be called instead.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>BASE/v3/signature/device-link/etsi/{id-etsi-qcs-SemanticsId-Natural}</code></p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">NOTE</div>
<div class="paragraph">
<p>There is no anonymous device link based <code>signature</code> session endpoint, since in all practical signing use cases the user&#8217;s identity is known beforehand.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="_notification_based_signing_without_prior_smart_id_authentication"><a class="anchor" href="#_notification_based_signing_without_prior_smart_id_authentication"></a>Notification based signing without prior Smart-ID authentication</h4>
<div class="paragraph">
<p>Notification based <code>certificate-choice</code> session endpoint can also be used for the same purpose but <strong>is not</strong> recommended.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>BASE/v3/signature/certificate-choice/notification/etsi/{id-etsi-qcs-SemanticsId-Natural}</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Immediately after receiving the response with the certificate, RP must display the VC and call notification based <code>signature</code> session endpoint.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>BASE/v3/signature/notification/document/{document-number}</code></p>
</li>
</ul>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="title">IMPORTANT</div>
<div class="paragraph">
<p>Notification based <code>certificate-choice</code> <strong>cannot</strong> be connected to notification based linked <code>signature</code> session endpoint with <code>linkedSessionID</code>. If notification based <code>certificate-choice</code> is used, verification code (VC) must still be shown to the user, and in same-device use cases, there might be usability issues with VC being shown too fast or not being shown at all (this is especially problematic for interactions involving <code>confirmationMessageAndVerificationCodeChoice</code>).</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
</div>
</article>
  </div>
</main>
</div>
<footer class="footer">
  <p>© 2024 SK ID Solutions AS</p>
</footer>
<script id="site-script" src="../../_/js/site.js" data-ui-root-path="../../_"></script>
<script async src="../../_/js/vendor/highlight.js"></script>
<script async src="../../_/js/vendor/tabs.js" data-sync-storage-key="language"></script>
<script src="../../_/js/vendor/lunr.js"></script>
<script src="../../_/js/search-ui.js" id="search-ui-script" data-site-root-path="../.." data-snippet-length="100" data-stylesheet="../../_/css/search.css"></script>
<script async src="../../search-index.js"></script>
  </body>
</html>
