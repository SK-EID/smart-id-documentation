<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Dynamic link flows :: RP API integration guidance</title>
    <link rel="canonical" href="https://sk-eid.github.io/smart-id-documentation/rp-api/3.0.3/dynamic_link_flows.html">
    <meta name="generator" content="Antora 3.1.7">
    <link rel="stylesheet" href="../../_/css/site.css">
    <link rel="stylesheet" href="../../_/css/vendor/tabs.css">
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item logo" href="https://www.skidsolutions.eu/"><svg viewBox="0 0 250 59.99"><defs><style>.sk-logo{fill:#fff;}</style></defs><g><g><path class="sk-logo" d="M30,0A30,30,0,1,0,60,30,30,30,0,0,0,30,0m0,56.56A26.57,26.57,0,1,1,56.56,30,26.56,26.56,0,0,1,30,56.56m-5.89-29a5.89,5.89,0,0,1,4.68,5.93,8.52,8.52,0,0,1-.17,1.63c-.84,3.68-4.1,5.32-7.44,5.32a13.51,13.51,0,0,1-1.5-.09c-2.32-.3-6.76-2.49-6.76-5.48a2.75,2.75,0,0,1,.27-1.17,1.87,1.87,0,0,1,1.71-1.1c1.21,0,1.93,1.13,2.6,2a3.14,3.14,0,0,0,1,.78,4.65,4.65,0,0,0,2,.69l.56,0h.35c1.41,0,3.14-.72,3.14-2.48a1.6,1.6,0,0,0-.72-1.47,2.82,2.82,0,0,0-.92-.38l-.79-.22-2.69-.65-.75-.19c-3.1-.89-5.09-2.73-5.09-5.69a6.92,6.92,0,0,1,.3-2,5.91,5.91,0,0,1,2.48-3.32,8,8,0,0,1,4.48-1.25h.55a6.44,6.44,0,0,1,1,.11,7.15,7.15,0,0,1,2.21.62,8.24,8.24,0,0,1,1.79,1c1.14.92,2.34,2.13,1.39,3.77a2,2,0,0,1-1.37,1,2.08,2.08,0,0,1-1.52-.32l-.72-.6-.43-.32a4.39,4.39,0,0,0-3-1c-1,0-2.4.3-2.75,1.45a2,2,0,0,0-.1.56c0,.48.29,1.15,2.05,1.68l.55.16.38.1.84.21,1.17.3.5.07.81.22M46.68,37a2.42,2.42,0,0,1,.4,1.29,2.17,2.17,0,0,1-1.46,2.1,3.51,3.51,0,0,1-.65.09,2.35,2.35,0,0,1-1.72-.8l-6.71-7.15v5.31c0,1.22-.45,2.7-2,2.7a2.18,2.18,0,0,1-2.13-2.36v-17c0-1.27.49-2.73,2.09-2.73a1.94,1.94,0,0,1,2.09,1.83V26l6.13-6.48a2.93,2.93,0,0,1,1.43-.89,2.07,2.07,0,0,1,2.32,1.62,2.57,2.57,0,0,1-.84,2.45l-6.36,6.51,7,7.22Zm25.49,2.71c0,.45-.12.64-.57.64H69.65c-.41,0-.57-.19-.57-.64V19.34c0-.44.16-.63.57-.63H71.6c.45,0,.57.19.57.63Zm5.74.64c-.38,0-.51-.22-.51-.64V19.34c0-.44.16-.63.58-.63h6.66c5.46,0,7.27,2.29,7.27,4.91V35.48c0,2.61-1.81,4.91-7.27,4.91Zm2.59-19V37.74h4.14c2.87,0,4.15-1.05,4.15-2.77V24.13c0-1.73-1.28-2.78-4.15-2.78Zm34.92,1.79c0-1.91-1-3.25-4.75-3.25s-4.76,1.34-4.76,3.25v1.18a2.84,2.84,0,0,0,2,2.71l6.13,2.33c1.59.6,3.19,1.81,3.19,4v2.81c0,2.49-1.53,4.5-6.61,4.5s-6.63-2-6.63-4.5V34.49c0-.29.13-.41.38-.41h.93c.25,0,.38.12.38.41V36c0,1.91,1.18,3.25,4.91,3.25s5-1.34,5-3.25V33.69c0-1.72-1.41-2.48-2.65-3L107,28.43a4.07,4.07,0,0,1-2.74-3.76V23c0-2.49,1.4-4.5,6.41-4.5s6.41,2,6.41,4.5v1.56c0,.25-.1.38-.39.38h-.92c-.26,0-.35-.13-.35-.38Zm6.82-.19c0-2.49,1.53-4.5,6.64-4.5s6.69,2,6.69,4.5v13.2c0,2.49-1.56,4.5-6.69,4.5s-6.64-2-6.64-4.5Zm11.61.25c0-1.94-1.24-3.28-5-3.28s-4.95,1.34-4.95,3.28V35.89c0,2,1.25,3.29,4.95,3.29s5-1.34,5-3.29ZM143,38.92h9.44c.26,0,.39.1.39.39V40c0,.29-.13.38-.39.38H141.63c-.19,0-.32-.13-.32-.38V19.09a.34.34,0,0,1,.39-.39h1c.26,0,.35.13.35.39Zm15.57-3c0,2,1.24,3.29,5,3.29s5-1.34,5-3.29V19.09a.33.33,0,0,1,.38-.38h1c.25,0,.35.12.35.38V36.15c0,2.49-1.53,4.5-6.67,4.5s-6.66-2-6.66-4.5V19.09a.33.33,0,0,1,.38-.38h1c.25,0,.35.12.35.38Zm28.8-17.18c.25,0,.38.09.38.38v.7c0,.29-.13.38-.38.38h-5.81V40c0,.25-.09.38-.35.38h-1c-.28,0-.38-.13-.38-.38V20.17H174.1c-.29,0-.38-.09-.38-.38v-.7c0-.29.09-.38.38-.38ZM193.14,40c0,.25-.1.38-.35.38h-1a.34.34,0,0,1-.38-.38V19.09a.33.33,0,0,1,.38-.38h1c.25,0,.35.12.35.38ZM198.91,23c0-2.49,1.53-4.5,6.63-4.5s6.7,2,6.7,4.5v13.2c0,2.49-1.56,4.5-6.7,4.5s-6.63-2-6.63-4.5Zm11.61.25c0-1.94-1.25-3.28-5-3.28s-4.94,1.34-4.94,3.28V35.89c0,2,1.24,3.29,4.94,3.29s5-1.34,5-3.29ZM231.28,40c0,.25-.1.38-.35.38h-.86a.33.33,0,0,1-.35-.19L220.6,24a17.53,17.53,0,0,1-1-1.92V40c0,.25-.1.38-.35.38h-.87A.34.34,0,0,1,218,40V19.09a.33.33,0,0,1,.38-.38h.87a.35.35,0,0,1,.31.15l9.22,16.36c.29.52.93,1.82.93,1.82V19.09a.33.33,0,0,1,.38-.38h.86c.25,0,.35.12.35.38Zm16.9-16.87c0-1.91-1.05-3.25-4.75-3.25s-4.75,1.34-4.75,3.25v1.18a2.84,2.84,0,0,0,2,2.71l6.12,2.33c1.6.6,3.19,1.81,3.19,4v2.81c0,2.49-1.53,4.5-6.6,4.5s-6.63-2-6.63-4.5V34.49c0-.29.12-.41.38-.41h.92c.26,0,.39.12.39.41V36c0,1.91,1.18,3.25,4.91,3.25s5-1.34,5-3.25V33.69c0-1.72-1.4-2.48-2.64-3l-5.94-2.3A4.09,4.09,0,0,1,237,24.67V23c0-2.49,1.4-4.5,6.41-4.5s6.41,2,6.41,4.5v1.56c0,.25-.09.38-.38.38h-.93c-.25,0-.35-.13-.35-.38Z"></path></g></g></svg></a>
      <a class="navbar-item" href="https://sk-eid.github.io/smart-id-documentation">RP API integration guidance</a>
      <div class="navbar-item search hide-for-print">
        <div id="search-field" class="field">
          <input id="search-input" type="text" placeholder="Search the docs">
        </div>
      </div>
      <button class="navbar-burger" aria-controls="topbar-nav" aria-expanded="false" aria-label="Toggle main menu">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
    </div>
  </nav>
</header><div class="body">
<div class="nav-container" data-component="rp-api" data-version="3.0.0">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <button class="nav-menu-toggle" aria-label="Toggle expand/collapse all" style="display: none"></button>
    <h3 class="title"><a href="introduction.html">RP API documentation</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="introduction.html">Introduction</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="glossary.html">Terms and glossary</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="changes.html">Changes</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="sessions.html">Session types</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="authentication_session.html"><code>authentication</code> session</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="signature_session.html"><code>signature</code> session</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="certificatechoice_session.html"><code>certificatechoice</code> session</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="session_status.html"><code>session</code> status</a>
  </li>
</ul>
  </li>
  <li class="nav-item is-current-page" data-depth="1">
    <a class="nav-link" href="dynamic_link_flows.html">Dynamic link flows</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="notification_based_flows.html">Notification based flows</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="response_verification.html">Response verification</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="object_references.html">REST object references</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="signature_protocols.html">Signature protocols</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="interactions.html">Interactions</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="request_properties.html">Additional request properties</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="api_details.html">REST API details</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="secure.html">Secure Implementation Guide</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">RP API documentation</span>
    <span class="version">3.0.0</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <div class="title"><a href="../3.0.3/introduction.html">RP API documentation</a></div>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../3.0.3/introduction.html">3.0.3</a>
        </li>
        <li class="version">
          <a href="../3.0.2/introduction.html">3.0.2</a>
        </li>
        <li class="version">
          <a href="../3.0.1/introduction.html">3.0.1</a>
        </li>
        <li class="version is-current">
          <a href="introduction.html">3.0.0</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../3.0.3/introduction.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="introduction.html">RP API documentation</a></li>
    <li><a href="dynamic_link_flows.html">Dynamic link flows</a></li>
  </ul>
</nav>
<div class="page-versions">
  <button class="version-menu-toggle" title="Show other versions of page">3.0.0</button>
  <div class="version-menu">
    <a class="version" href="../3.0.3/dynamic_link_flows.html">3.0.3</a>
    <a class="version" href="../3.0.2/dynamic_link_flows.html">3.0.2</a>
    <a class="version" href="../3.0.1/dynamic_link_flows.html">3.0.1</a>
    <a class="version is-current" href="dynamic_link_flows.html">3.0.0</a>
  </div>
</div>
</div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">Dynamic link flows</h1>
<div class="sect1">
<h2 id="_overview"><a class="anchor" href="#_overview"></a>Overview</h2>
<div class="sectionbody">
<div class="paragraph">
<p>On a high level, the dynamic flow consists of the following steps:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>User interacts with a RP frontend (which is a webpage or an app).</p>
</li>
<li>
<p>RP backend makes a request to RP-API to create a dynamic link based <code>authentication</code> or <code>signature</code> session, obtaining security parameters that are necessary for generating dynamic links. This request may either be anonymous (no personal identifier is provided) or non-anonymous.</p>
</li>
<li>
<p>RP starts dynamically creating dynamic links that update each second. The dynamic links are generated in RP backend and forwarded to RP frontend.</p>
</li>
<li>
<p>RP frontend displays the QR codes / Web2App links / App2App links. The user interacts with one of them by either:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Opening Smart-ID app and scanning a QR code (preferred option for QR codes);</p>
</li>
<li>
<p>Using a native camera app to scan a QR code (not supported by all camera apps);</p>
</li>
<li>
<p>Clicking on a Web2App link in a RP webpage, thus opening the Smart-ID app;</p>
</li>
<li>
<p>Clicking on an App2App link in a RP app, thus opening the Smart-ID app.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Smart-ID app extracts the necessary parameters and makes a request to the Smart-ID backend to check the integrity, validity and freshness of the dynamic link. If the request was non-anonymous, it is verified that the provided personal identifier agrees with the actual user&#8217;s identity. Backend responds by creating a transaction and returning the transaction data.</p>
</li>
<li>
<p>Signing protocol continues in the usual way (user enters the PIN code).</p>
</li>
<li>
<p>After the signature has been given, the RP receives the success result via the session status endpoint. In the case of anonymous flow, RP learns the identity of the user only at this point (via the user&#8217;s certificate).</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The following diagram describes the dynamic link based flow for the <code>authentication</code> session. The flow for the <code>signature</code> session follows the same principles and has been omitted.</p>
</div>
<div class="imageblock sequence kroki-format-svg kroki">
<div class="content">
<a class="image" href="_images/flow-208fe1426526ff7bfbe0ce12173203ef83dde7bd.svg"><img src="_images/flow-208fe1426526ff7bfbe0ce12173203ef83dde7bd.svg" alt="flow"></a>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_dynamic_link_calculation"><a class="anchor" href="#_dynamic_link_calculation"></a>Dynamic link calculation</h2>
<div class="sectionbody">
<div class="paragraph">
<p>When RP backend makes a request to RP API to create a new dynamic link based session, Smart-ID server generates and returns the following parameters as a response:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sessionID</code> - session ID (RP UUID);</p>
</li>
<li>
<p><code>sessionToken</code> - unique random value that will be used to connect this login attempt between the relevant parties (RP, RP API, Smart-ID app);</p>
</li>
<li>
<p><code>sessionSecret</code> - base64-encoded random key value that should be kept in secret and should be shared only between the RP backend and RP API server.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>RP then starts calculating and showing the QR image, Web2App link, and/or App2App link dynamically (all those links must be updated regularly with the interval of 1 second).</p>
</div>
<div class="paragraph">
<p>The RP may offer multiple options (a QR image and a Web2App link) to the user at the same time. This is useful in the following situations:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The user is accessing RP website from a mobile device, for example a tablet device. RP wants to offer to the user the choice to authenticate either on the same device (via a Web2App link) or on a separate device (via a dynamic QR code).</p>
</li>
<li>
<p>RP is unable to detect from the user agent whether the user is using a mobile device or a PC.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The next table lists all of the parameters and definitions used in the dynamic link generation. They are all explained in more detail below.</p>
</div>
<table class="tableblock frame-none grid-none stripes-odd stretch">
<caption class="title">Parameters used for dynamic link generation</caption>
<colgroup>
<col style="width: 12.5%;">
<col style="width: 87.5%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Formula</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>version</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A pre-defined version value, currently 0.1 .</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>sessionToken</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Generated by RP API.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>sessionSecret</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Generated by RP API.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>dynamicLinkType</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">'QR' (for QR codes) | 'Web2App' (for Web2App links) | 'App2App' (for App2App links)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>sessionType</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">'auth' | 'sign' | 'cert'</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>elapsedSeconds</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Seconds since receiving the response from the initial request to RP API.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>payload</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>dynamicLinkType.sessionType.time</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>authCode</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Calculated using HMAC SHA 256 algorithm and represented in Base64URL encoding.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>lang</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An ISO 639-2 language code. It should match the language that the user was seeing in the RP UI previously. This only affects the language of the fallback page, not the Smart-ID app itself.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The parameter <code>sessionType</code> describes the session type:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>'auth' - <code>authentication</code> session</p>
</li>
<li>
<p>'sign' - <code>signature</code> session</p>
</li>
<li>
<p>'cert' - <code>certificatechoice</code> session</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The <code>lang</code> parameter defines the interface language for the HTTPS fallback page that will be shown to the user when there are technical problems regarding opening dynamic links (for example, if user&#8217;s browser is blocking Web2App links and needs to be configured to allow them or if Smart-ID app is not installed on the phone). It is recommended that for consistent user experience, RP provides here the same language that the user was already using in the RP UI.</p>
</div>
<div class="paragraph">
<p>The <code>elapsedSeconds</code> parameters is seconds since receiving the response from the initial request to RP API. Notice that <code>authCode</code> must be re-calculated every 1s.</p>
</div>
<div class="paragraph">
<p>As the next step, RP calculates:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>payload</code> := <code>dynamicLinkType.sessionType.time</code></p>
</li>
<li>
<p><code>authCode</code> := HMACSHA256(<code>sessionSecret</code>, <code>payload</code>)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Details about formatting the <code>payload</code> and <code>sessionSecret</code> parameters as byte strings for HMACSHA256 calculation:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>payload</code> should be converted into a byte string from its ASCII string representation;</p>
</li>
<li>
<p><code>sessionSecret</code> should be used in its binary representation (it is returned from RP API in Base64 encoding);</p>
</li>
<li>
<p>In the QR / Web2App link / App2App link, the result of hash calculation (parameter <code>authCode</code>) must be formatted in Base64URL encoding.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following table aims to clarify which of the parameters should be accessible by which parties.</p>
</div>
<table class="tableblock frame-none grid-none stripes-odd stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"></th>
<th class="tableblock halign-center valign-top">RP-API server</th>
<th class="tableblock halign-center valign-top">RP backend</th>
<th class="tableblock halign-center valign-top">RP frontend/app</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>version</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="image"><img src="_images/check-emoji-2714.svg" alt="check emoji 2714" width="40"></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="image"><img src="_images/check-emoji-2714.svg" alt="check emoji 2714" width="40"></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="image"><img src="_images/check-emoji-2714.svg" alt="check emoji 2714" width="40"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>sessionId</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="image"><img src="_images/star-emoji-2B50.svg" alt="star emoji 2B50" width="40"></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="image"><img src="_images/check-emoji-2714.svg" alt="check emoji 2714" width="40"></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="image"><img src="_images/no-entry-emoji-26D4.svg" alt="no entry emoji 26D4" width="40"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>sessionToken</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="image"><img src="_images/star-emoji-2B50.svg" alt="star emoji 2B50" width="40"></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="image"><img src="_images/check-emoji-2714.svg" alt="check emoji 2714" width="40"></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="image"><img src="_images/check-emoji-2714.svg" alt="check emoji 2714" width="40"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>sessionSecret</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="image"><img src="_images/star-emoji-2B50.svg" alt="star emoji 2B50" width="40"></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="image"><img src="_images/check-emoji-2714.svg" alt="check emoji 2714" width="40"></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="image"><img src="_images/no-entry-emoji-26D4.svg" alt="no entry emoji 26D4" width="40"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>elapsedSeconds</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="image"><img src="_images/check-emoji-2714.svg" alt="check emoji 2714" width="40"></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="image"><img src="_images/star-emoji-2B50.svg" alt="star emoji 2B50" width="40"></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="image"><img src="_images/check-emoji-2714.svg" alt="check emoji 2714" width="40"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>dynamicLinkType</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="image"><img src="_images/check-emoji-2714.svg" alt="check emoji 2714" width="40"></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="image"><img src="_images/star-emoji-2B50.svg" alt="star emoji 2B50" width="40"></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="image"><img src="_images/check-emoji-2714.svg" alt="check emoji 2714" width="40"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>sessionType</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="image"><img src="_images/check-emoji-2714.svg" alt="check emoji 2714" width="40"></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="image"><img src="_images/star-emoji-2B50.svg" alt="star emoji 2B50" width="40"></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="image"><img src="_images/check-emoji-2714.svg" alt="check emoji 2714" width="40"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>authCode</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="image"><img src="_images/check-emoji-2714.svg" alt="check emoji 2714" width="40"></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="image"><img src="_images/star-emoji-2B50.svg" alt="star emoji 2B50" width="40"></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="image"><img src="_images/check-emoji-2714.svg" alt="check emoji 2714" width="40"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>lang</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="image"><img src="_images/check-emoji-2714.svg" alt="check emoji 2714" width="40"></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="image"><img src="_images/star-emoji-2B50.svg" alt="star emoji 2B50" width="40"></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="image"><img src="_images/check-emoji-2714.svg" alt="check emoji 2714" width="40"></span></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Legend:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><span class="image"><img src="_images/star-emoji-2B50.svg" alt="star emoji 2B50" width="40"></span> - source of parameter (the party that generates/calculates it)</p>
</li>
<li>
<p><span class="image"><img src="_images/check-emoji-2714.svg" alt="check emoji 2714" width="40"></span> - knows parameter</p>
</li>
<li>
<p><span class="image"><img src="_images/no-entry-emoji-26D4.svg" alt="no entry emoji 26D4" width="40"></span> - MUST NOT know parameter</p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_link"><a class="anchor" href="#_link"></a>Link</h3>
<div class="paragraph">
<p>The dynamic link for App2App and Web2App is a URL string:</p>
</div>
<div class="paragraph">
<p><code>https://smart-id.com/dynamic-link/?version=&#8230;&#8203;&amp;sessionToken=&#8230;&#8203;&amp;dynamicLinkType=&#8230;&#8203;&amp;sessionType=&#8230;&#8203;&amp;elapsedSeconds=&#8230;&#8203;&amp;lang=&#8230;&#8203;&amp;authCode=&#8230;&#8203;</code></p>
</div>
<div class="paragraph">
<p>Example of a Web2App link:</p>
</div>
<div class="paragraph">
<p><code>https://smart-id.com/dynamic-link/?version=0.1&amp;sessionToken=kj4mIOLOa75zeNKabFA5f251&amp;dynamicLinkType=Web2App&amp;sessionType=auth&amp;elapsedSeconds=2&amp;lang=eng&amp;authCode=R5oiivdJIhfjJLBCA3AzijU2p8oH45fBKpcN59oSXboo</code></p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
For all flows, the dynamic generation (every 1s) of the <code>authCode</code> parameter must be done in the RP backend, <strong>NOT</strong> in the RP frontend or RP app so as not to not leak the <code>sessionSecret</code> parameter. Also, it is forbidden to generate values of <code>authCode</code> parameter ahead of time and forward them to the RP frontend/app.
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>In the App2App and Web2App flow it will be possible for the RP to also attach a callback URI that the Smart-ID App can call at the end of the transaction. This will allow for seamless navigation between RP apps and RP websites in the single-device use case.</p>
</div>
<div class="paragraph">
<p>Details for the this functionality are being worked on.</p>
</div>
<div class="paragraph">
<p>The callback URL will also be part of the <code>payload</code> and as such protected by the <code>authCode</code> parameter.</p>
</div>
<div class="paragraph">
<p>The allowed callback domains might be whitelisted by the Smart-ID Service.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_qr"><a class="anchor" href="#_qr"></a>QR</h3>
<div class="paragraph">
<p>QR message itself is defined as a URL string, just like App2App and Web2App links. The only difference is the <code>dynamicLinkType</code> parameter value.</p>
</div>
<div class="paragraph">
<p><code>https://smart-id.com/dynamic-link/?version=&#8230;&#8203;&amp;sessionToken=&#8230;&#8203;&amp;dynamicLinkType=&#8230;&#8203;&amp;sessionType=&#8230;&#8203;&amp;elapsedSeconds=&#8230;&#8203;&amp;lang=&#8230;&#8203;&amp;authCode=&#8230;&#8203;</code></p>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="paragraph">
<p><code>https://smart-id.com/dynamic-link/?version=0.1&amp;sessionToken=kj4mIOLOa75zeNKabFA5f251&amp;dynamicLinkType=QR&amp;sessionType=auth&amp;elapsedSeconds=2&amp;lang=eng&amp;authCode=R5oiivdJIhfjJLBCA3AzijU2p8oH45fBKpcN59oSXboo</code></p>
</div>
<div class="paragraph">
<p>Here parameter <code>authCode</code> is represented in Base64URL encoding. Parameter <code>sessionToken</code> is inserted into the QR message exactly as it was obtained from RP API.</p>
</div>
<div class="paragraph">
<p>Example of a QR code:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/qr.png" alt="qr">
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_dynamic_link_and_qr_presentation"><a class="anchor" href="#_dynamic_link_and_qr_presentation"></a>Dynamic link and QR presentation</h2>
<div class="sectionbody">
<div class="paragraph">
<p>For generation of QR codes, error correction level <strong>LOW</strong> should be used. The QR code should have sufficient margins to enable quick scanning by the Smart-ID app. The optimal size for QR code is ~10 pixels per block when displayed on a PC, since:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Block sizes 5 pixels and less are too small for easy scanning (devices might have focus issues).</p>
</li>
<li>
<p>Block sizes 20 pixels and above are too big for convenient scanning.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>When QR code is displayed on a mobile device, it is recommended to show the QR code as big as possible, up to 10 pixels per block.</p>
</div>
<div class="paragraph">
<p>The actual generation of the QR <em>image</em> can be done both in the backend or the frontend, as the underlying message in the QR code is essentially public information.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
In the App2App flow, it is not necessary to generate the link every second. Instead, the RP app can request a fresh link on-the-fly from the RP backend when the user clicks on a button in the RP app and navigate to it.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_fallback_page"><a class="anchor" href="#_fallback_page"></a>Fallback page</h2>
<div class="sectionbody">
<div class="paragraph">
<p>For cases when the app is not installed or some other problem occurs with opening a dynamic link, a fallback HTTPS webpage is opened with instructions on how to resolve the issue. The <code>lang</code> parameter in the link is used to by default show the same language as on the RP UI. The instructions cover the following scenarios:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>User is not on a mobile device where Smart-ID is installed and has been allowed by the RP to use a wrong type of dynamic link.</p>
</li>
<li>
<p>Smart-ID App is not installed on the current device.</p>
</li>
<li>
<p>Mobile browser does not support universal links / Android App links.</p>
</li>
<li>
<p>Mobile OS settings disallow the link and user intervention is required.</p>
</li>
</ul>
</div>
</div>
</div>
</article>
  </div>
</main>
</div>
<footer class="footer">
  <p>© 2024 SK ID Solutions AS</p>
</footer>
<script id="site-script" src="../../_/js/site.js" data-ui-root-path="../../_"></script>
<script async src="../../_/js/vendor/highlight.js"></script>
<script async src="../../_/js/vendor/tabs.js" data-sync-storage-key="language"></script>
<script src="../../_/js/vendor/lunr.js"></script>
<script src="../../_/js/search-ui.js" id="search-ui-script" data-site-root-path="../.." data-snippet-length="100" data-stylesheet="../../_/css/search.css"></script>
<script async src="../../search-index.js"></script>
  </body>
</html>
