<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Introduction :: RP API integration guidance</title>
    <link rel="canonical" href="https://www.example.com/rp-api/introduction.html">
    <meta name="generator" content="Antora 3.1.10">
    <link rel="stylesheet" href="../_/css/site.css">
    <link rel="stylesheet" href="../_/css/vendor/tabs.css">
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://www.example.com">RP API integration guidance</a>
      <div class="navbar-item search hide-for-print">
        <div id="search-field" class="field">
          <input id="search-input" type="text" placeholder="Search the docs" autofocus>
        </div>
      </div>
      <button class="navbar-burger" aria-controls="topbar-nav" aria-expanded="false" aria-label="Toggle main menu">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="rp-api" data-version="master">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <button class="nav-menu-toggle" aria-label="Toggle expand/collapse all" style="display: none"></button>
    <h3 class="title"><a href="introduction.html">RP API documentation</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item is-current-page" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="introduction.html">Introduction</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="glossary.html">Terms and glossary</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="changes.html">Changes</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="sessions.html">Session types</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="authentication_session.html"><code>authentication</code> session</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="signature_session.html"><code>signature</code> session</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="certificatechoice_session.html"><code>certificatechoice</code> session</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="session_status.html"><code>session</code> status</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="dynamic_link_flows.html">Dynamic link flows</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="notification_based_flows.html">Notification based flows</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="response_verification.html">Response verification</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="object_references.html">REST object references</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="signature_protocols.html">Signature protocols</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="interactions.html">Interactions</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="request_properties.html">Additional request properties</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="api_details.html">REST API details</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="secure.html">Secure Implementation Guide</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">RP API documentation</span>
    <span class="version">master</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <div class="title"><a href="introduction.html">RP API documentation</a></div>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="introduction.html">master</a>
        </li>
        <li class="version">
          <a href="3.0.3/introduction.html">3.0.3</a>
        </li>
        <li class="version">
          <a href="3.0.2/introduction.html">3.0.2</a>
        </li>
        <li class="version">
          <a href="3.0.1/introduction.html">3.0.1</a>
        </li>
        <li class="version">
          <a href="3.0.0/introduction.html">3.0.0</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="introduction.html" class="home-link is-current"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="introduction.html">RP API documentation</a></li>
    <li><a href="introduction.html">Introduction</a></li>
  </ul>
</nav>
<div class="page-versions">
  <button class="version-menu-toggle" title="Show other versions of page">master</button>
  <div class="version-menu">
    <a class="version is-current" href="introduction.html">master</a>
    <a class="version" href="3.0.3/introduction.html">3.0.3</a>
    <a class="version" href="3.0.2/introduction.html">3.0.2</a>
    <a class="version" href="3.0.1/introduction.html">3.0.1</a>
    <a class="version" href="3.0.0/introduction.html">3.0.0</a>
  </div>
</div>
<div class="edit-this-page"><a href="file:///antora/RP_API_documentation/modules/ROOT/pages/introduction.adoc">Edit this Page</a></div>
</div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">Introduction</h1>
<div id="preamble">
<div class="sectionbody">
<!-- Version (worktree) -->
<div class="paragraph">
<p>This document describes the relying party service interface protocol of Smart-ID server and provides information for integration. The interface offers the entry point to Smart-ID main use cases, i.e. authentication and signing.</p>
</div>
<div class="paragraph">
<p>The main Smart-ID use case is of a relying party to start a session by calling the Smart-ID server RP API with a challenge when the user wishes to authenticate with the relying party&#8217;s service or create a signature.</p>
</div>
<div class="paragraph">
<p>The Smart-ID server either sends a push message notification to the user&#8217;s device where the user opens the Smart-ID application or the user must scan a QR code or in case of the single-device use case click a link to launch the Smart-ID application.</p>
</div>
<div class="paragraph">
<p>The user checks the details of the transaction and enters a PIN code to confirm it.</p>
</div>
<div class="paragraph">
<p>The application communicates with the Smart-ID server and once the final signature is created makes it available for the relying party to be fetched.</p>
</div>
<div class="paragraph">
<p>Meanwhile, the relying party has been waiting for a reply from the Smart-ID server using a long poll connection. In case of success it receives the signature and the user&#8217;s certificate to be able to validate the result.</p>
</div>
<div class="paragraph">
<p>The service creates digital signatures as proof of authentication and signing. However, to create electronic signatures the relying party must create the required document structure, calculate the hash and have that signed using this API.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The latest version of the API introduces new flows collectively referred to as <em>"dynamic flows"</em>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>for multi-device use cases&#8201;&#8212;&#8201;dynamic QR codes that the user must scan;</p>
</li>
<li>
<p>for single-device use cases where the user is visiting an RP webpage using a mobile browser&#8201;&#8212;&#8201;dynamic links which the user must click;</p>
</li>
<li>
<p>for single-device use cases where the user is using an RP app&#8201;&#8212;&#8201;dynamic links which the user must click.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The guiding principle in designing the API has been to unify those three aforementioned flows as much as possible to minimize the integration efforts for the RPs. Because of this, they share the same security mechanisms and principles, even though the medium of transmitting information is completely different.</p>
</div>
<div class="paragraph">
<p>This also means that it is possible for an RP to offer alternative methods of authentication at the same time without doing multiple requests to RP-API.</p>
</div>
<div class="paragraph">
<p>In RP API version 3, the notification based flows will still be available, but for maximum security, it is recommended that they are used only if the user has been authenticated at least once before in that device by one of the more secure dynamic flows. The recommended way for ensuring this is for the RP to utilize the client&#8217;s local storage (e.g. browser cookies) to keep track which clients have previously authenticated using the more secure flows.</p>
</div>
<div class="paragraph">
<p>For both usability and security reasons, in the single-device use case the new dynamic links based flows should always be used.</p>
</div>
<div class="paragraph">
<p>Brokers of the Smart-ID service are treated similarly to relying parties and there is no extra configuration compared to previous RP API versions.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_dynamic_link_based_authentication_flow"><a class="anchor" href="#_dynamic_link_based_authentication_flow"></a>Dynamic link based authentication flow</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The following sequence diagram gives an overview of the new (more secure) dynamic link based authentication flow.</p>
</div>
<div class="imageblock sequence kroki-format-svg kroki">
<div class="content">
<a class="image" href="_images/flow-ac1a9766b64d324a16757668fd43fd567053b8ed.svg"><img src="_images/flow-ac1a9766b64d324a16757668fd43fd567053b8ed.svg" alt="flow"></a>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_notification_based_authentication_flow"><a class="anchor" href="#_notification_based_authentication_flow"></a>Notification based authentication flow</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The following sequence diagram gives an overview of the notification based authentication flow.</p>
</div>
<div class="imageblock sequence kroki-format-svg kroki">
<div class="content">
<a class="image" href="_images/flow-48d17b33d37ee99f0ed104ace46784cc0ff6e3e3.svg"><img src="_images/flow-48d17b33d37ee99f0ed104ace46784cc0ff6e3e3.svg" alt="flow"></a>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_notification_based_signing_flow"><a class="anchor" href="#_notification_based_signing_flow"></a>Notification based signing flow</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The following sequence diagram illustrates the notification based signing flow.</p>
</div>
<div class="imageblock sequence kroki-format-svg kroki">
<div class="content">
<a class="image" href="_images/flow-743c73634d16aa32a8e4fec6a077bf8cdf0f1856.svg"><img src="_images/flow-743c73634d16aa32a8e4fec6a077bf8cdf0f1856.svg" alt="flow"></a>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_guide_for_brokers"><a class="anchor" href="#_implementation_guide_for_brokers"></a>Implementation guide for brokers</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Brokers (including identity platform providers) typically integrate directly to different Identity Providers (like Smart-ID) in order to provide a simplified authentication and signing API to their Service Providers. How to integrate to Smart-ID services mainly depends on whether the Service Providers redirect users away to the broker to perform authentication and signing (e.g., using the OpenID Connect protocol). Some brokers don&#8217;t require redirection to their service and instead offer a simplified API to use Smart-ID without providing their own UI.</p>
</div>
<div class="paragraph">
<p>When redirections are used (e.g., using OpenID Connect protocol) the broker integrates like any other RP to Smart-ID RP-API.</p>
</div>
<div class="paragraph">
<p>When service providers do not redirect their users away from their UI to the broker then integration is slightly different depending on the flow type that is used:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Notification based authentication and signing flows should be implemented identically by brokers and other RP-s.</p>
</li>
<li>
<p>In dynamic link flows broker is still solely communicating with the RP-API, but users have to be shown periodically changing QR codes in multi-device use cases and Web2App or App2App links in same-device use cases. Those links have to be calculated by knowing secrets that only broker will know. This means that an additional API to poll QR codes and provide other dynamic links should be offered. For enhanced security, callback URL-s to Service Provider website or app is also strongly recommended in same-device use cases.</p>
</li>
</ul>
</div>
</div>
</div>
</article>
  </div>
</main>
</div>
<footer class="footer">
  <p>This page was built using the Antora default UI.</p>
  <p>The source code for this UI is licensed under the terms of the MPL-2.0 license.</p>
</footer>
<script id="site-script" src="../_/js/site.js" data-ui-root-path="../_"></script>
<script async src="../_/js/vendor/highlight.js"></script>
<script async src="../_/js/vendor/tabs.js" data-sync-storage-key="language"></script>
<script src="../_/js/vendor/lunr.js"></script>
<script src="../_/js/search-ui.js" id="search-ui-script" data-site-root-path=".." data-snippet-length="100" data-stylesheet="../_/css/search.css"></script>
<script async src="../search-index.js"></script>
  </body>
</html>
