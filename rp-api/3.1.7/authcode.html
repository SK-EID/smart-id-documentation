<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>authCode calculation :: Smart-ID documentation</title>
    <link rel="canonical" href="https://sk-eid.github.io/smart-id-documentation/rp-api/authcode.html">
    <meta name="generator" content="Antora 3.1.10">
    <link rel="stylesheet" href="../../_/css/site.css">

<link rel="icon" href="../../_/img/favicon.svg" type="image/x-icon">
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://sk-eid.github.io/smart-id-documentation">
        <img src="../../_/img/sk-id-solutions.svg" class="logo" />
      </a>
      <span class="separator"></span>
      <span class="title">Smart-ID documentation</span>
    </div>

    <div class="navbar-right">
      <div class="navbar-item search hide-for-print">
        <div id="search-field" class="field">
          <input id="search-input" type="text" placeholder="Search the docs">
        </div>
      </div>
      <button class="nav-toggle"></button>    </div>

  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="rp-api" data-version="3.1.7">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="introduction.html">Relying Party API</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <span class="nav-text">Smart-ID Documentation</span>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../index.html">Getting started</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../demo.html">Try out</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../implementation.html">Smart-ID integration</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../environments.html">Environments</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../device_link.html">Device link fallback page</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../https_pinning.html">HTTPS pinning</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../client_libraries.html">Client libraries</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../suggestions.html">Suggestions</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../logos.html">Logos</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../faq.html">FAQ</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../app_release_notes.html">App Release Notes</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../contact.html">Contact</a>
  </li>
  <li class="nav-item" data-depth="1">
    <span class="nav-text">Automated testing</span>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../mock_service.html">Introduction</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../device_link_test_endpoint.html">Device link test endpoint</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../test_accounts.html">Test accounts</a>
  </li>
  <li class="nav-item" data-depth="1">
    <span class="nav-text">Relying Party API</span>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../introduction.html">Introduction</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../changes.html">Changelog</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../glossary.html">Glossary</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../overview_of_api_endpoints.html">Overview of API endpoints</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../api_specification.html">OpenAPI specification</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../device_link_flows.html">Device link flows</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../authcode.html"><code>authCode</code> calculation</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../notification_based_flows.html">Notification based flows</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../api_details.html">API technical description</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../interactions.html">Interactions</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../signature_protocols.html">Signature protocols</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../callback_urls.html">Callback URLs</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../response_verification.html">Response verification</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../additional_security_measures.html">Additional security measures</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Relying Party API</span>
    <span class="version">3.1.7</span>
  </div>
  <ul class="components">
    <li class="component">
      <div class="title"><a href="../../index.html">Documentation</a></div>
    </li>
    <li class="component is-current">
      <div class="title"><a href="../introduction.html">Relying Party API</a></div>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../introduction.html">3.2.0</a>
        </li>
        <li class="version is-current">
          <a href="introduction.html">3.1.7</a>
        </li>
        <li class="version">
          <a href="../3.0.3/introduction.html">3.0.3</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
  <div class="content">
<aside class="toc sidebar" data-title="On this page" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page"><code>authCode</code> calculation</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>The <code>authCode</code> parameter is calculated using a <code>sessionSecret</code> value and added to the device links (QR/Web2App/App2App) in order to protect the link from unauthorized changes. Calculation of the <code>authCode</code> parameter also relies on the assembled device link itself (except for the <code>authCode</code> parameter). This assembled device link without the <code>authCode</code> parameter is referred to as <code>unprotectedDeviceLink</code>.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="title"><code>authCodePayload</code> fields</div>
<div class="paragraph">
<p>The order of the fields in the <code>authCodePayload</code> must be the same as specified in the examples below.</p>
</div>
<div class="paragraph">
<p>All values are required and must be non-empty; the only exceptions to this are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>in QR flows, <code>initialCallbackUrl</code> <strong>must be empty</strong> and the separator must still be used, i.e. <code>||</code>;</p>
</li>
<li>
<p>in same-device flows (App2App &amp; Web2App), <code>elapsedSeconds</code> parameter must be missing from <code>unprotectedDeviceLink</code>.</p>
</li>
<li>
<p>in certificate-choice session requests parameters <code>digest</code>, <code>interactions</code> and <code>signatureProtocol</code> must be included as empty fields;</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="title">Encoding</div>
<div class="paragraph">
<p>Both Base64 and Base64URL encodings are used in the RP API, be careful to use the appropriate encoding as specified.</p>
</div>
<div class="paragraph">
<p>As specified in <a href="https://datatracker.ietf.org/doc/html/rfc4648#section-5">RFC 4648 Section 5</a>, Base64URL makes the following two substitutions in comparison with the standard Base64 alphabet: <code>+</code> &#8594; <code>-</code> and <code>/</code> &#8594; <code>_</code> and as allowed in <a href="https://datatracker.ietf.org/doc/html/rfc4648#section-3.2">RFC 4648 Section 3.2</a> all trailing <code>=</code> characters <strong>must be</strong> omitted.</p>
</div>
<div class="paragraph">
<p>However, it is recommended to use a standard library function for encoding Base64URL.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_authcode_parameter"><a class="anchor" href="#_authcode_parameter"></a><code>authCode</code> parameter</h2>
<div class="sectionbody">
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>As the first step, RP assembles <code>authCodePayload</code> using byte concatenation, using the byte representation of vertical bar character <code>|</code> (U+007C) as a separator:</p>
</div>
<div id="_tabs_1" class="openblock tabs is-sync is-loading">
<div class="content">
<div class="ulist tablist">
<ul>
<li id="_tabs_1_web2app" class="tab">
<p>Web2App</p>
</li>
<li id="_tabs_1_app2app" class="tab">
<p>App2App</p>
</li>
<li id="_tabs_1_qr" class="tab">
<p>QR</p>
</li>
</ul>
</div>
<div id="_tabs_1_web2app--panel" class="tabpanel" aria-labelledby="_tabs_1_web2app">
<div class="openblock">
<div class="content">
<div id="_tabs_2" class="openblock tabs is-sync is-loading">
<div class="content">
<div class="ulist tablist">
<ul>
<li id="_tabs_2_authentication_session" class="tab">
<p>Authentication Session</p>
</li>
<li id="_tabs_2_signature_session" class="tab">
<p>Signature Session</p>
</li>
<li id="_tabs_2_certificate_choice_session" class="tab">
<p>Certificate-choice Session</p>
</li>
</ul>
</div>
<div id="_tabs_2_authentication_session--panel" class="tabpanel" aria-labelledby="_tabs_2_authentication_session">
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>For authentication session device links <code>signatureProtocol</code> value is <code>ACSP_V2</code>:</p>
</div>
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">authCodePayload := UTF8-ENCODE(STR-CONCAT(
        'smart-id', '|',
        'ACSP_V2', '|',
        rpChallenge, '|',
        BASE64-ENCODE(relyingPartyName), '|',
        BASE64-ENCODE(brokeredRpName), '|',
        interactions, '|',
        initialCallbackUrl, '|',
        unprotectedDeviceLink))</code></pre>
</div>
</div>
<div id="_tabs_3" class="openblock tabs is-sync is-loading">
<div class="content">
<div class="ulist tablist">
<ul>
<li id="_tabs_3_java" class="tab">
<p>Java</p>
</li>
<li id="_tabs_3_php" class="tab">
<p>PHP</p>
</li>
<li id="_tabs_3_python" class="tab">
<p>Python</p>
</li>
<li id="_tabs_3_go" class="tab">
<p>Go</p>
</li>
<li id="_tabs_3_rust" class="tab">
<p>Rust</p>
</li>
<li id="_tabs_3_kotlin" class="tab">
<p>Kotlin</p>
</li>
<li id="_tabs_3_c" class="tab">
<p>C#</p>
</li>
<li id="_tabs_3_node_js" class="tab">
<p>Node.js</p>
</li>
<li id="_tabs_3_ruby" class="tab">
<p>Ruby</p>
</li>
</ul>
</div>
<div id="_tabs_3_java--panel" class="tabpanel" aria-labelledby="_tabs_3_java">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public class AuthCodePayload {

  public static void main(String[] args) throws Exception {
    String separator = "|";
    String schemeName = "smart-id";
    String signatureProtocol = "ACSP_V2";
    String rpChallenge = "GYS+yoah6emAcVDNIajwSs6UB/M95XrDxMzXBUkwQJ9YFDipXXzGpPc7raWcuc2+TEoRc7WvIZ/7dU/iRXenYg==";
    String relyingPartyNameBase64 = "REVNTw==";
    String brokeredRpNameBase64 = "RXhhbXBsZSBSUA==";
    String interactions = "W3sidHlwZSI6ImNvbmZpcm1hdGlvbk1lc3NhZ2UiLCJkaXNwbGF5VGV4dDIwMCI6IkxvbmdlciBkZXNjcmlwdGlvbiBvZiB0aGUgdHJhbnNhY3Rpb24gY29udGV4dCJ9LHsidHlwZSI6ImRpc3BsYXlUZXh0QW5kUElOIiwiZGlzcGxheVRleHQ2MCI6IlNob3J0IGRlc2NyaXB0aW9uIG9mIHRoZSB0cmFuc2FjdGlvbiBjb250ZXh0In1d";
    String initialCallbackUrl = "https://rp.example.com/callback-url?value=RrKjjT4aggzu27YBddX1bQ";
    String unprotectedDeviceLink = "https://smart-id.com/device-link?deviceLinkType=Web2App&amp;sessionToken=wGIrqveE6AuGDATZKmR1mtAZ&amp;sessionType=auth&amp;version=1.0&amp;lang=eng";

    String[] payloadParts = {
      schemeName,
      signatureProtocol,
      rpChallenge,
      relyingPartyNameBase64,
      brokeredRpNameBase64,
      interactions,
      initialCallbackUrl,
      unprotectedDeviceLink
    };

    String authCodePayload = String.join(separator, payloadParts);
    System.out.println(authCodePayload);
  }
}</code></pre>
</div>
</div>
</div>
<div id="_tabs_3_php--panel" class="tabpanel" aria-labelledby="_tabs_3_php">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-php hljs" data-lang="php">&lt;?php

$separator = '|';

$schemeName = 'smart-id';
$signatureProtocol = 'ACSP_V2';
$rpChallenge = 'GYS+yoah6emAcVDNIajwSs6UB/M95XrDxMzXBUkwQJ9YFDipXXzGpPc7raWcuc2+TEoRc7WvIZ/7dU/iRXenYg==';
$relyingPartyNameBase64 = 'REVNTw==';
$brokeredRpNameBase64 = 'RXhhbXBsZSBSUA==';
$interactions = 'W3sidHlwZSI6ImNvbmZpcm1hdGlvbk1lc3NhZ2UiLCJkaXNwbGF5VGV4dDIwMCI6IkxvbmdlciBkZXNjcmlwdGlvbiBvZiB0aGUgdHJhbnNhY3Rpb24gY29udGV4dCJ9LHsidHlwZSI6ImRpc3BsYXlUZXh0QW5kUElOIiwiZGlzcGxheVRleHQ2MCI6IlNob3J0IGRlc2NyaXB0aW9uIG9mIHRoZSB0cmFuc2FjdGlvbiBjb250ZXh0In1d';
$initialCallbackUrl = 'https://rp.example.com/callback-url?value=RrKjjT4aggzu27YBddX1bQ';
$unprotectedDeviceLink = 'https://smart-id.com/device-link?deviceLinkType=Web2App&amp;sessionToken=wGIrqveE6AuGDATZKmR1mtAZ&amp;sessionType=auth&amp;version=1.0&amp;lang=eng';

$authCodePayload = implode($separator, [
    $schemeName,
    $signatureProtocol,
    $rpChallenge,
    $relyingPartyNameBase64,
    $brokeredRpNameBase64,
    $interactions,
    $initialCallbackUrl,
    $unprotectedDeviceLink
]);

echo $authCodePayload;

?&gt;</code></pre>
</div>
</div>
</div>
<div id="_tabs_3_python--panel" class="tabpanel" aria-labelledby="_tabs_3_python">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">separator = '|'

scheme_name = 'smart-id'
signature_protocol = 'ACSP_V2'
rp_challenge = 'GYS+yoah6emAcVDNIajwSs6UB/M95XrDxMzXBUkwQJ9YFDipXXzGpPc7raWcuc2+TEoRc7WvIZ/7dU/iRXenYg=='
relying_party_name_base64 = 'REVNTw=='
brokered_rp_name_base64 = 'RXhhbXBsZSBSUA=='
interactions = 'W3sidHlwZSI6ImNvbmZpcm1hdGlvbk1lc3NhZ2UiLCJkaXNwbGF5VGV4dDIwMCI6IkxvbmdlciBkZXNjcmlwdGlvbiBvZiB0aGUgdHJhbnNhY3Rpb24gY29udGV4dCJ9LHsidHlwZSI6ImRpc3BsYXlUZXh0QW5kUElOIiwiZGlzcGxheVRleHQ2MCI6IlNob3J0IGRlc2NyaXB0aW9uIG9mIHRoZSB0cmFuc2FjdGlvbiBjb250ZXh0In1d'
initial_callback_url = 'https://rp.example.com/callback-url?value=RrKjjT4aggzu27YBddX1bQ'
unprotected_device_link = 'https://smart-id.com/device-link?deviceLinkType=Web2App&amp;sessionToken=wGIrqveE6AuGDATZKmR1mtAZ&amp;sessionType=auth&amp;version=1.0&amp;lang=eng'

auth_code_payload = separator.join([
    scheme_name,
    signature_protocol,
    rp_challenge,
    relying_party_name_base64,
    brokered_rp_name_base64,
    interactions,
    initial_callback_url,
    unprotected_device_link
])

print(auth_code_payload)</code></pre>
</div>
</div>
</div>
<div id="_tabs_3_go--panel" class="tabpanel" aria-labelledby="_tabs_3_go">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-go hljs" data-lang="go">package main

import (
	"fmt"
)

func main() {
	var separator string = "|"

	var schemeName string = "smart-id"
	var signatureProtocol string = "ACSP_V2"
	var rpChallenge string = "GYS+yoah6emAcVDNIajwSs6UB/M95XrDxMzXBUkwQJ9YFDipXXzGpPc7raWcuc2+TEoRc7WvIZ/7dU/iRXenYg=="
	var relyingPartyNameBase64 string = "REVNTw=="
	var brokeredRpNameBase64 string = "RXhhbXBsZSBSUA=="
	var interactions string = "W3sidHlwZSI6ImNvbmZpcm1hdGlvbk1lc3NhZ2UiLCJkaXNwbGF5VGV4dDIwMCI6IkxvbmdlciBkZXNjcmlwdGlvbiBvZiB0aGUgdHJhbnNhY3Rpb24gY29udGV4dCJ9LHsidHlwZSI6ImRpc3BsYXlUZXh0QW5kUElOIiwiZGlzcGxheVRleHQ2MCI6IlNob3J0IGRlc2NyaXB0aW9uIG9mIHRoZSB0cmFuc2FjdGlvbiBjb250ZXh0In1d"
	var initialCallbackUrl string = "https://rp.example.com/callback-url?value=RrKjjT4aggzu27YBddX1bQ"
	var unprotectedDeviceLink string = "https://smart-id.com/device-link?deviceLinkType=Web2App&amp;sessionToken=wGIrqveE6AuGDATZKmR1mtAZ&amp;sessionType=auth&amp;version=1.0&amp;lang=eng"

	var payloadParts = []string{
		schemeName,
		signatureProtocol,
		rpChallenge,
		relyingPartyNameBase64,
		brokeredRpNameBase64,
		interactions,
		initialCallbackUrl,
		unprotectedDeviceLink,
	}

	var authCodePayload string = strings.Join(payloadParts, separator)

	fmt.Printf("%q\n", authCodePayload)
}</code></pre>
</div>
</div>
</div>
<div id="_tabs_3_rust--panel" class="tabpanel" aria-labelledby="_tabs_3_rust">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-rust hljs" data-lang="rust">fn main() {
    let separator: &amp;str = "|";
    let scheme_name: &amp;str = "smart-id";
    let signature_protocol: &amp;str = "ACSP_V2";
    let rp_challenge: &amp;str = "GYS+yoah6emAcVDNIajwSs6UB/M95XrDxMzXBUkwQJ9YFDipXXzGpPc7raWcuc2+TEoRc7WvIZ/7dU/iRXenYg==";
    let relying_party_name_base64: &amp;str = "REVNTw==";
    let brokered_rp_name_base64: &amp;str = "RXhhbXBsZSBSUA==";
    let interactions: &amp;str = "W3sidHlwZSI6ImNvbmZpcm1hdGlvbk1lc3NhZ2UiLCJkaXNwbGF5VGV4dDIwMCI6IkxvbmdlciBkZXNjcmlwdGlvbiBvZiB0aGUgdHJhbnNhY3Rpb24gY29udGV4dCJ9LHsidHlwZSI6ImRpc3BsYXlUZXh0QW5kUElOIiwiZGlzcGxheVRleHQ2MCI6IlNob3J0IGRlc2NyaXB0aW9uIG9mIHRoZSB0cmFuc2FjdGlvbiBjb250ZXh0In1d";
    let initial_callback_url: &amp;str = "https://rp.example.com/callback-url?value=RrKjjT4aggzu27YBddX1bQ";
    let unprotected_device_link: &amp;str = "https://smart-id.com/device-link?deviceLinkType=Web2App&amp;sessionToken=wGIrqveE6AuGDATZKmR1mtAZ&amp;sessionType=auth&amp;version=1.0&amp;lang=eng";

    let auth_code_payload_parts: [&str; 7] = [
        scheme_name,
        signature_protocol,
        rp_challenge,
        relying_party_name_base64,
        brokered_rp_name_base64,
        interactions,
        initial_callback_url,
        unprotected_device_link
    ];

    let auth_code_payload: String = auth_code_payload_parts.join(separator);

    println!("{}", auth_code_payload)
}</code></pre>
</div>
</div>
</div>
<div id="_tabs_3_kotlin--panel" class="tabpanel" aria-labelledby="_tabs_3_kotlin">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">fun main() {
    val separator: String = "|"

    val schemeName: String = "smart-id"
    val signatureProtocol: String = "ACSP_V2"
    val rpChallenge: String = "GYS+yoah6emAcVDNIajwSs6UB/M95XrDxMzXBUkwQJ9YFDipXXzGpPc7raWcuc2+TEoRc7WvIZ/7dU/iRXenYg=="
    val relyingPartyNameBase64: String = "REVNTw=="
    val brokeredRpNameBase64: String = "RXhhbXBsZSBSUA=="
    val interactions: String = "W3sidHlwZSI6ImNvbmZpcm1hdGlvbk1lc3NhZ2UiLCJkaXNwbGF5VGV4dDIwMCI6IkxvbmdlciBkZXNjcmlwdGlvbiBvZiB0aGUgdHJhbnNhY3Rpb24gY29udGV4dCJ9LHsidHlwZSI6ImRpc3BsYXlUZXh0QW5kUElOIiwiZGlzcGxheVRleHQ2MCI6IlNob3J0IGRlc2NyaXB0aW9uIG9mIHRoZSB0cmFuc2FjdGlvbiBjb250ZXh0In1d"
    val initialCallbackUrl: String = "https://rp.example.com/callback-url?value=RrKjjT4aggzu27YBddX1bQ"
    val unprotectedDeviceLink: String = "https://smart-id.com/device-link?deviceLinkType=Web2App&amp;sessionToken=wGIrqveE6AuGDATZKmR1mtAZ&amp;sessionType=auth&amp;version=1.0&amp;lang=eng"

    val payloadParts: List&lt;String&gt; = listOf(
        schemeName,
        signatureProtocol,
        rpChallenge,
        relyingPartyNameBase64,
        brokeredRpNameBase64,
        interactions,
        initialCallbackUrl,
        unprotectedDeviceLink
    )

    val authCodePayload: String = payloadParts.joinToString(separator)

    println(authCodePayload)
}</code></pre>
</div>
</div>
</div>
<div id="_tabs_3_c--panel" class="tabpanel" aria-labelledby="_tabs_3_c">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-cs hljs" data-lang="cs">using System;

public class AuthCodePayload
{
    public static void Main()
    {
        string separator = "|";

        string schemeName = "smart-id";
        string signatureProtocol = "ACSP_V2";
        string rpChallenge = "GYS+yoah6emAcVDNIajwSs6UB/M95XrDxMzXBUkwQJ9YFDipXXzGpPc7raWcuc2+TEoRc7WvIZ/7dU/iRXenYg==";
        string relyingPartyNameBase64 = "REVNTw==";
        string brokeredRpNameBase64 = "RXhhbXBsZSBSUA==";
        string interactions = "W3sidHlwZSI6ImNvbmZpcm1hdGlvbk1lc3NhZ2UiLCJkaXNwbGF5VGV4dDIwMCI6IkxvbmdlciBkZXNjcmlwdGlvbiBvZiB0aGUgdHJhbnNhY3Rpb24gY29udGV4dCJ9LHsidHlwZSI6ImRpc3BsYXlUZXh0QW5kUElOIiwiZGlzcGxheVRleHQ2MCI6IlNob3J0IGRlc2NyaXB0aW9uIG9mIHRoZSB0cmFuc2FjdGlvbiBjb250ZXh0In1d";
        string initialCallbackUrl = "https://rp.example.com/callback-url?value=RrKjjT4aggzu27YBddX1bQ";
        string unprotectedDeviceLink = "https://smart-id.com/device-link?deviceLinkType=Web2App&amp;sessionToken=wGIrqveE6AuGDATZKmR1mtAZ&amp;sessionType=auth&amp;version=1.0&amp;lang=eng";

        string[] payloadParts = {
            schemeName,
            signatureProtocol,
            rpChallenge,
            relyingPartyNameBase64,
            brokeredRpNameBase64,
            interactions,
            initialCallbackUrl,
            unprotectedDeviceLink
        };

        string authCodePayload = string.Join(separator, payloadParts);
        Console.WriteLine(authCodePayload);
    }
}</code></pre>
</div>
</div>
</div>
<div id="_tabs_3_node_js--panel" class="tabpanel" aria-labelledby="_tabs_3_node_js">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-js hljs" data-lang="js">const separator = '|';

const schemeName = 'smart-id';
const signatureProtocol = 'ACSP_V2';
const rpChallenge = 'GYS+yoah6emAcVDNIajwSs6UB/M95XrDxMzXBUkwQJ9YFDipXXzGpPc7raWcuc2+TEoRc7WvIZ/7dU/iRXenYg==';
const relyingPartyNameBase64 = 'REVNTw==';
const brokeredRpNameBase64 = 'RXhhbXBsZSBSUA==';
const interactions = 'W3sidHlwZSI6ImNvbmZpcm1hdGlvbk1lc3NhZ2UiLCJkaXNwbGF5VGV4dDIwMCI6IkxvbmdlciBkZXNjcmlwdGlvbiBvZiB0aGUgdHJhbnNhY3Rpb24gY29udGV4dCJ9LHsidHlwZSI6ImRpc3BsYXlUZXh0QW5kUElOIiwiZGlzcGxheVRleHQ2MCI6IlNob3J0IGRlc2NyaXB0aW9uIG9mIHRoZSB0cmFuc2FjdGlvbiBjb250ZXh0In1d';
const initialCallbackUrl = 'https://rp.example.com/callback-url?value=RrKjjT4aggzu27YBddX1bQ';
const unprotectedDeviceLink = 'https://smart-id.com/device-link?deviceLinkType=Web2App&amp;sessionToken=wGIrqveE6AuGDATZKmR1mtAZ&amp;sessionType=auth&amp;version=1.0&amp;lang=eng';

const authCodePayload = [
    schemeName,
    signatureProtocol,
    rpChallenge,
    relyingPartyNameBase64,
    brokeredRpNameBase64,
    interactions,
    initialCallbackUrl,
    unprotectedDeviceLink
].join(separator);

console.log(authCodePayload);</code></pre>
</div>
</div>
</div>
<div id="_tabs_3_ruby--panel" class="tabpanel" aria-labelledby="_tabs_3_ruby">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby">separator = '|'

scheme_name = 'smart-id'
signature_protocol = 'ACSP_V2'
rp_challenge = 'GYS+yoah6emAcVDNIajwSs6UB/M95XrDxMzXBUkwQJ9YFDipXXzGpPc7raWcuc2+TEoRc7WvIZ/7dU/iRXenYg=='
relying_party_name_base64 = 'REVNTw=='
brokered_rp_name_base64 = 'RXhhbXBsZSBSUA=='
interactions = 'W3sidHlwZSI6ImNvbmZpcm1hdGlvbk1lc3NhZ2UiLCJkaXNwbGF5VGV4dDIwMCI6IkxvbmdlciBkZXNjcmlwdGlvbiBvZiB0aGUgdHJhbnNhY3Rpb24gY29udGV4dCJ9LHsidHlwZSI6ImRpc3BsYXlUZXh0QW5kUElOIiwiZGlzcGxheVRleHQ2MCI6IlNob3J0IGRlc2NyaXB0aW9uIG9mIHRoZSB0cmFuc2FjdGlvbiBjb250ZXh0In1d'
initial_callback_url = 'https://rp.example.com/callback-url?value=RrKjjT4aggzu27YBddX1bQ'
unprotected_device_link = 'https://smart-id.com/device-link?deviceLinkType=Web2App&amp;sessionToken=wGIrqveE6AuGDATZKmR1mtAZ&amp;sessionType=auth&amp;version=1.0&amp;lang=eng'

auth_code_payload = [
    scheme_name,
    signature_protocol,
    rp_challenge,
    relying_party_name_base64,
    brokered_rp_name_base64,
    interactions,
    initial_callback_url,
    unprotected_device_link
].join(separator)

puts auth_code_payload</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="_tabs_2_signature_session--panel" class="tabpanel" aria-labelledby="_tabs_2_signature_session">
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>For signature session device links <code>digest</code> value replaces the <code>rpChallenge</code>, and <code>signatureProtocol</code> value is <code>RAW_DIGEST_SIGNATURE</code>:</p>
</div>
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">authCodePayload := UTF8-ENCODE(STR-CONCAT(
        'smart-id', '|',
        'RAW_DIGEST_SIGNATURE', '|',
        digest, '|',
        BASE64-ENCODE(relyingPartyName), '|',
        BASE64-ENCODE(brokeredRpName), '|',
        interactions, '|',
        initialCallbackUrl, '|',
        unprotectedDeviceLink))</code></pre>
</div>
</div>
<div id="_tabs_4" class="openblock tabs is-sync is-loading">
<div class="content">
<div class="ulist tablist">
<ul>
<li id="_tabs_4_java" class="tab">
<p>Java</p>
</li>
<li id="_tabs_4_php" class="tab">
<p>PHP</p>
</li>
<li id="_tabs_4_python" class="tab">
<p>Python</p>
</li>
<li id="_tabs_4_go" class="tab">
<p>Go</p>
</li>
<li id="_tabs_4_rust" class="tab">
<p>Rust</p>
</li>
<li id="_tabs_4_kotlin" class="tab">
<p>Kotlin</p>
</li>
<li id="_tabs_4_c" class="tab">
<p>C#</p>
</li>
<li id="_tabs_4_node_js" class="tab">
<p>Node.js</p>
</li>
<li id="_tabs_4_ruby" class="tab">
<p>Ruby</p>
</li>
</ul>
</div>
<div id="_tabs_4_java--panel" class="tabpanel" aria-labelledby="_tabs_4_java">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public class AuthCodePayload {

  public static void main(String[] args) throws Exception {
    String separator = "|";
    String schemeName = "smart-id";
    String signatureProtocol = "RAW_DIGEST_SIGNATURE";
    String digest = "FNZFFya5wGLv9b27fZngaWrOBqle4tGwxZuDFRBdPl1RQvxJsfoqvTbjafd+8BcehMOQGvak6zlP+F8tga4bfQ==";
    String relyingPartyNameBase64 = "REVNTw==";
    String brokeredRpNameBase64 = "RXhhbXBsZSBSUA==";
    String interactions = "W3sidHlwZSI6ImNvbmZpcm1hdGlvbk1lc3NhZ2UiLCJkaXNwbGF5VGV4dDIwMCI6IkxvbmdlciBkZXNjcmlwdGlvbiBvZiB0aGUgdHJhbnNhY3Rpb24gY29udGV4dCJ9LHsidHlwZSI6ImRpc3BsYXlUZXh0QW5kUElOIiwiZGlzcGxheVRleHQ2MCI6IlNob3J0IGRlc2NyaXB0aW9uIG9mIHRoZSB0cmFuc2FjdGlvbiBjb250ZXh0In1d";
    String initialCallbackUrl = "https://rp.example.com/callback-url?value=RrKjjT4aggzu27YBddX1bQ";
    String unprotectedDeviceLink = "https://smart-id.com/device-link?deviceLinkType=Web2App&amp;sessionToken=wGIrqveE6AuGDATZKmR1mtAZ&amp;sessionType=auth&amp;version=1.0&amp;lang=eng";

    String[] payloadParts = {
      schemeName,
      signatureProtocol,
      digest,
      relyingPartyNameBase64,
      brokeredRpNameBase64,
      interactions,
      initialCallbackUrl,
      unprotectedDeviceLink
    };

    String authCodePayload = String.join(separator, payloadParts);
    System.out.println(authCodePayload);
  }
}</code></pre>
</div>
</div>
</div>
<div id="_tabs_4_php--panel" class="tabpanel" aria-labelledby="_tabs_4_php">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-php hljs" data-lang="php">&lt;?php

$separator = '|';

$schemeName = 'smart-id';
$signatureProtocol = 'RAW_DIGEST_SIGNATURE';
$digest = 'FNZFFya5wGLv9b27fZngaWrOBqle4tGwxZuDFRBdPl1RQvxJsfoqvTbjafd+8BcehMOQGvak6zlP+F8tga4bfQ==';
$relyingPartyNameBase64 = 'REVNTw==';
$brokeredRpNameBase64 = 'RXhhbXBsZSBSUA==';
$interactions = 'W3sidHlwZSI6ImNvbmZpcm1hdGlvbk1lc3NhZ2UiLCJkaXNwbGF5VGV4dDIwMCI6IkxvbmdlciBkZXNjcmlwdGlvbiBvZiB0aGUgdHJhbnNhY3Rpb24gY29udGV4dCJ9LHsidHlwZSI6ImRpc3BsYXlUZXh0QW5kUElOIiwiZGlzcGxheVRleHQ2MCI6IlNob3J0IGRlc2NyaXB0aW9uIG9mIHRoZSB0cmFuc2FjdGlvbiBjb250ZXh0In1d';
$initialCallbackUrl = 'https://rp.example.com/callback-url?value=RrKjjT4aggzu27YBddX1bQ';
$unprotectedDeviceLink = 'https://smart-id.com/device-link?deviceLinkType=Web2App&amp;sessionToken=wGIrqveE6AuGDATZKmR1mtAZ&amp;sessionType=auth&amp;version=1.0&amp;lang=eng';

$authCodePayload = implode($separator, [
    $schemeName,
    $signatureProtocol,
    $digest,
    $relyingPartyNameBase64,
    $brokeredRpNameBase64,
    $interactions,
    $initialCallbackUrl,
    $unprotectedDeviceLink
]);

echo $authCodePayload;

?&gt;</code></pre>
</div>
</div>
</div>
<div id="_tabs_4_python--panel" class="tabpanel" aria-labelledby="_tabs_4_python">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">separator = '|'

scheme_name = 'smart-id'
signature_protocol = 'RAW_DIGEST_SIGNATURE'
digest = 'FNZFFya5wGLv9b27fZngaWrOBqle4tGwxZuDFRBdPl1RQvxJsfoqvTbjafd+8BcehMOQGvak6zlP+F8tga4bfQ=='
relying_party_name_base64 = 'REVNTw=='
brokered_rp_name_base64 = 'RXhhbXBsZSBSUA=='
interactions = 'W3sidHlwZSI6ImNvbmZpcm1hdGlvbk1lc3NhZ2UiLCJkaXNwbGF5VGV4dDIwMCI6IkxvbmdlciBkZXNjcmlwdGlvbiBvZiB0aGUgdHJhbnNhY3Rpb24gY29udGV4dCJ9LHsidHlwZSI6ImRpc3BsYXlUZXh0QW5kUElOIiwiZGlzcGxheVRleHQ2MCI6IlNob3J0IGRlc2NyaXB0aW9uIG9mIHRoZSB0cmFuc2FjdGlvbiBjb250ZXh0In1d'
initial_callback_url = 'https://rp.example.com/callback-url?value=RrKjjT4aggzu27YBddX1bQ'
unprotected_device_link = 'https://smart-id.com/device-link?deviceLinkType=Web2App&amp;sessionToken=wGIrqveE6AuGDATZKmR1mtAZ&amp;sessionType=auth&amp;version=1.0&amp;lang=eng'

auth_code_payload = separator.join([
    scheme_name,
    signature_protocol,
    digest,
    relying_party_name_base64,
    brokered_rp_name_base64,
    interactions,
    initial_callback_url,
    unprotected_device_link
])

print(auth_code_payload)</code></pre>
</div>
</div>
</div>
<div id="_tabs_4_go--panel" class="tabpanel" aria-labelledby="_tabs_4_go">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-go hljs" data-lang="go">package main

import (
	"fmt"
)

func main() {
	var separator string = "|"

	var schemeName string = "smart-id"
	var signatureProtocol string = "RAW_DIGEST_SIGNATURE"
	var digest string = "FNZFFya5wGLv9b27fZngaWrOBqle4tGwxZuDFRBdPl1RQvxJsfoqvTbjafd+8BcehMOQGvak6zlP+F8tga4bfQ=="
	var relyingPartyNameBase64 string = "REVNTw=="
	var brokeredRpNameBase64 string = "RXhhbXBsZSBSUA=="
	var interactions string = "W3sidHlwZSI6ImNvbmZpcm1hdGlvbk1lc3NhZ2UiLCJkaXNwbGF5VGV4dDIwMCI6IkxvbmdlciBkZXNjcmlwdGlvbiBvZiB0aGUgdHJhbnNhY3Rpb24gY29udGV4dCJ9LHsidHlwZSI6ImRpc3BsYXlUZXh0QW5kUElOIiwiZGlzcGxheVRleHQ2MCI6IlNob3J0IGRlc2NyaXB0aW9uIG9mIHRoZSB0cmFuc2FjdGlvbiBjb250ZXh0In1d"
	var initialCallbackUrl string = "https://rp.example.com/callback-url?value=RrKjjT4aggzu27YBddX1bQ"
	var unprotectedDeviceLink string = "https://smart-id.com/device-link?deviceLinkType=Web2App&amp;sessionToken=wGIrqveE6AuGDATZKmR1mtAZ&amp;sessionType=auth&amp;version=1.0&amp;lang=eng"

	var payloadParts = []string{
		schemeName,
		signatureProtocol,
		digest,
		relyingPartyNameBase64,
		brokeredRpNameBase64,
		interactions,
		initialCallbackUrl,
		unprotectedDeviceLink,
	}

	var authCodePayload string = strings.Join(payloadParts, separator)

	fmt.Printf("%q\n", authCodePayload)
}</code></pre>
</div>
</div>
</div>
<div id="_tabs_4_rust--panel" class="tabpanel" aria-labelledby="_tabs_4_rust">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-rust hljs" data-lang="rust">fn main() {
    let separator: &amp;str = "|";
    let scheme_name: &amp;str = "smart-id";
    let signature_protocol: &amp;str = "RAW_DIGEST_SIGNATURE";
    let digest: &amp;str = "FNZFFya5wGLv9b27fZngaWrOBqle4tGwxZuDFRBdPl1RQvxJsfoqvTbjafd+8BcehMOQGvak6zlP+F8tga4bfQ==";
    let relying_party_name_base64: &amp;str = "REVNTw==";
    let brokered_rp_name_base64: &amp;str = "RXhhbXBsZSBSUA==";
    let interactions: &amp;str = "W3sidHlwZSI6ImNvbmZpcm1hdGlvbk1lc3NhZ2UiLCJkaXNwbGF5VGV4dDIwMCI6IkxvbmdlciBkZXNjcmlwdGlvbiBvZiB0aGUgdHJhbnNhY3Rpb24gY29udGV4dCJ9LHsidHlwZSI6ImRpc3BsYXlUZXh0QW5kUElOIiwiZGlzcGxheVRleHQ2MCI6IlNob3J0IGRlc2NyaXB0aW9uIG9mIHRoZSB0cmFuc2FjdGlvbiBjb250ZXh0In1d";
    let initial_callback_url: &amp;str = "https://rp.example.com/callback-url?value=RrKjjT4aggzu27YBddX1bQ";
    let unprotected_device_link: &amp;str = "https://smart-id.com/device-link?deviceLinkType=Web2App&amp;sessionToken=wGIrqveE6AuGDATZKmR1mtAZ&amp;sessionType=auth&amp;version=1.0&amp;lang=eng";

    let auth_code_payload_parts: [&str; 7] = [
        scheme_name,
        signature_protocol,
        digest,
        relying_party_name_base64,
        brokered_rp_name_base64,
        interactions,
        initial_callback_url,
        unprotected_device_link
    ];

    let auth_code_payload: String = auth_code_payload_parts.join(separator);

    println!("{}", auth_code_payload)
}</code></pre>
</div>
</div>
</div>
<div id="_tabs_4_kotlin--panel" class="tabpanel" aria-labelledby="_tabs_4_kotlin">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">fun main() {
    val separator: String = "|"

    val schemeName: String = "smart-id"
    val signatureProtocol: String = "RAW_DIGEST_SIGNATURE"
    val digest: String = "FNZFFya5wGLv9b27fZngaWrOBqle4tGwxZuDFRBdPl1RQvxJsfoqvTbjafd+8BcehMOQGvak6zlP+F8tga4bfQ=="
    val relyingPartyNameBase64: String = "REVNTw=="
    val brokeredRpNameBase64: String = "RXhhbXBsZSBSUA=="
    val interactions: String = "W3sidHlwZSI6ImNvbmZpcm1hdGlvbk1lc3NhZ2UiLCJkaXNwbGF5VGV4dDIwMCI6IkxvbmdlciBkZXNjcmlwdGlvbiBvZiB0aGUgdHJhbnNhY3Rpb24gY29udGV4dCJ9LHsidHlwZSI6ImRpc3BsYXlUZXh0QW5kUElOIiwiZGlzcGxheVRleHQ2MCI6IlNob3J0IGRlc2NyaXB0aW9uIG9mIHRoZSB0cmFuc2FjdGlvbiBjb250ZXh0In1d"
    val initialCallbackUrl: String = "https://rp.example.com/callback-url?value=RrKjjT4aggzu27YBddX1bQ"
    val unprotectedDeviceLink: String = "https://smart-id.com/device-link?deviceLinkType=Web2App&amp;sessionToken=wGIrqveE6AuGDATZKmR1mtAZ&amp;sessionType=auth&amp;version=1.0&amp;lang=eng"

    val payloadParts: List&lt;String&gt; = listOf(
        schemeName,
        signatureProtocol,
        digest,
        relyingPartyNameBase64,
        brokeredRpNameBase64,
        interactions,
        initialCallbackUrl,
        unprotectedDeviceLink
    )

    val authCodePayload: String = payloadParts.joinToString(separator)

    println(authCodePayload)
}</code></pre>
</div>
</div>
</div>
<div id="_tabs_4_c--panel" class="tabpanel" aria-labelledby="_tabs_4_c">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-cs hljs" data-lang="cs">using System;

public class AuthCodePayload
{
    public static void Main()
    {
        string separator = "|";

        string schemeName = "smart-id";
        string signatureProtocol = "RAW_DIGEST_SIGNATURE";
        string digest = "FNZFFya5wGLv9b27fZngaWrOBqle4tGwxZuDFRBdPl1RQvxJsfoqvTbjafd+8BcehMOQGvak6zlP+F8tga4bfQ==";
        string relyingPartyNameBase64 = "REVNTw==";
        string brokeredRpNameBase64 = "RXhhbXBsZSBSUA==";
        string interactions = "W3sidHlwZSI6ImNvbmZpcm1hdGlvbk1lc3NhZ2UiLCJkaXNwbGF5VGV4dDIwMCI6IkxvbmdlciBkZXNjcmlwdGlvbiBvZiB0aGUgdHJhbnNhY3Rpb24gY29udGV4dCJ9LHsidHlwZSI6ImRpc3BsYXlUZXh0QW5kUElOIiwiZGlzcGxheVRleHQ2MCI6IlNob3J0IGRlc2NyaXB0aW9uIG9mIHRoZSB0cmFuc2FjdGlvbiBjb250ZXh0In1d";
        string initialCallbackUrl = "https://rp.example.com/callback-url?value=RrKjjT4aggzu27YBddX1bQ";
        string unprotectedDeviceLink = "https://smart-id.com/device-link?deviceLinkType=Web2App&amp;sessionToken=wGIrqveE6AuGDATZKmR1mtAZ&amp;sessionType=auth&amp;version=1.0&amp;lang=eng";

        string[] payloadParts = {
            schemeName,
            signatureProtocol,
            digest,
            relyingPartyNameBase64,
            brokeredRpNameBase64,
            interactions,
            initialCallbackUrl,
            unprotectedDeviceLink
        };

        string authCodePayload = string.Join(separator, payloadParts);
        Console.WriteLine(authCodePayload);
    }
}</code></pre>
</div>
</div>
</div>
<div id="_tabs_4_node_js--panel" class="tabpanel" aria-labelledby="_tabs_4_node_js">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-js hljs" data-lang="js">const separator = '|';

const schemeName = 'smart-id';
const signatureProtocol = 'RAW_DIGEST_SIGNATURE';
const digest = 'FNZFFya5wGLv9b27fZngaWrOBqle4tGwxZuDFRBdPl1RQvxJsfoqvTbjafd+8BcehMOQGvak6zlP+F8tga4bfQ==';
const relyingPartyNameBase64 = 'REVNTw==';
const brokeredRpNameBase64 = 'RXhhbXBsZSBSUA==';
const interactions = 'W3sidHlwZSI6ImNvbmZpcm1hdGlvbk1lc3NhZ2UiLCJkaXNwbGF5VGV4dDIwMCI6IkxvbmdlciBkZXNjcmlwdGlvbiBvZiB0aGUgdHJhbnNhY3Rpb24gY29udGV4dCJ9LHsidHlwZSI6ImRpc3BsYXlUZXh0QW5kUElOIiwiZGlzcGxheVRleHQ2MCI6IlNob3J0IGRlc2NyaXB0aW9uIG9mIHRoZSB0cmFuc2FjdGlvbiBjb250ZXh0In1d';
const initialCallbackUrl = 'https://rp.example.com/callback-url?value=RrKjjT4aggzu27YBddX1bQ';
const unprotectedDeviceLink = 'https://smart-id.com/device-link?deviceLinkType=Web2App&amp;sessionToken=wGIrqveE6AuGDATZKmR1mtAZ&amp;sessionType=auth&amp;version=1.0&amp;lang=eng';

const authCodePayload = [
    schemeName,
    signatureProtocol,
    digest,
    relyingPartyNameBase64,
    brokeredRpNameBase64,
    interactions,
    initialCallbackUrl,
    unprotectedDeviceLink
].join(separator);

console.log(authCodePayload);</code></pre>
</div>
</div>
</div>
<div id="_tabs_4_ruby--panel" class="tabpanel" aria-labelledby="_tabs_4_ruby">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby">separator = '|'

scheme_name = 'smart-id'
signature_protocol = 'RAW_DIGEST_SIGNATURE'
digest = 'FNZFFya5wGLv9b27fZngaWrOBqle4tGwxZuDFRBdPl1RQvxJsfoqvTbjafd+8BcehMOQGvak6zlP+F8tga4bfQ=='
relying_party_name_base64 = 'REVNTw=='
brokered_rp_name_base64 = 'RXhhbXBsZSBSUA=='
interactions = 'W3sidHlwZSI6ImNvbmZpcm1hdGlvbk1lc3NhZ2UiLCJkaXNwbGF5VGV4dDIwMCI6IkxvbmdlciBkZXNjcmlwdGlvbiBvZiB0aGUgdHJhbnNhY3Rpb24gY29udGV4dCJ9LHsidHlwZSI6ImRpc3BsYXlUZXh0QW5kUElOIiwiZGlzcGxheVRleHQ2MCI6IlNob3J0IGRlc2NyaXB0aW9uIG9mIHRoZSB0cmFuc2FjdGlvbiBjb250ZXh0In1d'
initial_callback_url = 'https://rp.example.com/callback-url?value=RrKjjT4aggzu27YBddX1bQ'
unprotected_device_link = 'https://smart-id.com/device-link?deviceLinkType=Web2App&amp;sessionToken=wGIrqveE6AuGDATZKmR1mtAZ&amp;sessionType=auth&amp;version=1.0&amp;lang=eng'

auth_code_payload = [
    scheme_name,
    signature_protocol,
    digest,
    relying_party_name_base64,
    brokered_rp_name_base64,
    interactions,
    initial_callback_url,
    unprotected_device_link
].join(separator)

puts auth_code_payload</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="_tabs_2_certificate_choice_session--panel" class="tabpanel" aria-labelledby="_tabs_2_certificate_choice_session">
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>For certificate-choice session device links, <code>digest</code>, <code>interactions</code> and <code>signatureProtocol</code> values are omitted:</p>
</div>
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">authCodePayload := UTF8-ENCODE(STR-CONCAT(
        'smart-id', '|',
        '', '|',
        '', '|',
        BASE64-ENCODE(relyingPartyName), '|',
        BASE64-ENCODE(brokeredRpName), '|',
        '', '|',
        initialCallbackUrl, '|',
        unprotectedDeviceLink))</code></pre>
</div>
</div>
<div id="_tabs_5" class="openblock tabs is-sync is-loading">
<div class="content">
<div class="ulist tablist">
<ul>
<li id="_tabs_5_java" class="tab">
<p>Java</p>
</li>
<li id="_tabs_5_php" class="tab">
<p>PHP</p>
</li>
<li id="_tabs_5_python" class="tab">
<p>Python</p>
</li>
<li id="_tabs_5_go" class="tab">
<p>Go</p>
</li>
<li id="_tabs_5_rust" class="tab">
<p>Rust</p>
</li>
<li id="_tabs_5_kotlin" class="tab">
<p>Kotlin</p>
</li>
<li id="_tabs_5_c" class="tab">
<p>C#</p>
</li>
<li id="_tabs_5_node_js" class="tab">
<p>Node.js</p>
</li>
<li id="_tabs_5_ruby" class="tab">
<p>Ruby</p>
</li>
</ul>
</div>
<div id="_tabs_5_java--panel" class="tabpanel" aria-labelledby="_tabs_5_java">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public class AuthCodePayload {

  public static void main(String[] args) throws Exception {
    String separator = "|";
    String schemeName = "smart-id";
    String signatureProtocol = "";
    String digest = "";
    String relyingPartyNameBase64 = "REVNTw==";
    String brokeredRpNameBase64 = "RXhhbXBsZSBSUA==";
    String interactions = "";
    String initialCallbackUrl = "https://rp.example.com/callback-url?value=RrKjjT4aggzu27YBddX1bQ";
    String unprotectedDeviceLink = "https://smart-id.com/device-link?deviceLinkType=Web2App&amp;sessionToken=wGIrqveE6AuGDATZKmR1mtAZ&amp;sessionType=auth&amp;version=1.0&amp;lang=eng";

    String[] payloadParts = {
      schemeName,
      signatureProtocol,
      digest,
      relyingPartyNameBase64,
      brokeredRpNameBase64,
      interactions,
      initialCallbackUrl,
      unprotectedDeviceLink
    };

    String authCodePayload = String.join(separator, payloadParts);
    System.out.println(authCodePayload);
  }
}</code></pre>
</div>
</div>
</div>
<div id="_tabs_5_php--panel" class="tabpanel" aria-labelledby="_tabs_5_php">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-php hljs" data-lang="php">&lt;?php

$separator = '|';

$schemeName = 'smart-id';
$signatureProtocol = '';
$digest = '';
$relyingPartyNameBase64 = 'REVNTw==';
$brokeredRpNameBase64 = 'RXhhbXBsZSBSUA==';
$interactions = '';
$initialCallbackUrl = 'https://rp.example.com/callback-url?value=RrKjjT4aggzu27YBddX1bQ';
$unprotectedDeviceLink = 'https://smart-id.com/device-link?deviceLinkType=Web2App&amp;sessionToken=wGIrqveE6AuGDATZKmR1mtAZ&amp;sessionType=auth&amp;version=1.0&amp;lang=eng';

$authCodePayload = implode($separator, [
    $schemeName,
    $signatureProtocol,
    $digest,
    $relyingPartyNameBase64,
    $brokeredRpNameBase64,
    $interactions,
    $initialCallbackUrl,
    $unprotectedDeviceLink
]);

echo $authCodePayload;

?&gt;</code></pre>
</div>
</div>
</div>
<div id="_tabs_5_python--panel" class="tabpanel" aria-labelledby="_tabs_5_python">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">separator = '|'

scheme_name = 'smart-id'
signature_protocol = ''
digest = ''
relying_party_name_base64 = 'REVNTw=='
brokered_rp_name_base64 = 'RXhhbXBsZSBSUA=='
interactions = ''
initial_callback_url = 'https://rp.example.com/callback-url?value=RrKjjT4aggzu27YBddX1bQ'
unprotected_device_link = 'https://smart-id.com/device-link?deviceLinkType=Web2App&amp;sessionToken=wGIrqveE6AuGDATZKmR1mtAZ&amp;sessionType=auth&amp;version=1.0&amp;lang=eng'

auth_code_payload = separator.join([
    scheme_name,
    signature_protocol,
    digest,
    relying_party_name_base64,
    brokered_rp_name_base64,
    interactions,
    initial_callback_url,
    unprotected_device_link
])

print(auth_code_payload)</code></pre>
</div>
</div>
</div>
<div id="_tabs_5_go--panel" class="tabpanel" aria-labelledby="_tabs_5_go">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-go hljs" data-lang="go">package main

import (
	"fmt"
)

func main() {
	var separator string = "|"

	var schemeName string = "smart-id"
	var signatureProtocol string = ""
	var digest string = ""
	var relyingPartyNameBase64 string = "REVNTw=="
	var brokeredRpNameBase64 string = "RXhhbXBsZSBSUA=="
	var interactions string = ""
	var initialCallbackUrl string = "https://rp.example.com/callback-url?value=RrKjjT4aggzu27YBddX1bQ"
	var unprotectedDeviceLink string = "https://smart-id.com/device-link?deviceLinkType=Web2App&amp;sessionToken=wGIrqveE6AuGDATZKmR1mtAZ&amp;sessionType=auth&amp;version=1.0&amp;lang=eng"

	var payloadParts = []string{
		schemeName,
		signatureProtocol,
		digest,
		relyingPartyNameBase64,
		brokeredRpNameBase64,
		interactions,
		initialCallbackUrl,
		unprotectedDeviceLink,
	}

	var authCodePayload string = strings.Join(payloadParts, separator)

	fmt.Printf("%q\n", authCodePayload)
}</code></pre>
</div>
</div>
</div>
<div id="_tabs_5_rust--panel" class="tabpanel" aria-labelledby="_tabs_5_rust">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-rust hljs" data-lang="rust">fn main() {
    let separator: &amp;str = "|";
    let scheme_name: &amp;str = "smart-id";
    let signature_protocol: &amp;str = "";
    let digest: &amp;str = "";
    let relying_party_name_base64: &amp;str = "REVNTw==";
    let brokered_rp_name_base64: &amp;str = "RXhhbXBsZSBSUA==";
    let interactions: &amp;str = "";
    let initial_callback_url: &amp;str = "https://rp.example.com/callback-url?value=RrKjjT4aggzu27YBddX1bQ";
    let unprotected_device_link: &amp;str = "https://smart-id.com/device-link?deviceLinkType=Web2App&amp;sessionToken=wGIrqveE6AuGDATZKmR1mtAZ&amp;sessionType=auth&amp;version=1.0&amp;lang=eng";

    let auth_code_payload_parts: [&str; 7] = [
        scheme_name,
        signature_protocol,
        digest,
        relying_party_name_base64,
        brokered_rp_name_base64,
        interactions,
        initial_callback_url,
        unprotected_device_link
    ];

    let auth_code_payload: String = auth_code_payload_parts.join(separator);

    println!("{}", auth_code_payload)
}</code></pre>
</div>
</div>
</div>
<div id="_tabs_5_kotlin--panel" class="tabpanel" aria-labelledby="_tabs_5_kotlin">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">fun main() {
    val separator: String = "|"

    val schemeName: String = "smart-id"
    val signatureProtocol: String = ""
    val digest: String = ""
    val relyingPartyNameBase64: String = "REVNTw=="
    val brokeredRpNameBase64: String = "RXhhbXBsZSBSUA=="
    val interactions: String = ""
    val initialCallbackUrl: String = "https://rp.example.com/callback-url?value=RrKjjT4aggzu27YBddX1bQ"
    val unprotectedDeviceLink: String = "https://smart-id.com/device-link?deviceLinkType=Web2App&amp;sessionToken=wGIrqveE6AuGDATZKmR1mtAZ&amp;sessionType=auth&amp;version=1.0&amp;lang=eng"

    val payloadParts: List&lt;String&gt; = listOf(
        schemeName,
        signatureProtocol,
        digest,
        relyingPartyNameBase64,
        brokeredRpNameBase64,
        interactions,
        initialCallbackUrl,
        unprotectedDeviceLink
    )

    val authCodePayload: String = payloadParts.joinToString(separator)

    println(authCodePayload)
}</code></pre>
</div>
</div>
</div>
<div id="_tabs_5_c--panel" class="tabpanel" aria-labelledby="_tabs_5_c">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-cs hljs" data-lang="cs">using System;

public class AuthCodePayload
{
    public static void Main()
    {
        string separator = "|";

        string schemeName = "smart-id";
        string signatureProtocol = "";
        string digest = "";
        string relyingPartyNameBase64 = "REVNTw==";
        string brokeredRpNameBase64 = "RXhhbXBsZSBSUA==";
        string interactions = "";
        string initialCallbackUrl = "https://rp.example.com/callback-url?value=RrKjjT4aggzu27YBddX1bQ";
        string unprotectedDeviceLink = "https://smart-id.com/device-link?deviceLinkType=Web2App&amp;sessionToken=wGIrqveE6AuGDATZKmR1mtAZ&amp;sessionType=auth&amp;version=1.0&amp;lang=eng";

        string[] payloadParts = {
            schemeName,
            signatureProtocol,
            digest,
            relyingPartyNameBase64,
            brokeredRpNameBase64,
            interactions,
            initialCallbackUrl,
            unprotectedDeviceLink
        };

        string authCodePayload = string.Join(separator, payloadParts);
        Console.WriteLine(authCodePayload);
    }
}</code></pre>
</div>
</div>
</div>
<div id="_tabs_5_node_js--panel" class="tabpanel" aria-labelledby="_tabs_5_node_js">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-js hljs" data-lang="js">const separator = '|';

const schemeName = 'smart-id';
const signatureProtocol = '';
const digest = '';
const relyingPartyNameBase64 = 'REVNTw==';
const brokeredRpNameBase64 = 'RXhhbXBsZSBSUA==';
const interactions = '';
const initialCallbackUrl = 'https://rp.example.com/callback-url?value=RrKjjT4aggzu27YBddX1bQ';
const unprotectedDeviceLink = 'https://smart-id.com/device-link?deviceLinkType=Web2App&amp;sessionToken=wGIrqveE6AuGDATZKmR1mtAZ&amp;sessionType=auth&amp;version=1.0&amp;lang=eng';

const authCodePayload = [
    schemeName,
    signatureProtocol,
    digest,
    relyingPartyNameBase64,
    brokeredRpNameBase64,
    interactions,
    initialCallbackUrl,
    unprotectedDeviceLink
].join(separator);

console.log(authCodePayload);</code></pre>
</div>
</div>
</div>
<div id="_tabs_5_ruby--panel" class="tabpanel" aria-labelledby="_tabs_5_ruby">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby">separator = '|'

scheme_name = 'smart-id'
signature_protocol = ''
digest = ''
relying_party_name_base64 = 'REVNTw=='
brokered_rp_name_base64 = 'RXhhbXBsZSBSUA=='
interactions = ''
initial_callback_url = 'https://rp.example.com/callback-url?value=RrKjjT4aggzu27YBddX1bQ'
unprotected_device_link = 'https://smart-id.com/device-link?deviceLinkType=Web2App&amp;sessionToken=wGIrqveE6AuGDATZKmR1mtAZ&amp;sessionType=auth&amp;version=1.0&amp;lang=eng'

auth_code_payload = [
    scheme_name,
    signature_protocol,
    digest,
    relying_party_name_base64,
    brokered_rp_name_base64,
    interactions,
    initial_callback_url,
    unprotected_device_link
].join(separator)

puts auth_code_payload</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>After the RP assembles the <code>authCodePayload</code>, <code>authCode</code> can be calculated as follows:</p>
</div>
<div id="_tabs_6" class="openblock tabs is-sync is-loading">
<div class="content">
<div class="ulist tablist">
<ul>
<li id="_tabs_6_authentication_session" class="tab">
<p>Authentication Session</p>
</li>
<li id="_tabs_6_signature_session" class="tab">
<p>Signature Session</p>
</li>
<li id="_tabs_6_certificate_choice_session" class="tab">
<p>Certificate-choice Session</p>
</li>
</ul>
</div>
<div id="_tabs_6_authentication_session--panel" class="tabpanel" aria-labelledby="_tabs_6_authentication_session">
<div class="openblock">
<div class="content">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">authCode := BASE64URL-ENCODE(HMAC-SHA256(sessionSecret, authCodePayload))</code></pre>
</div>
</div>
<div id="_tabs_7" class="openblock tabs is-sync is-loading">
<div class="content">
<div class="ulist tablist">
<ul>
<li id="_tabs_7_java" class="tab">
<p>Java</p>
</li>
<li id="_tabs_7_php" class="tab">
<p>PHP</p>
</li>
<li id="_tabs_7_python" class="tab">
<p>Python</p>
</li>
<li id="_tabs_7_go" class="tab">
<p>Go</p>
</li>
<li id="_tabs_7_rust" class="tab">
<p>Rust</p>
</li>
<li id="_tabs_7_kotlin" class="tab">
<p>Kotlin</p>
</li>
<li id="_tabs_7_c" class="tab">
<p>C#</p>
</li>
<li id="_tabs_7_node_js" class="tab">
<p>Node.js</p>
</li>
<li id="_tabs_7_ruby" class="tab">
<p>Ruby</p>
</li>
</ul>
</div>
<div id="_tabs_7_java--panel" class="tabpanel" aria-labelledby="_tabs_7_java">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">import java.nio.charset.StandardCharsets;
import java.util.Base64;

import javax.crypto.Mac;
import javax.crypto.spec.SecretKeySpec;

public class AuthCodeCalculator {

  public static void main(String[] args) throws Exception {
    String sessionSecretBase64 = "B98ODiVCebRedSwdTk51zFSaGYyHtY1H2A0ocAi3/Ps=";

    byte[] sessionSecret = Base64.getDecoder()
      .decode(sessionSecretBase64);

    byte[] authCodePayload = "aegUh6gCKkXBJhhvtJqSTWB5_2W8TDQt5eZ7db6krv0"
      .getBytes(StandardCharsets.UTF_8);

    Mac sha256Hmac = Mac.getInstance("HmacSHA256");
    SecretKeySpec secretKey = new SecretKeySpec(sessionSecret, sha256Hmac.getAlgorithm());
    sha256Hmac.init(secretKey);

    byte[] authCodeBytes = sha256Hmac.doFinal(authCodePayload);

    String authCode = Base64.getUrlEncoder()
      .withoutPadding()
      .encodeToString(authCodeBytes);

    System.out.println(authCode);
  }
}</code></pre>
</div>
</div>
</div>
<div id="_tabs_7_php--panel" class="tabpanel" aria-labelledby="_tabs_7_php">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-php hljs" data-lang="php">&lt;?php

$sessionSecretBase64 = 'B98ODiVCebRedSwdTk51zFSaGYyHtY1H2A0ocAi3/Ps=';
$sessionSecret = base64_decode($sessionSecretBase64);

$authCodePayload = 'aegUh6gCKkXBJhhvtJqSTWB5_2W8TDQt5eZ7db6krv0';

$authCodeBytes = hash_hmac('sha256', $authCodePayload, $sessionSecret, true);

$authCode = rtrim(strtr(base64_encode($authCodeBytes), '+/', '-_'), '=');

echo $authCode;
?&gt;</code></pre>
</div>
</div>
</div>
<div id="_tabs_7_python--panel" class="tabpanel" aria-labelledby="_tabs_7_python">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">import hmac
import hashlib
import base64

session_secret_base64 = b'B98ODiVCebRedSwdTk51zFSaGYyHtY1H2A0ocAi3/Ps='
session_secret = base64.b64decode(session_secret_base64)

auth_code_payload = b'aegUh6gCKkXBJhhvtJqSTWB5_2W8TDQt5eZ7db6krv0'

auth_code_bytes = hmac.new(session_secret, auth_code_payload, hashlib.sha256).digest()

auth_code = base64.urlsafe_b64encode(auth_code_bytes).rstrip(b'=').decode('utf-8')
print(auth_code)</code></pre>
</div>
</div>
</div>
<div id="_tabs_7_go--panel" class="tabpanel" aria-labelledby="_tabs_7_go">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-go hljs" data-lang="go">package main

import (
	"crypto/hmac"
	"crypto/sha256"
	"encoding/base64"
	"fmt"
)

func main() {
	var sessionSecretBase64 = "B98ODiVCebRedSwdTk51zFSaGYyHtY1H2A0ocAi3/Ps="
	var authCodePayload []byte = []byte("aegUh6gCKkXBJhhvtJqSTWB5_2W8TDQt5eZ7db6krv0")

	sessionSecret, err := base64.StdEncoding.DecodeString(sessionSecretBase64)
	if err != nil {
		panic(err)
	}

	mac := hmac.New(sha256.New, sessionSecret)
	mac.Write(authCodePayload)
	var authCodeBytes []byte = mac.Sum(nil)

	var authCode string = base64.RawURLEncoding.EncodeToString(authCodeBytes)
	fmt.Printf("%s\n", authCode)
}</code></pre>
</div>
</div>
</div>
<div id="_tabs_7_rust--panel" class="tabpanel" aria-labelledby="_tabs_7_rust">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-rust hljs" data-lang="rust">use hmac::{Hmac, Mac};
use sha2::Sha256;
use base64::{Engine as _, engine::{self, general_purpose}, alphabet};

fn main() {
    let session_secret_base64 = "B98ODiVCebRedSwdTk51zFSaGYyHtY1H2A0ocAi3/Ps=";
    let session_secret: &amp;[u8] = &amp;base64::engine::general_purpose::STANDARD.decode(session_secret_base64).unwrap();

    let auth_code_payload: &amp;[u8] = &amp;b"aegUh6gCKkXBJhhvtJqSTWB5_2W8TDQt5eZ7db6krv0"[..];

    let mut mac = Hmac::&lt;Sha256&gt;::new_from_slice(session_secret).expect("HMAC can take key of any size");
    mac.update(auth_code_payload);

    let auth_code_bytes = mac.finalize().into_bytes();

    const CUSTOM_ENGINE: engine::GeneralPurpose = base64::engine::GeneralPurpose::new(&amp;alphabet::URL_SAFE, general_purpose::NO_PAD);
    let auth_code: String = CUSTOM_ENGINE.encode(auth_code_bytes);
    println!("{}", auth_code)
}</code></pre>
</div>
</div>
</div>
<div id="_tabs_7_kotlin--panel" class="tabpanel" aria-labelledby="_tabs_7_kotlin">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">import javax.crypto.Mac;
import javax.crypto.spec.SecretKeySpec;
import java.nio.charset.StandardCharsets
import java.util.Base64

fun main() {
  val sessionSecretBase64: String = "B98ODiVCebRedSwdTk51zFSaGYyHtY1H2A0ocAi3/Ps="
  val sessionSecret: ByteArray = Base64.getDecoder()
    .decode(sessionSecretBase64)

  val authCodePayload: ByteArray = "aegUh6gCKkXBJhhvtJqSTWB5_2W8TDQt5eZ7db6krv0"
    .toByteArray(StandardCharsets.UTF_8)

  val hmac: Mac = Mac.getInstance("HmacSHA256")
  val secretKey: SecretKey = SecretKeySpec(sessionSecret, hmac.algorithm)
  hmac.init(secretKey)

  val authCodeBytes: ByteArray = hmac.doFinal(authCodePayload)

  val authCode: String = Base64.getUrlEncoder()
    .withoutPadding()
    .encodeToString(authCodeBytes)

  println(authCode)
}</code></pre>
</div>
</div>
</div>
<div id="_tabs_7_c--panel" class="tabpanel" aria-labelledby="_tabs_7_c">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-cs hljs" data-lang="cs">using System;
using System.Text;
using System.Security.Cryptography;

public class AuthCodeCalculator
{
    public static void Main(string[] args)
    {
        string sessionSecretBase64 = "B98ODiVCebRedSwdTk51zFSaGYyHtY1H2A0ocAi3/Ps=";
        byte[] sessionSecret = Convert.FromBase64String(sessionSecretBase64);
        byte[] authCodePayload = Encoding.UTF8.GetBytes("aegUh6gCKkXBJhhvtJqSTWB5_2W8TDQt5eZ7db6krv0");

        HMACSHA256 hmac = new HMACSHA256(sessionSecret);
        byte[] authCodeBytes = hmac.ComputeHash(authCodePayload);
        string authCode = Convert.ToBase64String(authCodeBytes)
            .Replace('+', '-')
            .Replace('/', '_')
            .TrimEnd('=');

        Console.WriteLine(authCode);
    }
}</code></pre>
</div>
</div>
</div>
<div id="_tabs_7_node_js--panel" class="tabpanel" aria-labelledby="_tabs_7_node_js">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-js hljs" data-lang="js">const crypto = require('crypto');

const sessionSecretBase64 = 'B98ODiVCebRedSwdTk51zFSaGYyHtY1H2A0ocAi3/Ps=';
const sessionSecret = Buffer.from(sessionSecretBase64, 'base64');

const authCodePayload = 'aegUh6gCKkXBJhhvtJqSTWB5_2W8TDQt5eZ7db6krv0';

const hmac = crypto.createHmac('sha256', sessionSecret);
hmac.update(authCodePayload);

const authCode = hmac.digest('base64url')
    .replace(/=+$/, '');

console.log(authCode);</code></pre>
</div>
</div>
</div>
<div id="_tabs_7_ruby--panel" class="tabpanel" aria-labelledby="_tabs_7_ruby">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby">require 'base64'
require 'openssl'

session_secret_base64 = 'B98ODiVCebRedSwdTk51zFSaGYyHtY1H2A0ocAi3/Ps='
session_secret = Base64.decode64(session_secret_base64)

auth_code_payload = 'aegUh6gCKkXBJhhvtJqSTWB5_2W8TDQt5eZ7db6krv0'

hmac = OpenSSL::HMAC.digest(
  'sha256', session_secret, auth_code_payload
)
auth_code = Base64.urlsafe_encode64(hmac).sub(/=*$/, '')

puts auth_code</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="exampleblock">
<div class="title">Example 1. <code>authCode</code> parameter</div>
<div class="content">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">aegUh6gCKkXBJhhvtJqSTWB5_2W8TDQt5eZ7db6krv0</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="_tabs_6_signature_session--panel" class="tabpanel" aria-labelledby="_tabs_6_signature_session">
<div class="openblock">
<div class="content">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">authCode := BASE64URL-ENCODE(HMAC-SHA256(sessionSecret, authCodePayload))</code></pre>
</div>
</div>
<div id="_tabs_8" class="openblock tabs is-sync is-loading">
<div class="content">
<div class="ulist tablist">
<ul>
<li id="_tabs_8_java" class="tab">
<p>Java</p>
</li>
<li id="_tabs_8_php" class="tab">
<p>PHP</p>
</li>
<li id="_tabs_8_python" class="tab">
<p>Python</p>
</li>
<li id="_tabs_8_go" class="tab">
<p>Go</p>
</li>
<li id="_tabs_8_rust" class="tab">
<p>Rust</p>
</li>
<li id="_tabs_8_kotlin" class="tab">
<p>Kotlin</p>
</li>
<li id="_tabs_8_c" class="tab">
<p>C#</p>
</li>
<li id="_tabs_8_node_js" class="tab">
<p>Node.js</p>
</li>
<li id="_tabs_8_ruby" class="tab">
<p>Ruby</p>
</li>
</ul>
</div>
<div id="_tabs_8_java--panel" class="tabpanel" aria-labelledby="_tabs_8_java">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">import java.nio.charset.StandardCharsets;
import java.util.Base64;

import javax.crypto.Mac;
import javax.crypto.spec.SecretKeySpec;

public class AuthCodeCalculator {

  public static void main(String[] args) throws Exception {
    String sessionSecretBase64 = "B98ODiVCebRedSwdTk51zFSaGYyHtY1H2A0ocAi3/Ps=";

    byte[] sessionSecret = Base64.getDecoder()
      .decode(sessionSecretBase64);

    byte[] authCodePayload = "R0iNcUp8nK1nqrcVFWerXUfWMSjwDOMC6MAHKrckaH8"
      .getBytes(StandardCharsets.UTF_8);

    Mac sha256Hmac = Mac.getInstance("HmacSHA256");
    SecretKeySpec secretKey = new SecretKeySpec(sessionSecret, sha256Hmac.getAlgorithm());
    sha256Hmac.init(secretKey);

    byte[] authCodeBytes = sha256Hmac.doFinal(authCodePayload);

    String authCode = Base64.getUrlEncoder()
      .withoutPadding()
      .encodeToString(authCodeBytes);

    System.out.println(authCode);
  }
}</code></pre>
</div>
</div>
</div>
<div id="_tabs_8_php--panel" class="tabpanel" aria-labelledby="_tabs_8_php">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-php hljs" data-lang="php">&lt;?php

$sessionSecretBase64 = 'B98ODiVCebRedSwdTk51zFSaGYyHtY1H2A0ocAi3/Ps=';
$sessionSecret = base64_decode($sessionSecretBase64);

$authCodePayload = 'R0iNcUp8nK1nqrcVFWerXUfWMSjwDOMC6MAHKrckaH8';

$authCodeBytes = hash_hmac('sha256', $authCodePayload, $sessionSecret, true);

$authCode = rtrim(strtr(base64_encode($authCodeBytes), '+/', '-_'), '=');

echo $authCode;
?&gt;</code></pre>
</div>
</div>
</div>
<div id="_tabs_8_python--panel" class="tabpanel" aria-labelledby="_tabs_8_python">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">import hmac
import hashlib
import base64

session_secret_base64 = b'B98ODiVCebRedSwdTk51zFSaGYyHtY1H2A0ocAi3/Ps='
session_secret = base64.b64decode(session_secret_base64)

auth_code_payload = b'R0iNcUp8nK1nqrcVFWerXUfWMSjwDOMC6MAHKrckaH8'

auth_code_bytes = hmac.new(session_secret, auth_code_payload, hashlib.sha256).digest()

auth_code = base64.urlsafe_b64encode(auth_code_bytes).rstrip(b'=').decode('utf-8')
print(auth_code)</code></pre>
</div>
</div>
</div>
<div id="_tabs_8_go--panel" class="tabpanel" aria-labelledby="_tabs_8_go">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-go hljs" data-lang="go">package main

import (
	"crypto/hmac"
	"crypto/sha256"
	"encoding/base64"
	"fmt"
)

func main() {
	var sessionSecretBase64 = "B98ODiVCebRedSwdTk51zFSaGYyHtY1H2A0ocAi3/Ps="
	var authCodePayload []byte = []byte("R0iNcUp8nK1nqrcVFWerXUfWMSjwDOMC6MAHKrckaH8")

	sessionSecret, err := base64.StdEncoding.DecodeString(sessionSecretBase64)
	if err != nil {
		panic(err)
	}

	mac := hmac.New(sha256.New, sessionSecret)
	mac.Write(authCodePayload)
	var authCodeBytes []byte = mac.Sum(nil)

	var authCode string = base64.RawURLEncoding.EncodeToString(authCodeBytes)
	fmt.Printf("%s\n", authCode)
}</code></pre>
</div>
</div>
</div>
<div id="_tabs_8_rust--panel" class="tabpanel" aria-labelledby="_tabs_8_rust">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-rust hljs" data-lang="rust">use hmac::{Hmac, Mac};
use sha2::Sha256;
use base64::{Engine as _, engine::{self, general_purpose}, alphabet};

fn main() {
    let session_secret_base64 = "B98ODiVCebRedSwdTk51zFSaGYyHtY1H2A0ocAi3/Ps=";
    let session_secret: &amp;[u8] = &amp;base64::engine::general_purpose::STANDARD.decode(session_secret_base64).unwrap();

    let auth_code_payload: &amp;[u8] = &amp;b"R0iNcUp8nK1nqrcVFWerXUfWMSjwDOMC6MAHKrckaH8"[..];

    let mut mac = Hmac::&lt;Sha256&gt;::new_from_slice(session_secret).expect("HMAC can take key of any size");
    mac.update(auth_code_payload);

    let auth_code_bytes = mac.finalize().into_bytes();

    const CUSTOM_ENGINE: engine::GeneralPurpose = base64::engine::GeneralPurpose::new(&amp;alphabet::URL_SAFE, general_purpose::NO_PAD);
    let auth_code: String = CUSTOM_ENGINE.encode(auth_code_bytes);
    println!("{}", auth_code)
}</code></pre>
</div>
</div>
</div>
<div id="_tabs_8_kotlin--panel" class="tabpanel" aria-labelledby="_tabs_8_kotlin">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">import javax.crypto.Mac;
import javax.crypto.spec.SecretKeySpec;
import java.nio.charset.StandardCharsets
import java.util.Base64

fun main() {
  val sessionSecretBase64: String = "B98ODiVCebRedSwdTk51zFSaGYyHtY1H2A0ocAi3/Ps="
  val sessionSecret: ByteArray = Base64.getDecoder()
    .decode(sessionSecretBase64)

  val authCodePayload: ByteArray = "R0iNcUp8nK1nqrcVFWerXUfWMSjwDOMC6MAHKrckaH8"
    .toByteArray(StandardCharsets.UTF_8)

  val hmac: Mac = Mac.getInstance("HmacSHA256")
  val secretKey: SecretKey = SecretKeySpec(sessionSecret, hmac.algorithm)
  hmac.init(secretKey)

  val authCodeBytes: ByteArray = hmac.doFinal(authCodePayload)

  val authCode: String = Base64.getUrlEncoder()
    .withoutPadding()
    .encodeToString(authCodeBytes)

  println(authCode)
}</code></pre>
</div>
</div>
</div>
<div id="_tabs_8_c--panel" class="tabpanel" aria-labelledby="_tabs_8_c">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-cs hljs" data-lang="cs">using System;
using System.Text;
using System.Security.Cryptography;

public class AuthCodeCalculator
{
    public static void Main(string[] args)
    {
        string sessionSecretBase64 = "B98ODiVCebRedSwdTk51zFSaGYyHtY1H2A0ocAi3/Ps=";
        byte[] sessionSecret = Convert.FromBase64String(sessionSecretBase64);
        byte[] authCodePayload = Encoding.UTF8.GetBytes("R0iNcUp8nK1nqrcVFWerXUfWMSjwDOMC6MAHKrckaH8");

        HMACSHA256 hmac = new HMACSHA256(sessionSecret);
        byte[] authCodeBytes = hmac.ComputeHash(authCodePayload);
        string authCode = Convert.ToBase64String(authCodeBytes)
            .Replace('+', '-')
            .Replace('/', '_')
            .TrimEnd('=');

        Console.WriteLine(authCode);
    }
}</code></pre>
</div>
</div>
</div>
<div id="_tabs_8_node_js--panel" class="tabpanel" aria-labelledby="_tabs_8_node_js">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-js hljs" data-lang="js">const crypto = require('crypto');

const sessionSecretBase64 = 'B98ODiVCebRedSwdTk51zFSaGYyHtY1H2A0ocAi3/Ps=';
const sessionSecret = Buffer.from(sessionSecretBase64, 'base64');

const authCodePayload = 'R0iNcUp8nK1nqrcVFWerXUfWMSjwDOMC6MAHKrckaH8';

const hmac = crypto.createHmac('sha256', sessionSecret);
hmac.update(authCodePayload);

const authCode = hmac.digest('base64url')
    .replace(/=+$/, '');

console.log(authCode);</code></pre>
</div>
</div>
</div>
<div id="_tabs_8_ruby--panel" class="tabpanel" aria-labelledby="_tabs_8_ruby">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby">require 'base64'
require 'openssl'

session_secret_base64 = 'B98ODiVCebRedSwdTk51zFSaGYyHtY1H2A0ocAi3/Ps='
session_secret = Base64.decode64(session_secret_base64)

auth_code_payload = 'R0iNcUp8nK1nqrcVFWerXUfWMSjwDOMC6MAHKrckaH8'

hmac = OpenSSL::HMAC.digest(
  'sha256', session_secret, auth_code_payload
)
auth_code = Base64.urlsafe_encode64(hmac).sub(/=*$/, '')

puts auth_code</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="exampleblock">
<div class="title">Example 2. <code>authCode</code> parameter</div>
<div class="content">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">R0iNcUp8nK1nqrcVFWerXUfWMSjwDOMC6MAHKrckaH8</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="_tabs_6_certificate_choice_session--panel" class="tabpanel" aria-labelledby="_tabs_6_certificate_choice_session">
<div class="openblock">
<div class="content">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">authCode := BASE64URL-ENCODE(HMAC-SHA256(sessionSecret, authCodePayload))</code></pre>
</div>
</div>
<div id="_tabs_9" class="openblock tabs is-sync is-loading">
<div class="content">
<div class="ulist tablist">
<ul>
<li id="_tabs_9_java" class="tab">
<p>Java</p>
</li>
<li id="_tabs_9_php" class="tab">
<p>PHP</p>
</li>
<li id="_tabs_9_python" class="tab">
<p>Python</p>
</li>
<li id="_tabs_9_go" class="tab">
<p>Go</p>
</li>
<li id="_tabs_9_rust" class="tab">
<p>Rust</p>
</li>
<li id="_tabs_9_kotlin" class="tab">
<p>Kotlin</p>
</li>
<li id="_tabs_9_c" class="tab">
<p>C#</p>
</li>
<li id="_tabs_9_node_js" class="tab">
<p>Node.js</p>
</li>
<li id="_tabs_9_ruby" class="tab">
<p>Ruby</p>
</li>
</ul>
</div>
<div id="_tabs_9_java--panel" class="tabpanel" aria-labelledby="_tabs_9_java">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">import java.nio.charset.StandardCharsets;
import java.util.Base64;

import javax.crypto.Mac;
import javax.crypto.spec.SecretKeySpec;

public class AuthCodeCalculator {

  public static void main(String[] args) throws Exception {
    String sessionSecretBase64 = "B98ODiVCebRedSwdTk51zFSaGYyHtY1H2A0ocAi3/Ps=";

    byte[] sessionSecret = Base64.getDecoder()
      .decode(sessionSecretBase64);

    byte[] authCodePayload = "PI1qYa9_l6zR-v6Pkre6ycSm7S3BGiOQSe5OQlw4UJg"
      .getBytes(StandardCharsets.UTF_8);

    Mac sha256Hmac = Mac.getInstance("HmacSHA256");
    SecretKeySpec secretKey = new SecretKeySpec(sessionSecret, sha256Hmac.getAlgorithm());
    sha256Hmac.init(secretKey);

    byte[] authCodeBytes = sha256Hmac.doFinal(authCodePayload);

    String authCode = Base64.getUrlEncoder()
      .withoutPadding()
      .encodeToString(authCodeBytes);

    System.out.println(authCode);
  }
}</code></pre>
</div>
</div>
</div>
<div id="_tabs_9_php--panel" class="tabpanel" aria-labelledby="_tabs_9_php">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-php hljs" data-lang="php">&lt;?php

$sessionSecretBase64 = 'B98ODiVCebRedSwdTk51zFSaGYyHtY1H2A0ocAi3/Ps=';
$sessionSecret = base64_decode($sessionSecretBase64);

$authCodePayload = 'PI1qYa9_l6zR-v6Pkre6ycSm7S3BGiOQSe5OQlw4UJg';

$authCodeBytes = hash_hmac('sha256', $authCodePayload, $sessionSecret, true);

$authCode = rtrim(strtr(base64_encode($authCodeBytes), '+/', '-_'), '=');

echo $authCode;
?&gt;</code></pre>
</div>
</div>
</div>
<div id="_tabs_9_python--panel" class="tabpanel" aria-labelledby="_tabs_9_python">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">import hmac
import hashlib
import base64

session_secret_base64 = b'B98ODiVCebRedSwdTk51zFSaGYyHtY1H2A0ocAi3/Ps='
session_secret = base64.b64decode(session_secret_base64)

auth_code_payload = b'PI1qYa9_l6zR-v6Pkre6ycSm7S3BGiOQSe5OQlw4UJg'

auth_code_bytes = hmac.new(session_secret, auth_code_payload, hashlib.sha256).digest()

auth_code = base64.urlsafe_b64encode(auth_code_bytes).rstrip(b'=').decode('utf-8')
print(auth_code)</code></pre>
</div>
</div>
</div>
<div id="_tabs_9_go--panel" class="tabpanel" aria-labelledby="_tabs_9_go">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-go hljs" data-lang="go">package main

import (
	"crypto/hmac"
	"crypto/sha256"
	"encoding/base64"
	"fmt"
)

func main() {
	var sessionSecretBase64 = "B98ODiVCebRedSwdTk51zFSaGYyHtY1H2A0ocAi3/Ps="
	var authCodePayload []byte = []byte("PI1qYa9_l6zR-v6Pkre6ycSm7S3BGiOQSe5OQlw4UJg")

	sessionSecret, err := base64.StdEncoding.DecodeString(sessionSecretBase64)
	if err != nil {
		panic(err)
	}

	mac := hmac.New(sha256.New, sessionSecret)
	mac.Write(authCodePayload)
	var authCodeBytes []byte = mac.Sum(nil)

	var authCode string = base64.RawURLEncoding.EncodeToString(authCodeBytes)
	fmt.Printf("%s\n", authCode)
}</code></pre>
</div>
</div>
</div>
<div id="_tabs_9_rust--panel" class="tabpanel" aria-labelledby="_tabs_9_rust">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-rust hljs" data-lang="rust">use hmac::{Hmac, Mac};
use sha2::Sha256;
use base64::{Engine as _, engine::{self, general_purpose}, alphabet};

fn main() {
    let session_secret_base64 = "B98ODiVCebRedSwdTk51zFSaGYyHtY1H2A0ocAi3/Ps=";
    let session_secret: &amp;[u8] = &amp;base64::engine::general_purpose::STANDARD.decode(session_secret_base64).unwrap();

    let auth_code_payload: &amp;[u8] = &amp;b"PI1qYa9_l6zR-v6Pkre6ycSm7S3BGiOQSe5OQlw4UJg"[..];

    let mut mac = Hmac::&lt;Sha256&gt;::new_from_slice(session_secret).expect("HMAC can take key of any size");
    mac.update(auth_code_payload);

    let auth_code_bytes = mac.finalize().into_bytes();

    const CUSTOM_ENGINE: engine::GeneralPurpose = base64::engine::GeneralPurpose::new(&amp;alphabet::URL_SAFE, general_purpose::NO_PAD);
    let auth_code: String = CUSTOM_ENGINE.encode(auth_code_bytes);
    println!("{}", auth_code)
}</code></pre>
</div>
</div>
</div>
<div id="_tabs_9_kotlin--panel" class="tabpanel" aria-labelledby="_tabs_9_kotlin">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">import javax.crypto.Mac;
import javax.crypto.spec.SecretKeySpec;
import java.nio.charset.StandardCharsets
import java.util.Base64

fun main() {
  val sessionSecretBase64: String = "B98ODiVCebRedSwdTk51zFSaGYyHtY1H2A0ocAi3/Ps="
  val sessionSecret: ByteArray = Base64.getDecoder()
    .decode(sessionSecretBase64)

  val authCodePayload: ByteArray = "PI1qYa9_l6zR-v6Pkre6ycSm7S3BGiOQSe5OQlw4UJg"
    .toByteArray(StandardCharsets.UTF_8)

  val hmac: Mac = Mac.getInstance("HmacSHA256")
  val secretKey: SecretKey = SecretKeySpec(sessionSecret, hmac.algorithm)
  hmac.init(secretKey)

  val authCodeBytes: ByteArray = hmac.doFinal(authCodePayload)

  val authCode: String = Base64.getUrlEncoder()
    .withoutPadding()
    .encodeToString(authCodeBytes)

  println(authCode)
}</code></pre>
</div>
</div>
</div>
<div id="_tabs_9_c--panel" class="tabpanel" aria-labelledby="_tabs_9_c">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-cs hljs" data-lang="cs">using System;
using System.Text;
using System.Security.Cryptography;

public class AuthCodeCalculator
{
    public static void Main(string[] args)
    {
        string sessionSecretBase64 = "B98ODiVCebRedSwdTk51zFSaGYyHtY1H2A0ocAi3/Ps=";
        byte[] sessionSecret = Convert.FromBase64String(sessionSecretBase64);
        byte[] authCodePayload = Encoding.UTF8.GetBytes("PI1qYa9_l6zR-v6Pkre6ycSm7S3BGiOQSe5OQlw4UJg");

        HMACSHA256 hmac = new HMACSHA256(sessionSecret);
        byte[] authCodeBytes = hmac.ComputeHash(authCodePayload);
        string authCode = Convert.ToBase64String(authCodeBytes)
            .Replace('+', '-')
            .Replace('/', '_')
            .TrimEnd('=');

        Console.WriteLine(authCode);
    }
}</code></pre>
</div>
</div>
</div>
<div id="_tabs_9_node_js--panel" class="tabpanel" aria-labelledby="_tabs_9_node_js">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-js hljs" data-lang="js">const crypto = require('crypto');

const sessionSecretBase64 = 'B98ODiVCebRedSwdTk51zFSaGYyHtY1H2A0ocAi3/Ps=';
const sessionSecret = Buffer.from(sessionSecretBase64, 'base64');

const authCodePayload = 'PI1qYa9_l6zR-v6Pkre6ycSm7S3BGiOQSe5OQlw4UJg';

const hmac = crypto.createHmac('sha256', sessionSecret);
hmac.update(authCodePayload);

const authCode = hmac.digest('base64url')
    .replace(/=+$/, '');

console.log(authCode);</code></pre>
</div>
</div>
</div>
<div id="_tabs_9_ruby--panel" class="tabpanel" aria-labelledby="_tabs_9_ruby">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby">require 'base64'
require 'openssl'

session_secret_base64 = 'B98ODiVCebRedSwdTk51zFSaGYyHtY1H2A0ocAi3/Ps='
session_secret = Base64.decode64(session_secret_base64)

auth_code_payload = 'PI1qYa9_l6zR-v6Pkre6ycSm7S3BGiOQSe5OQlw4UJg'

hmac = OpenSSL::HMAC.digest(
  'sha256', session_secret, auth_code_payload
)
auth_code = Base64.urlsafe_encode64(hmac).sub(/=*$/, '')

puts auth_code</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="exampleblock">
<div class="title">Example 3. <code>authCode</code> parameter</div>
<div class="content">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">PI1qYa9_l6zR-v6Pkre6ycSm7S3BGiOQSe5OQlw4UJg</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="_tabs_1_app2app--panel" class="tabpanel" aria-labelledby="_tabs_1_app2app">
<div class="openblock">
<div class="content">
<div id="_tabs_10" class="openblock tabs is-sync is-loading">
<div class="content">
<div class="ulist tablist">
<ul>
<li id="_tabs_10_authentication_session" class="tab">
<p>Authentication Session</p>
</li>
<li id="_tabs_10_signature_session" class="tab">
<p>Signature Session</p>
</li>
<li id="_tabs_10_certificate_choice_session" class="tab">
<p>Certificate-choice Session</p>
</li>
</ul>
</div>
<div id="_tabs_10_authentication_session--panel" class="tabpanel" aria-labelledby="_tabs_10_authentication_session">
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>For authentication session device links <code>signatureProtocol</code> value is <code>ACSP_V2</code>:</p>
</div>
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">authCodePayload := UTF8-ENCODE(STR-CONCAT(
        'smart-id', '|',
        'ACSP_V2', '|',
        rpChallenge, '|',
        BASE64-ENCODE(relyingPartyName), '|',
        BASE64-ENCODE(brokeredRpName), '|',
        interactions, '|',
        initialCallbackUrl, '|',
        unprotectedDeviceLink))</code></pre>
</div>
</div>
<div id="_tabs_11" class="openblock tabs is-sync is-loading">
<div class="content">
<div class="ulist tablist">
<ul>
<li id="_tabs_11_java" class="tab">
<p>Java</p>
</li>
<li id="_tabs_11_php" class="tab">
<p>PHP</p>
</li>
<li id="_tabs_11_python" class="tab">
<p>Python</p>
</li>
<li id="_tabs_11_go" class="tab">
<p>Go</p>
</li>
<li id="_tabs_11_rust" class="tab">
<p>Rust</p>
</li>
<li id="_tabs_11_kotlin" class="tab">
<p>Kotlin</p>
</li>
<li id="_tabs_11_c" class="tab">
<p>C#</p>
</li>
<li id="_tabs_11_node_js" class="tab">
<p>Node.js</p>
</li>
<li id="_tabs_11_ruby" class="tab">
<p>Ruby</p>
</li>
</ul>
</div>
<div id="_tabs_11_java--panel" class="tabpanel" aria-labelledby="_tabs_11_java">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public class AuthCodePayload {

  public static void main(String[] args) throws Exception {
    String separator = "|";
    String schemeName = "smart-id";
    String signatureProtocol = "ACSP_V2";
    String rpChallenge = "GYS+yoah6emAcVDNIajwSs6UB/M95XrDxMzXBUkwQJ9YFDipXXzGpPc7raWcuc2+TEoRc7WvIZ/7dU/iRXenYg==";
    String relyingPartyNameBase64 = "REVNTw==";
    String brokeredRpNameBase64 = "RXhhbXBsZSBSUA==";
    String interactions = "W3sidHlwZSI6ImNvbmZpcm1hdGlvbk1lc3NhZ2UiLCJkaXNwbGF5VGV4dDIwMCI6IkxvbmdlciBkZXNjcmlwdGlvbiBvZiB0aGUgdHJhbnNhY3Rpb24gY29udGV4dCJ9LHsidHlwZSI6ImRpc3BsYXlUZXh0QW5kUElOIiwiZGlzcGxheVRleHQ2MCI6IlNob3J0IGRlc2NyaXB0aW9uIG9mIHRoZSB0cmFuc2FjdGlvbiBjb250ZXh0In1d";
    String initialCallbackUrl = "https://rp.example.com/callback-url?value=RrKjjT4aggzu27YBddX1bQ";
    String unprotectedDeviceLink = "https://smart-id.com/device-link?deviceLinkType=App2App&amp;sessionToken=wGIrqveE6AuGDATZKmR1mtAZ&amp;sessionType=auth&amp;version=1.0&amp;lang=eng";

    String[] payloadParts = {
      schemeName,
      signatureProtocol,
      rpChallenge,
      relyingPartyNameBase64,
      brokeredRpNameBase64,
      interactions,
      initialCallbackUrl,
      unprotectedDeviceLink
    };

    String authCodePayload = String.join(separator, payloadParts);
    System.out.println(authCodePayload);
  }
}</code></pre>
</div>
</div>
</div>
<div id="_tabs_11_php--panel" class="tabpanel" aria-labelledby="_tabs_11_php">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-php hljs" data-lang="php">&lt;?php

$separator = '|';

$schemeName = 'smart-id';
$signatureProtocol = 'ACSP_V2';
$rpChallenge = 'GYS+yoah6emAcVDNIajwSs6UB/M95XrDxMzXBUkwQJ9YFDipXXzGpPc7raWcuc2+TEoRc7WvIZ/7dU/iRXenYg==';
$relyingPartyNameBase64 = 'REVNTw==';
$brokeredRpNameBase64 = 'RXhhbXBsZSBSUA==';
$interactions = 'W3sidHlwZSI6ImNvbmZpcm1hdGlvbk1lc3NhZ2UiLCJkaXNwbGF5VGV4dDIwMCI6IkxvbmdlciBkZXNjcmlwdGlvbiBvZiB0aGUgdHJhbnNhY3Rpb24gY29udGV4dCJ9LHsidHlwZSI6ImRpc3BsYXlUZXh0QW5kUElOIiwiZGlzcGxheVRleHQ2MCI6IlNob3J0IGRlc2NyaXB0aW9uIG9mIHRoZSB0cmFuc2FjdGlvbiBjb250ZXh0In1d';
$initialCallbackUrl = 'https://rp.example.com/callback-url?value=RrKjjT4aggzu27YBddX1bQ';
$unprotectedDeviceLink = 'https://smart-id.com/device-link?deviceLinkType=App2App&amp;sessionToken=wGIrqveE6AuGDATZKmR1mtAZ&amp;sessionType=auth&amp;version=1.0&amp;lang=eng';

$authCodePayload = implode($separator, [
    $schemeName,
    $signatureProtocol,
    $rpChallenge,
    $relyingPartyNameBase64,
    $brokeredRpNameBase64,
    $interactions,
    $initialCallbackUrl,
    $unprotectedDeviceLink
]);

echo $authCodePayload;

?&gt;</code></pre>
</div>
</div>
</div>
<div id="_tabs_11_python--panel" class="tabpanel" aria-labelledby="_tabs_11_python">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">separator = '|'

scheme_name = 'smart-id'
signature_protocol = 'ACSP_V2'
rp_challenge = 'GYS+yoah6emAcVDNIajwSs6UB/M95XrDxMzXBUkwQJ9YFDipXXzGpPc7raWcuc2+TEoRc7WvIZ/7dU/iRXenYg=='
relying_party_name_base64 = 'REVNTw=='
brokered_rp_name_base64 = 'RXhhbXBsZSBSUA=='
interactions = 'W3sidHlwZSI6ImNvbmZpcm1hdGlvbk1lc3NhZ2UiLCJkaXNwbGF5VGV4dDIwMCI6IkxvbmdlciBkZXNjcmlwdGlvbiBvZiB0aGUgdHJhbnNhY3Rpb24gY29udGV4dCJ9LHsidHlwZSI6ImRpc3BsYXlUZXh0QW5kUElOIiwiZGlzcGxheVRleHQ2MCI6IlNob3J0IGRlc2NyaXB0aW9uIG9mIHRoZSB0cmFuc2FjdGlvbiBjb250ZXh0In1d'
initial_callback_url = 'https://rp.example.com/callback-url?value=RrKjjT4aggzu27YBddX1bQ'
unprotected_device_link = 'https://smart-id.com/device-link?deviceLinkType=App2App&amp;sessionToken=wGIrqveE6AuGDATZKmR1mtAZ&amp;sessionType=auth&amp;version=1.0&amp;lang=eng'

auth_code_payload = separator.join([
    scheme_name,
    signature_protocol,
    rp_challenge,
    relying_party_name_base64,
    brokered_rp_name_base64,
    interactions,
    initial_callback_url,
    unprotected_device_link
])

print(auth_code_payload)</code></pre>
</div>
</div>
</div>
<div id="_tabs_11_go--panel" class="tabpanel" aria-labelledby="_tabs_11_go">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-go hljs" data-lang="go">package main

import (
	"fmt"
)

func main() {
	var separator string = "|"

	var schemeName string = "smart-id"
	var signatureProtocol string = "ACSP_V2"
	var rpChallenge string = "GYS+yoah6emAcVDNIajwSs6UB/M95XrDxMzXBUkwQJ9YFDipXXzGpPc7raWcuc2+TEoRc7WvIZ/7dU/iRXenYg=="
	var relyingPartyNameBase64 string = "REVNTw=="
	var brokeredRpNameBase64 string = "RXhhbXBsZSBSUA=="
	var interactions string = "W3sidHlwZSI6ImNvbmZpcm1hdGlvbk1lc3NhZ2UiLCJkaXNwbGF5VGV4dDIwMCI6IkxvbmdlciBkZXNjcmlwdGlvbiBvZiB0aGUgdHJhbnNhY3Rpb24gY29udGV4dCJ9LHsidHlwZSI6ImRpc3BsYXlUZXh0QW5kUElOIiwiZGlzcGxheVRleHQ2MCI6IlNob3J0IGRlc2NyaXB0aW9uIG9mIHRoZSB0cmFuc2FjdGlvbiBjb250ZXh0In1d"
	var initialCallbackUrl string = "https://rp.example.com/callback-url?value=RrKjjT4aggzu27YBddX1bQ"
	var unprotectedDeviceLink string = "https://smart-id.com/device-link?deviceLinkType=App2App&amp;sessionToken=wGIrqveE6AuGDATZKmR1mtAZ&amp;sessionType=auth&amp;version=1.0&amp;lang=eng"

	var payloadParts = []string{
		schemeName,
		signatureProtocol,
		rpChallenge,
		relyingPartyNameBase64,
		brokeredRpNameBase64,
		interactions,
		initialCallbackUrl,
		unprotectedDeviceLink,
	}

	var authCodePayload string = strings.Join(payloadParts, separator)

	fmt.Printf("%q\n", authCodePayload)
}</code></pre>
</div>
</div>
</div>
<div id="_tabs_11_rust--panel" class="tabpanel" aria-labelledby="_tabs_11_rust">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-rust hljs" data-lang="rust">fn main() {
    let separator: &amp;str = "|";
    let scheme_name: &amp;str = "smart-id";
    let signature_protocol: &amp;str = "ACSP_V2";
    let rp_challenge: &amp;str = "GYS+yoah6emAcVDNIajwSs6UB/M95XrDxMzXBUkwQJ9YFDipXXzGpPc7raWcuc2+TEoRc7WvIZ/7dU/iRXenYg==";
    let relying_party_name_base64: &amp;str = "REVNTw==";
    let brokered_rp_name_base64: &amp;str = "RXhhbXBsZSBSUA==";
    let interactions: &amp;str = "W3sidHlwZSI6ImNvbmZpcm1hdGlvbk1lc3NhZ2UiLCJkaXNwbGF5VGV4dDIwMCI6IkxvbmdlciBkZXNjcmlwdGlvbiBvZiB0aGUgdHJhbnNhY3Rpb24gY29udGV4dCJ9LHsidHlwZSI6ImRpc3BsYXlUZXh0QW5kUElOIiwiZGlzcGxheVRleHQ2MCI6IlNob3J0IGRlc2NyaXB0aW9uIG9mIHRoZSB0cmFuc2FjdGlvbiBjb250ZXh0In1d";
    let initial_callback_url: &amp;str = "https://rp.example.com/callback-url?value=RrKjjT4aggzu27YBddX1bQ";
    let unprotected_device_link: &amp;str = "https://smart-id.com/device-link?deviceLinkType=App2App&amp;sessionToken=wGIrqveE6AuGDATZKmR1mtAZ&amp;sessionType=auth&amp;version=1.0&amp;lang=eng";

    let auth_code_payload_parts: [&str; 7] = [
        scheme_name,
        signature_protocol,
        rp_challenge,
        relying_party_name_base64,
        brokered_rp_name_base64,
        interactions,
        initial_callback_url,
        unprotected_device_link
    ];

    let auth_code_payload: String = auth_code_payload_parts.join(separator);

    println!("{}", auth_code_payload)
}</code></pre>
</div>
</div>
</div>
<div id="_tabs_11_kotlin--panel" class="tabpanel" aria-labelledby="_tabs_11_kotlin">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">fun main() {
    val separator: String = "|"

    val schemeName: String = "smart-id"
    val signatureProtocol: String = "ACSP_V2"
    val rpChallenge: String = "GYS+yoah6emAcVDNIajwSs6UB/M95XrDxMzXBUkwQJ9YFDipXXzGpPc7raWcuc2+TEoRc7WvIZ/7dU/iRXenYg=="
    val relyingPartyNameBase64: String = "REVNTw=="
    val brokeredRpNameBase64: String = "RXhhbXBsZSBSUA=="
    val interactions: String = "W3sidHlwZSI6ImNvbmZpcm1hdGlvbk1lc3NhZ2UiLCJkaXNwbGF5VGV4dDIwMCI6IkxvbmdlciBkZXNjcmlwdGlvbiBvZiB0aGUgdHJhbnNhY3Rpb24gY29udGV4dCJ9LHsidHlwZSI6ImRpc3BsYXlUZXh0QW5kUElOIiwiZGlzcGxheVRleHQ2MCI6IlNob3J0IGRlc2NyaXB0aW9uIG9mIHRoZSB0cmFuc2FjdGlvbiBjb250ZXh0In1d"
    val initialCallbackUrl: String = "https://rp.example.com/callback-url?value=RrKjjT4aggzu27YBddX1bQ"
    val unprotectedDeviceLink: String = "https://smart-id.com/device-link?deviceLinkType=App2App&amp;sessionToken=wGIrqveE6AuGDATZKmR1mtAZ&amp;sessionType=auth&amp;version=1.0&amp;lang=eng"

    val payloadParts: List&lt;String&gt; = listOf(
        schemeName,
        signatureProtocol,
        rpChallenge,
        relyingPartyNameBase64,
        brokeredRpNameBase64,
        interactions,
        initialCallbackUrl,
        unprotectedDeviceLink
    )

    val authCodePayload: String = payloadParts.joinToString(separator)

    println(authCodePayload)
}</code></pre>
</div>
</div>
</div>
<div id="_tabs_11_c--panel" class="tabpanel" aria-labelledby="_tabs_11_c">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-cs hljs" data-lang="cs">using System;

public class AuthCodePayload
{
    public static void Main()
    {
        string separator = "|";

        string schemeName = "smart-id";
        string signatureProtocol = "ACSP_V2";
        string rpChallenge = "GYS+yoah6emAcVDNIajwSs6UB/M95XrDxMzXBUkwQJ9YFDipXXzGpPc7raWcuc2+TEoRc7WvIZ/7dU/iRXenYg==";
        string relyingPartyNameBase64 = "REVNTw==";
        string brokeredRpNameBase64 = "RXhhbXBsZSBSUA==";
        string interactions = "W3sidHlwZSI6ImNvbmZpcm1hdGlvbk1lc3NhZ2UiLCJkaXNwbGF5VGV4dDIwMCI6IkxvbmdlciBkZXNjcmlwdGlvbiBvZiB0aGUgdHJhbnNhY3Rpb24gY29udGV4dCJ9LHsidHlwZSI6ImRpc3BsYXlUZXh0QW5kUElOIiwiZGlzcGxheVRleHQ2MCI6IlNob3J0IGRlc2NyaXB0aW9uIG9mIHRoZSB0cmFuc2FjdGlvbiBjb250ZXh0In1d";
        string initialCallbackUrl = "https://rp.example.com/callback-url?value=RrKjjT4aggzu27YBddX1bQ";
        string unprotectedDeviceLink = "https://smart-id.com/device-link?deviceLinkType=App2App&amp;sessionToken=wGIrqveE6AuGDATZKmR1mtAZ&amp;sessionType=auth&amp;version=1.0&amp;lang=eng";

        string[] payloadParts = {
            schemeName,
            signatureProtocol,
            rpChallenge,
            relyingPartyNameBase64,
            brokeredRpNameBase64,
            interactions,
            initialCallbackUrl,
            unprotectedDeviceLink
        };

        string authCodePayload = string.Join(separator, payloadParts);
        Console.WriteLine(authCodePayload);
    }
}</code></pre>
</div>
</div>
</div>
<div id="_tabs_11_node_js--panel" class="tabpanel" aria-labelledby="_tabs_11_node_js">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-js hljs" data-lang="js">const separator = '|';

const schemeName = 'smart-id';
const signatureProtocol = 'ACSP_V2';
const rpChallenge = 'GYS+yoah6emAcVDNIajwSs6UB/M95XrDxMzXBUkwQJ9YFDipXXzGpPc7raWcuc2+TEoRc7WvIZ/7dU/iRXenYg==';
const relyingPartyNameBase64 = 'REVNTw==';
const brokeredRpNameBase64 = 'RXhhbXBsZSBSUA==';
const interactions = 'W3sidHlwZSI6ImNvbmZpcm1hdGlvbk1lc3NhZ2UiLCJkaXNwbGF5VGV4dDIwMCI6IkxvbmdlciBkZXNjcmlwdGlvbiBvZiB0aGUgdHJhbnNhY3Rpb24gY29udGV4dCJ9LHsidHlwZSI6ImRpc3BsYXlUZXh0QW5kUElOIiwiZGlzcGxheVRleHQ2MCI6IlNob3J0IGRlc2NyaXB0aW9uIG9mIHRoZSB0cmFuc2FjdGlvbiBjb250ZXh0In1d';
const initialCallbackUrl = 'https://rp.example.com/callback-url?value=RrKjjT4aggzu27YBddX1bQ';
const unprotectedDeviceLink = 'https://smart-id.com/device-link?deviceLinkType=App2App&amp;sessionToken=wGIrqveE6AuGDATZKmR1mtAZ&amp;sessionType=auth&amp;version=1.0&amp;lang=eng';

const authCodePayload = [
    schemeName,
    signatureProtocol,
    rpChallenge,
    relyingPartyNameBase64,
    brokeredRpNameBase64,
    interactions,
    initialCallbackUrl,
    unprotectedDeviceLink
].join(separator);

console.log(authCodePayload);</code></pre>
</div>
</div>
</div>
<div id="_tabs_11_ruby--panel" class="tabpanel" aria-labelledby="_tabs_11_ruby">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby">separator = '|'

scheme_name = 'smart-id'
signature_protocol = 'ACSP_V2'
rp_challenge = 'GYS+yoah6emAcVDNIajwSs6UB/M95XrDxMzXBUkwQJ9YFDipXXzGpPc7raWcuc2+TEoRc7WvIZ/7dU/iRXenYg=='
relying_party_name_base64 = 'REVNTw=='
brokered_rp_name_base64 = 'RXhhbXBsZSBSUA=='
interactions = 'W3sidHlwZSI6ImNvbmZpcm1hdGlvbk1lc3NhZ2UiLCJkaXNwbGF5VGV4dDIwMCI6IkxvbmdlciBkZXNjcmlwdGlvbiBvZiB0aGUgdHJhbnNhY3Rpb24gY29udGV4dCJ9LHsidHlwZSI6ImRpc3BsYXlUZXh0QW5kUElOIiwiZGlzcGxheVRleHQ2MCI6IlNob3J0IGRlc2NyaXB0aW9uIG9mIHRoZSB0cmFuc2FjdGlvbiBjb250ZXh0In1d'
initial_callback_url = 'https://rp.example.com/callback-url?value=RrKjjT4aggzu27YBddX1bQ'
unprotected_device_link = 'https://smart-id.com/device-link?deviceLinkType=App2App&amp;sessionToken=wGIrqveE6AuGDATZKmR1mtAZ&amp;sessionType=auth&amp;version=1.0&amp;lang=eng'

auth_code_payload = [
    scheme_name,
    signature_protocol,
    rp_challenge,
    relying_party_name_base64,
    brokered_rp_name_base64,
    interactions,
    initial_callback_url,
    unprotected_device_link
].join(separator)

puts auth_code_payload</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="_tabs_10_signature_session--panel" class="tabpanel" aria-labelledby="_tabs_10_signature_session">
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>For signature session device links <code>digest</code> value replaces the <code>rpChallenge</code>, and <code>signatureProtocol</code> value is <code>RAW_DIGEST_SIGNATURE</code>:</p>
</div>
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">authCodePayload := UTF8-ENCODE(STR-CONCAT(
        'smart-id', '|',
        'RAW_DIGEST_SIGNATURE', '|',
        digest, '|',
        BASE64-ENCODE(relyingPartyName), '|',
        BASE64-ENCODE(brokeredRpName), '|',
        interactions, '|',
        initialCallbackUrl, '|',
        unprotectedDeviceLink))</code></pre>
</div>
</div>
<div id="_tabs_12" class="openblock tabs is-sync is-loading">
<div class="content">
<div class="ulist tablist">
<ul>
<li id="_tabs_12_java" class="tab">
<p>Java</p>
</li>
<li id="_tabs_12_php" class="tab">
<p>PHP</p>
</li>
<li id="_tabs_12_python" class="tab">
<p>Python</p>
</li>
<li id="_tabs_12_go" class="tab">
<p>Go</p>
</li>
<li id="_tabs_12_rust" class="tab">
<p>Rust</p>
</li>
<li id="_tabs_12_kotlin" class="tab">
<p>Kotlin</p>
</li>
<li id="_tabs_12_c" class="tab">
<p>C#</p>
</li>
<li id="_tabs_12_node_js" class="tab">
<p>Node.js</p>
</li>
<li id="_tabs_12_ruby" class="tab">
<p>Ruby</p>
</li>
</ul>
</div>
<div id="_tabs_12_java--panel" class="tabpanel" aria-labelledby="_tabs_12_java">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public class AuthCodePayload {

  public static void main(String[] args) throws Exception {
    String separator = "|";
    String schemeName = "smart-id";
    String signatureProtocol = "RAW_DIGEST_SIGNATURE";
    String digest = "FNZFFya5wGLv9b27fZngaWrOBqle4tGwxZuDFRBdPl1RQvxJsfoqvTbjafd+8BcehMOQGvak6zlP+F8tga4bfQ==";
    String relyingPartyNameBase64 = "REVNTw==";
    String brokeredRpNameBase64 = "RXhhbXBsZSBSUA==";
    String interactions = "W3sidHlwZSI6ImNvbmZpcm1hdGlvbk1lc3NhZ2UiLCJkaXNwbGF5VGV4dDIwMCI6IkxvbmdlciBkZXNjcmlwdGlvbiBvZiB0aGUgdHJhbnNhY3Rpb24gY29udGV4dCJ9LHsidHlwZSI6ImRpc3BsYXlUZXh0QW5kUElOIiwiZGlzcGxheVRleHQ2MCI6IlNob3J0IGRlc2NyaXB0aW9uIG9mIHRoZSB0cmFuc2FjdGlvbiBjb250ZXh0In1d";
    String initialCallbackUrl = "https://rp.example.com/callback-url?value=RrKjjT4aggzu27YBddX1bQ";
    String unprotectedDeviceLink = "https://smart-id.com/device-link?deviceLinkType=App2App&amp;sessionToken=wGIrqveE6AuGDATZKmR1mtAZ&amp;sessionType=auth&amp;version=1.0&amp;lang=eng";

    String[] payloadParts = {
      schemeName,
      signatureProtocol,
      digest,
      relyingPartyNameBase64,
      brokeredRpNameBase64,
      interactions,
      initialCallbackUrl,
      unprotectedDeviceLink
    };

    String authCodePayload = String.join(separator, payloadParts);
    System.out.println(authCodePayload);
  }
}</code></pre>
</div>
</div>
</div>
<div id="_tabs_12_php--panel" class="tabpanel" aria-labelledby="_tabs_12_php">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-php hljs" data-lang="php">&lt;?php

$separator = '|';

$schemeName = 'smart-id';
$signatureProtocol = 'RAW_DIGEST_SIGNATURE';
$digest = 'FNZFFya5wGLv9b27fZngaWrOBqle4tGwxZuDFRBdPl1RQvxJsfoqvTbjafd+8BcehMOQGvak6zlP+F8tga4bfQ==';
$relyingPartyNameBase64 = 'REVNTw==';
$brokeredRpNameBase64 = 'RXhhbXBsZSBSUA==';
$interactions = 'W3sidHlwZSI6ImNvbmZpcm1hdGlvbk1lc3NhZ2UiLCJkaXNwbGF5VGV4dDIwMCI6IkxvbmdlciBkZXNjcmlwdGlvbiBvZiB0aGUgdHJhbnNhY3Rpb24gY29udGV4dCJ9LHsidHlwZSI6ImRpc3BsYXlUZXh0QW5kUElOIiwiZGlzcGxheVRleHQ2MCI6IlNob3J0IGRlc2NyaXB0aW9uIG9mIHRoZSB0cmFuc2FjdGlvbiBjb250ZXh0In1d';
$initialCallbackUrl = 'https://rp.example.com/callback-url?value=RrKjjT4aggzu27YBddX1bQ';
$unprotectedDeviceLink = 'https://smart-id.com/device-link?deviceLinkType=App2App&amp;sessionToken=wGIrqveE6AuGDATZKmR1mtAZ&amp;sessionType=auth&amp;version=1.0&amp;lang=eng';

$authCodePayload = implode($separator, [
    $schemeName,
    $signatureProtocol,
    $digest,
    $relyingPartyNameBase64,
    $brokeredRpNameBase64,
    $interactions,
    $initialCallbackUrl,
    $unprotectedDeviceLink
]);

echo $authCodePayload;

?&gt;</code></pre>
</div>
</div>
</div>
<div id="_tabs_12_python--panel" class="tabpanel" aria-labelledby="_tabs_12_python">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">separator = '|'

scheme_name = 'smart-id'
signature_protocol = 'RAW_DIGEST_SIGNATURE'
digest = 'FNZFFya5wGLv9b27fZngaWrOBqle4tGwxZuDFRBdPl1RQvxJsfoqvTbjafd+8BcehMOQGvak6zlP+F8tga4bfQ=='
relying_party_name_base64 = 'REVNTw=='
brokered_rp_name_base64 = 'RXhhbXBsZSBSUA=='
interactions = 'W3sidHlwZSI6ImNvbmZpcm1hdGlvbk1lc3NhZ2UiLCJkaXNwbGF5VGV4dDIwMCI6IkxvbmdlciBkZXNjcmlwdGlvbiBvZiB0aGUgdHJhbnNhY3Rpb24gY29udGV4dCJ9LHsidHlwZSI6ImRpc3BsYXlUZXh0QW5kUElOIiwiZGlzcGxheVRleHQ2MCI6IlNob3J0IGRlc2NyaXB0aW9uIG9mIHRoZSB0cmFuc2FjdGlvbiBjb250ZXh0In1d'
initial_callback_url = 'https://rp.example.com/callback-url?value=RrKjjT4aggzu27YBddX1bQ'
unprotected_device_link = 'https://smart-id.com/device-link?deviceLinkType=App2App&amp;sessionToken=wGIrqveE6AuGDATZKmR1mtAZ&amp;sessionType=auth&amp;version=1.0&amp;lang=eng'

auth_code_payload = separator.join([
    scheme_name,
    signature_protocol,
    digest,
    relying_party_name_base64,
    brokered_rp_name_base64,
    interactions,
    initial_callback_url,
    unprotected_device_link
])

print(auth_code_payload)</code></pre>
</div>
</div>
</div>
<div id="_tabs_12_go--panel" class="tabpanel" aria-labelledby="_tabs_12_go">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-go hljs" data-lang="go">package main

import (
	"fmt"
)

func main() {
	var separator string = "|"

	var schemeName string = "smart-id"
	var signatureProtocol string = "RAW_DIGEST_SIGNATURE"
	var digest string = "FNZFFya5wGLv9b27fZngaWrOBqle4tGwxZuDFRBdPl1RQvxJsfoqvTbjafd+8BcehMOQGvak6zlP+F8tga4bfQ=="
	var relyingPartyNameBase64 string = "REVNTw=="
	var brokeredRpNameBase64 string = "RXhhbXBsZSBSUA=="
	var interactions string = "W3sidHlwZSI6ImNvbmZpcm1hdGlvbk1lc3NhZ2UiLCJkaXNwbGF5VGV4dDIwMCI6IkxvbmdlciBkZXNjcmlwdGlvbiBvZiB0aGUgdHJhbnNhY3Rpb24gY29udGV4dCJ9LHsidHlwZSI6ImRpc3BsYXlUZXh0QW5kUElOIiwiZGlzcGxheVRleHQ2MCI6IlNob3J0IGRlc2NyaXB0aW9uIG9mIHRoZSB0cmFuc2FjdGlvbiBjb250ZXh0In1d"
	var initialCallbackUrl string = "https://rp.example.com/callback-url?value=RrKjjT4aggzu27YBddX1bQ"
	var unprotectedDeviceLink string = "https://smart-id.com/device-link?deviceLinkType=App2App&amp;sessionToken=wGIrqveE6AuGDATZKmR1mtAZ&amp;sessionType=auth&amp;version=1.0&amp;lang=eng"

	var payloadParts = []string{
		schemeName,
		signatureProtocol,
		digest,
		relyingPartyNameBase64,
		brokeredRpNameBase64,
		interactions,
		initialCallbackUrl,
		unprotectedDeviceLink,
	}

	var authCodePayload string = strings.Join(payloadParts, separator)

	fmt.Printf("%q\n", authCodePayload)
}</code></pre>
</div>
</div>
</div>
<div id="_tabs_12_rust--panel" class="tabpanel" aria-labelledby="_tabs_12_rust">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-rust hljs" data-lang="rust">fn main() {
    let separator: &amp;str = "|";
    let scheme_name: &amp;str = "smart-id";
    let signature_protocol: &amp;str = "RAW_DIGEST_SIGNATURE";
    let digest: &amp;str = "FNZFFya5wGLv9b27fZngaWrOBqle4tGwxZuDFRBdPl1RQvxJsfoqvTbjafd+8BcehMOQGvak6zlP+F8tga4bfQ==";
    let relying_party_name_base64: &amp;str = "REVNTw==";
    let brokered_rp_name_base64: &amp;str = "RXhhbXBsZSBSUA==";
    let interactions: &amp;str = "W3sidHlwZSI6ImNvbmZpcm1hdGlvbk1lc3NhZ2UiLCJkaXNwbGF5VGV4dDIwMCI6IkxvbmdlciBkZXNjcmlwdGlvbiBvZiB0aGUgdHJhbnNhY3Rpb24gY29udGV4dCJ9LHsidHlwZSI6ImRpc3BsYXlUZXh0QW5kUElOIiwiZGlzcGxheVRleHQ2MCI6IlNob3J0IGRlc2NyaXB0aW9uIG9mIHRoZSB0cmFuc2FjdGlvbiBjb250ZXh0In1d";
    let initial_callback_url: &amp;str = "https://rp.example.com/callback-url?value=RrKjjT4aggzu27YBddX1bQ";
    let unprotected_device_link: &amp;str = "https://smart-id.com/device-link?deviceLinkType=App2App&amp;sessionToken=wGIrqveE6AuGDATZKmR1mtAZ&amp;sessionType=auth&amp;version=1.0&amp;lang=eng";

    let auth_code_payload_parts: [&str; 7] = [
        scheme_name,
        signature_protocol,
        digest,
        relying_party_name_base64,
        brokered_rp_name_base64,
        interactions,
        initial_callback_url,
        unprotected_device_link
    ];

    let auth_code_payload: String = auth_code_payload_parts.join(separator);

    println!("{}", auth_code_payload)
}</code></pre>
</div>
</div>
</div>
<div id="_tabs_12_kotlin--panel" class="tabpanel" aria-labelledby="_tabs_12_kotlin">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">fun main() {
    val separator: String = "|"

    val schemeName: String = "smart-id"
    val signatureProtocol: String = "RAW_DIGEST_SIGNATURE"
    val digest: String = "FNZFFya5wGLv9b27fZngaWrOBqle4tGwxZuDFRBdPl1RQvxJsfoqvTbjafd+8BcehMOQGvak6zlP+F8tga4bfQ=="
    val relyingPartyNameBase64: String = "REVNTw=="
    val brokeredRpNameBase64: String = "RXhhbXBsZSBSUA=="
    val interactions: String = "W3sidHlwZSI6ImNvbmZpcm1hdGlvbk1lc3NhZ2UiLCJkaXNwbGF5VGV4dDIwMCI6IkxvbmdlciBkZXNjcmlwdGlvbiBvZiB0aGUgdHJhbnNhY3Rpb24gY29udGV4dCJ9LHsidHlwZSI6ImRpc3BsYXlUZXh0QW5kUElOIiwiZGlzcGxheVRleHQ2MCI6IlNob3J0IGRlc2NyaXB0aW9uIG9mIHRoZSB0cmFuc2FjdGlvbiBjb250ZXh0In1d"
    val initialCallbackUrl: String = "https://rp.example.com/callback-url?value=RrKjjT4aggzu27YBddX1bQ"
    val unprotectedDeviceLink: String = "https://smart-id.com/device-link?deviceLinkType=App2App&amp;sessionToken=wGIrqveE6AuGDATZKmR1mtAZ&amp;sessionType=auth&amp;version=1.0&amp;lang=eng"

    val payloadParts: List&lt;String&gt; = listOf(
        schemeName,
        signatureProtocol,
        digest,
        relyingPartyNameBase64,
        brokeredRpNameBase64,
        interactions,
        initialCallbackUrl,
        unprotectedDeviceLink
    )

    val authCodePayload: String = payloadParts.joinToString(separator)

    println(authCodePayload)
}</code></pre>
</div>
</div>
</div>
<div id="_tabs_12_c--panel" class="tabpanel" aria-labelledby="_tabs_12_c">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-cs hljs" data-lang="cs">using System;

public class AuthCodePayload
{
    public static void Main()
    {
        string separator = "|";

        string schemeName = "smart-id";
        string signatureProtocol = "RAW_DIGEST_SIGNATURE";
        string digest = "FNZFFya5wGLv9b27fZngaWrOBqle4tGwxZuDFRBdPl1RQvxJsfoqvTbjafd+8BcehMOQGvak6zlP+F8tga4bfQ==";
        string relyingPartyNameBase64 = "REVNTw==";
        string brokeredRpNameBase64 = "RXhhbXBsZSBSUA==";
        string interactions = "W3sidHlwZSI6ImNvbmZpcm1hdGlvbk1lc3NhZ2UiLCJkaXNwbGF5VGV4dDIwMCI6IkxvbmdlciBkZXNjcmlwdGlvbiBvZiB0aGUgdHJhbnNhY3Rpb24gY29udGV4dCJ9LHsidHlwZSI6ImRpc3BsYXlUZXh0QW5kUElOIiwiZGlzcGxheVRleHQ2MCI6IlNob3J0IGRlc2NyaXB0aW9uIG9mIHRoZSB0cmFuc2FjdGlvbiBjb250ZXh0In1d";
        string initialCallbackUrl = "https://rp.example.com/callback-url?value=RrKjjT4aggzu27YBddX1bQ";
        string unprotectedDeviceLink = "https://smart-id.com/device-link?deviceLinkType=App2App&amp;sessionToken=wGIrqveE6AuGDATZKmR1mtAZ&amp;sessionType=auth&amp;version=1.0&amp;lang=eng";

        string[] payloadParts = {
            schemeName,
            signatureProtocol,
            digest,
            relyingPartyNameBase64,
            brokeredRpNameBase64,
            interactions,
            initialCallbackUrl,
            unprotectedDeviceLink
        };

        string authCodePayload = string.Join(separator, payloadParts);
        Console.WriteLine(authCodePayload);
    }
}</code></pre>
</div>
</div>
</div>
<div id="_tabs_12_node_js--panel" class="tabpanel" aria-labelledby="_tabs_12_node_js">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-js hljs" data-lang="js">const separator = '|';

const schemeName = 'smart-id';
const signatureProtocol = 'RAW_DIGEST_SIGNATURE';
const digest = 'FNZFFya5wGLv9b27fZngaWrOBqle4tGwxZuDFRBdPl1RQvxJsfoqvTbjafd+8BcehMOQGvak6zlP+F8tga4bfQ==';
const relyingPartyNameBase64 = 'REVNTw==';
const brokeredRpNameBase64 = 'RXhhbXBsZSBSUA==';
const interactions = 'W3sidHlwZSI6ImNvbmZpcm1hdGlvbk1lc3NhZ2UiLCJkaXNwbGF5VGV4dDIwMCI6IkxvbmdlciBkZXNjcmlwdGlvbiBvZiB0aGUgdHJhbnNhY3Rpb24gY29udGV4dCJ9LHsidHlwZSI6ImRpc3BsYXlUZXh0QW5kUElOIiwiZGlzcGxheVRleHQ2MCI6IlNob3J0IGRlc2NyaXB0aW9uIG9mIHRoZSB0cmFuc2FjdGlvbiBjb250ZXh0In1d';
const initialCallbackUrl = 'https://rp.example.com/callback-url?value=RrKjjT4aggzu27YBddX1bQ';
const unprotectedDeviceLink = 'https://smart-id.com/device-link?deviceLinkType=App2App&amp;sessionToken=wGIrqveE6AuGDATZKmR1mtAZ&amp;sessionType=auth&amp;version=1.0&amp;lang=eng';

const authCodePayload = [
    schemeName,
    signatureProtocol,
    digest,
    relyingPartyNameBase64,
    brokeredRpNameBase64,
    interactions,
    initialCallbackUrl,
    unprotectedDeviceLink
].join(separator);

console.log(authCodePayload);</code></pre>
</div>
</div>
</div>
<div id="_tabs_12_ruby--panel" class="tabpanel" aria-labelledby="_tabs_12_ruby">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby">separator = '|'

scheme_name = 'smart-id'
signature_protocol = 'RAW_DIGEST_SIGNATURE'
digest = 'FNZFFya5wGLv9b27fZngaWrOBqle4tGwxZuDFRBdPl1RQvxJsfoqvTbjafd+8BcehMOQGvak6zlP+F8tga4bfQ=='
relying_party_name_base64 = 'REVNTw=='
brokered_rp_name_base64 = 'RXhhbXBsZSBSUA=='
interactions = 'W3sidHlwZSI6ImNvbmZpcm1hdGlvbk1lc3NhZ2UiLCJkaXNwbGF5VGV4dDIwMCI6IkxvbmdlciBkZXNjcmlwdGlvbiBvZiB0aGUgdHJhbnNhY3Rpb24gY29udGV4dCJ9LHsidHlwZSI6ImRpc3BsYXlUZXh0QW5kUElOIiwiZGlzcGxheVRleHQ2MCI6IlNob3J0IGRlc2NyaXB0aW9uIG9mIHRoZSB0cmFuc2FjdGlvbiBjb250ZXh0In1d'
initial_callback_url = 'https://rp.example.com/callback-url?value=RrKjjT4aggzu27YBddX1bQ'
unprotected_device_link = 'https://smart-id.com/device-link?deviceLinkType=App2App&amp;sessionToken=wGIrqveE6AuGDATZKmR1mtAZ&amp;sessionType=auth&amp;version=1.0&amp;lang=eng'

auth_code_payload = [
    scheme_name,
    signature_protocol,
    digest,
    relying_party_name_base64,
    brokered_rp_name_base64,
    interactions,
    initial_callback_url,
    unprotected_device_link
].join(separator)

puts auth_code_payload</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="_tabs_10_certificate_choice_session--panel" class="tabpanel" aria-labelledby="_tabs_10_certificate_choice_session">
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>For certificate-choice session device links, <code>digest</code>, <code>interactions</code> and <code>signatureProtocol</code> values are omitted:</p>
</div>
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">authCodePayload := UTF8-ENCODE(STR-CONCAT(
        'smart-id', '|',
        '', '|',
        '', '|',
        BASE64-ENCODE(relyingPartyName), '|',
        BASE64-ENCODE(brokeredRpName), '|',
        '', '|',
        initialCallbackUrl, '|',
        unprotectedDeviceLink))</code></pre>
</div>
</div>
<div id="_tabs_13" class="openblock tabs is-sync is-loading">
<div class="content">
<div class="ulist tablist">
<ul>
<li id="_tabs_13_java" class="tab">
<p>Java</p>
</li>
<li id="_tabs_13_php" class="tab">
<p>PHP</p>
</li>
<li id="_tabs_13_python" class="tab">
<p>Python</p>
</li>
<li id="_tabs_13_go" class="tab">
<p>Go</p>
</li>
<li id="_tabs_13_rust" class="tab">
<p>Rust</p>
</li>
<li id="_tabs_13_kotlin" class="tab">
<p>Kotlin</p>
</li>
<li id="_tabs_13_c" class="tab">
<p>C#</p>
</li>
<li id="_tabs_13_node_js" class="tab">
<p>Node.js</p>
</li>
<li id="_tabs_13_ruby" class="tab">
<p>Ruby</p>
</li>
</ul>
</div>
<div id="_tabs_13_java--panel" class="tabpanel" aria-labelledby="_tabs_13_java">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public class AuthCodePayload {

  public static void main(String[] args) throws Exception {
    String separator = "|";
    String schemeName = "smart-id";
    String signatureProtocol = "";
    String digest = "";
    String relyingPartyNameBase64 = "REVNTw==";
    String brokeredRpNameBase64 = "RXhhbXBsZSBSUA==";
    String interactions = "";
    String initialCallbackUrl = "https://rp.example.com/callback-url?value=RrKjjT4aggzu27YBddX1bQ";
    String unprotectedDeviceLink = "https://smart-id.com/device-link?deviceLinkType=App2App&amp;sessionToken=wGIrqveE6AuGDATZKmR1mtAZ&amp;sessionType=auth&amp;version=1.0&amp;lang=eng";

    String[] payloadParts = {
      schemeName,
      signatureProtocol,
      digest,
      relyingPartyNameBase64,
      brokeredRpNameBase64,
      interactions,
      initialCallbackUrl,
      unprotectedDeviceLink
    };

    String authCodePayload = String.join(separator, payloadParts);
    System.out.println(authCodePayload);
  }
}</code></pre>
</div>
</div>
</div>
<div id="_tabs_13_php--panel" class="tabpanel" aria-labelledby="_tabs_13_php">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-php hljs" data-lang="php">&lt;?php

$separator = '|';

$schemeName = 'smart-id';
$signatureProtocol = '';
$digest = '';
$relyingPartyNameBase64 = 'REVNTw==';
$brokeredRpNameBase64 = 'RXhhbXBsZSBSUA==';
$interactions = '';
$initialCallbackUrl = 'https://rp.example.com/callback-url?value=RrKjjT4aggzu27YBddX1bQ';
$unprotectedDeviceLink = 'https://smart-id.com/device-link?deviceLinkType=App2App&amp;sessionToken=wGIrqveE6AuGDATZKmR1mtAZ&amp;sessionType=auth&amp;version=1.0&amp;lang=eng';

$authCodePayload = implode($separator, [
    $schemeName,
    $signatureProtocol,
    $digest,
    $relyingPartyNameBase64,
    $brokeredRpNameBase64,
    $interactions,
    $initialCallbackUrl,
    $unprotectedDeviceLink
]);

echo $authCodePayload;

?&gt;</code></pre>
</div>
</div>
</div>
<div id="_tabs_13_python--panel" class="tabpanel" aria-labelledby="_tabs_13_python">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">separator = '|'

scheme_name = 'smart-id'
signature_protocol = ''
digest = ''
relying_party_name_base64 = 'REVNTw=='
brokered_rp_name_base64 = 'RXhhbXBsZSBSUA=='
interactions = ''
initial_callback_url = 'https://rp.example.com/callback-url?value=RrKjjT4aggzu27YBddX1bQ'
unprotected_device_link = 'https://smart-id.com/device-link?deviceLinkType=App2App&amp;sessionToken=wGIrqveE6AuGDATZKmR1mtAZ&amp;sessionType=auth&amp;version=1.0&amp;lang=eng'

auth_code_payload = separator.join([
    scheme_name,
    signature_protocol,
    digest,
    relying_party_name_base64,
    brokered_rp_name_base64,
    interactions,
    initial_callback_url,
    unprotected_device_link
])

print(auth_code_payload)</code></pre>
</div>
</div>
</div>
<div id="_tabs_13_go--panel" class="tabpanel" aria-labelledby="_tabs_13_go">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-go hljs" data-lang="go">package main

import (
	"fmt"
)

func main() {
	var separator string = "|"

	var schemeName string = "smart-id"
	var signatureProtocol string = ""
	var digest string = ""
	var relyingPartyNameBase64 string = "REVNTw=="
	var brokeredRpNameBase64 string = "RXhhbXBsZSBSUA=="
	var interactions string = ""
	var initialCallbackUrl string = "https://rp.example.com/callback-url?value=RrKjjT4aggzu27YBddX1bQ"
	var unprotectedDeviceLink string = "https://smart-id.com/device-link?deviceLinkType=App2App&amp;sessionToken=wGIrqveE6AuGDATZKmR1mtAZ&amp;sessionType=auth&amp;version=1.0&amp;lang=eng"

	var payloadParts = []string{
		schemeName,
		signatureProtocol,
		digest,
		relyingPartyNameBase64,
		brokeredRpNameBase64,
		interactions,
		initialCallbackUrl,
		unprotectedDeviceLink,
	}

	var authCodePayload string = strings.Join(payloadParts, separator)

	fmt.Printf("%q\n", authCodePayload)
}</code></pre>
</div>
</div>
</div>
<div id="_tabs_13_rust--panel" class="tabpanel" aria-labelledby="_tabs_13_rust">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-rust hljs" data-lang="rust">fn main() {
    let separator: &amp;str = "|";
    let scheme_name: &amp;str = "smart-id";
    let signature_protocol: &amp;str = "";
    let digest: &amp;str = "";
    let relying_party_name_base64: &amp;str = "REVNTw==";
    let brokered_rp_name_base64: &amp;str = "RXhhbXBsZSBSUA==";
    let interactions: &amp;str = "";
    let initial_callback_url: &amp;str = "https://rp.example.com/callback-url?value=RrKjjT4aggzu27YBddX1bQ";
    let unprotected_device_link: &amp;str = "https://smart-id.com/device-link?deviceLinkType=App2App&amp;sessionToken=wGIrqveE6AuGDATZKmR1mtAZ&amp;sessionType=auth&amp;version=1.0&amp;lang=eng";

    let auth_code_payload_parts: [&str; 7] = [
        scheme_name,
        signature_protocol,
        digest,
        relying_party_name_base64,
        brokered_rp_name_base64,
        interactions,
        initial_callback_url,
        unprotected_device_link
    ];

    let auth_code_payload: String = auth_code_payload_parts.join(separator);

    println!("{}", auth_code_payload)
}</code></pre>
</div>
</div>
</div>
<div id="_tabs_13_kotlin--panel" class="tabpanel" aria-labelledby="_tabs_13_kotlin">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">fun main() {
    val separator: String = "|"

    val schemeName: String = "smart-id"
    val signatureProtocol: String = ""
    val digest: String = ""
    val relyingPartyNameBase64: String = "REVNTw=="
    val brokeredRpNameBase64: String = "RXhhbXBsZSBSUA=="
    val interactions: String = ""
    val initialCallbackUrl: String = "https://rp.example.com/callback-url?value=RrKjjT4aggzu27YBddX1bQ"
    val unprotectedDeviceLink: String = "https://smart-id.com/device-link?deviceLinkType=App2App&amp;sessionToken=wGIrqveE6AuGDATZKmR1mtAZ&amp;sessionType=auth&amp;version=1.0&amp;lang=eng"

    val payloadParts: List&lt;String&gt; = listOf(
        schemeName,
        signatureProtocol,
        digest,
        relyingPartyNameBase64,
        brokeredRpNameBase64,
        interactions,
        initialCallbackUrl,
        unprotectedDeviceLink
    )

    val authCodePayload: String = payloadParts.joinToString(separator)

    println(authCodePayload)
}</code></pre>
</div>
</div>
</div>
<div id="_tabs_13_c--panel" class="tabpanel" aria-labelledby="_tabs_13_c">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-cs hljs" data-lang="cs">using System;

public class AuthCodePayload
{
    public static void Main()
    {
        string separator = "|";

        string schemeName = "smart-id";
        string signatureProtocol = "";
        string digest = "";
        string relyingPartyNameBase64 = "REVNTw==";
        string brokeredRpNameBase64 = "RXhhbXBsZSBSUA==";
        string interactions = "";
        string initialCallbackUrl = "https://rp.example.com/callback-url?value=RrKjjT4aggzu27YBddX1bQ";
        string unprotectedDeviceLink = "https://smart-id.com/device-link?deviceLinkType=App2App&amp;sessionToken=wGIrqveE6AuGDATZKmR1mtAZ&amp;sessionType=auth&amp;version=1.0&amp;lang=eng";

        string[] payloadParts = {
            schemeName,
            signatureProtocol,
            digest,
            relyingPartyNameBase64,
            brokeredRpNameBase64,
            interactions,
            initialCallbackUrl,
            unprotectedDeviceLink
        };

        string authCodePayload = string.Join(separator, payloadParts);
        Console.WriteLine(authCodePayload);
    }
}</code></pre>
</div>
</div>
</div>
<div id="_tabs_13_node_js--panel" class="tabpanel" aria-labelledby="_tabs_13_node_js">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-js hljs" data-lang="js">const separator = '|';

const schemeName = 'smart-id';
const signatureProtocol = '';
const digest = '';
const relyingPartyNameBase64 = 'REVNTw==';
const brokeredRpNameBase64 = 'RXhhbXBsZSBSUA==';
const interactions = '';
const initialCallbackUrl = 'https://rp.example.com/callback-url?value=RrKjjT4aggzu27YBddX1bQ';
const unprotectedDeviceLink = 'https://smart-id.com/device-link?deviceLinkType=App2App&amp;sessionToken=wGIrqveE6AuGDATZKmR1mtAZ&amp;sessionType=auth&amp;version=1.0&amp;lang=eng';

const authCodePayload = [
    schemeName,
    signatureProtocol,
    digest,
    relyingPartyNameBase64,
    brokeredRpNameBase64,
    interactions,
    initialCallbackUrl,
    unprotectedDeviceLink
].join(separator);

console.log(authCodePayload);</code></pre>
</div>
</div>
</div>
<div id="_tabs_13_ruby--panel" class="tabpanel" aria-labelledby="_tabs_13_ruby">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby">separator = '|'

scheme_name = 'smart-id'
signature_protocol = ''
digest = ''
relying_party_name_base64 = 'REVNTw=='
brokered_rp_name_base64 = 'RXhhbXBsZSBSUA=='
interactions = ''
initial_callback_url = 'https://rp.example.com/callback-url?value=RrKjjT4aggzu27YBddX1bQ'
unprotected_device_link = 'https://smart-id.com/device-link?deviceLinkType=App2App&amp;sessionToken=wGIrqveE6AuGDATZKmR1mtAZ&amp;sessionType=auth&amp;version=1.0&amp;lang=eng'

auth_code_payload = [
    scheme_name,
    signature_protocol,
    digest,
    relying_party_name_base64,
    brokered_rp_name_base64,
    interactions,
    initial_callback_url,
    unprotected_device_link
].join(separator)

puts auth_code_payload</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>After the RP assembles the <code>authCodePayload</code>, <code>authCode</code> can be calculated as follows:</p>
</div>
<div id="_tabs_14" class="openblock tabs is-sync is-loading">
<div class="content">
<div class="ulist tablist">
<ul>
<li id="_tabs_14_authentication_session" class="tab">
<p>Authentication Session</p>
</li>
<li id="_tabs_14_signature_session" class="tab">
<p>Signature Session</p>
</li>
<li id="_tabs_14_certificate_choice_session" class="tab">
<p>Certificate-choice Session</p>
</li>
</ul>
</div>
<div id="_tabs_14_authentication_session--panel" class="tabpanel" aria-labelledby="_tabs_14_authentication_session">
<div class="openblock">
<div class="content">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">authCode := BASE64URL-ENCODE(HMAC-SHA256(sessionSecret, authCodePayload))</code></pre>
</div>
</div>
<div id="_tabs_15" class="openblock tabs is-sync is-loading">
<div class="content">
<div class="ulist tablist">
<ul>
<li id="_tabs_15_java" class="tab">
<p>Java</p>
</li>
<li id="_tabs_15_php" class="tab">
<p>PHP</p>
</li>
<li id="_tabs_15_python" class="tab">
<p>Python</p>
</li>
<li id="_tabs_15_go" class="tab">
<p>Go</p>
</li>
<li id="_tabs_15_rust" class="tab">
<p>Rust</p>
</li>
<li id="_tabs_15_kotlin" class="tab">
<p>Kotlin</p>
</li>
<li id="_tabs_15_c" class="tab">
<p>C#</p>
</li>
<li id="_tabs_15_node_js" class="tab">
<p>Node.js</p>
</li>
<li id="_tabs_15_ruby" class="tab">
<p>Ruby</p>
</li>
</ul>
</div>
<div id="_tabs_15_java--panel" class="tabpanel" aria-labelledby="_tabs_15_java">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">import java.nio.charset.StandardCharsets;
import java.util.Base64;

import javax.crypto.Mac;
import javax.crypto.spec.SecretKeySpec;

public class AuthCodeCalculator {

  public static void main(String[] args) throws Exception {
    String sessionSecretBase64 = "B98ODiVCebRedSwdTk51zFSaGYyHtY1H2A0ocAi3/Ps=";

    byte[] sessionSecret = Base64.getDecoder()
      .decode(sessionSecretBase64);

    byte[] authCodePayload = "00NRcgi4Jk7WdIwgMPlyM8wRy9KMu4C_oQvd-N6PKoo"
      .getBytes(StandardCharsets.UTF_8);

    Mac sha256Hmac = Mac.getInstance("HmacSHA256");
    SecretKeySpec secretKey = new SecretKeySpec(sessionSecret, sha256Hmac.getAlgorithm());
    sha256Hmac.init(secretKey);

    byte[] authCodeBytes = sha256Hmac.doFinal(authCodePayload);

    String authCode = Base64.getUrlEncoder()
      .withoutPadding()
      .encodeToString(authCodeBytes);

    System.out.println(authCode);
  }
}</code></pre>
</div>
</div>
</div>
<div id="_tabs_15_php--panel" class="tabpanel" aria-labelledby="_tabs_15_php">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-php hljs" data-lang="php">&lt;?php

$sessionSecretBase64 = 'B98ODiVCebRedSwdTk51zFSaGYyHtY1H2A0ocAi3/Ps=';
$sessionSecret = base64_decode($sessionSecretBase64);

$authCodePayload = '00NRcgi4Jk7WdIwgMPlyM8wRy9KMu4C_oQvd-N6PKoo';

$authCodeBytes = hash_hmac('sha256', $authCodePayload, $sessionSecret, true);

$authCode = rtrim(strtr(base64_encode($authCodeBytes), '+/', '-_'), '=');

echo $authCode;
?&gt;</code></pre>
</div>
</div>
</div>
<div id="_tabs_15_python--panel" class="tabpanel" aria-labelledby="_tabs_15_python">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">import hmac
import hashlib
import base64

session_secret_base64 = b'B98ODiVCebRedSwdTk51zFSaGYyHtY1H2A0ocAi3/Ps='
session_secret = base64.b64decode(session_secret_base64)

auth_code_payload = b'00NRcgi4Jk7WdIwgMPlyM8wRy9KMu4C_oQvd-N6PKoo'

auth_code_bytes = hmac.new(session_secret, auth_code_payload, hashlib.sha256).digest()

auth_code = base64.urlsafe_b64encode(auth_code_bytes).rstrip(b'=').decode('utf-8')
print(auth_code)</code></pre>
</div>
</div>
</div>
<div id="_tabs_15_go--panel" class="tabpanel" aria-labelledby="_tabs_15_go">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-go hljs" data-lang="go">package main

import (
	"crypto/hmac"
	"crypto/sha256"
	"encoding/base64"
	"fmt"
)

func main() {
	var sessionSecretBase64 = "B98ODiVCebRedSwdTk51zFSaGYyHtY1H2A0ocAi3/Ps="
	var authCodePayload []byte = []byte("00NRcgi4Jk7WdIwgMPlyM8wRy9KMu4C_oQvd-N6PKoo")

	sessionSecret, err := base64.StdEncoding.DecodeString(sessionSecretBase64)
	if err != nil {
		panic(err)
	}

	mac := hmac.New(sha256.New, sessionSecret)
	mac.Write(authCodePayload)
	var authCodeBytes []byte = mac.Sum(nil)

	var authCode string = base64.RawURLEncoding.EncodeToString(authCodeBytes)
	fmt.Printf("%s\n", authCode)
}</code></pre>
</div>
</div>
</div>
<div id="_tabs_15_rust--panel" class="tabpanel" aria-labelledby="_tabs_15_rust">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-rust hljs" data-lang="rust">use hmac::{Hmac, Mac};
use sha2::Sha256;
use base64::{Engine as _, engine::{self, general_purpose}, alphabet};

fn main() {
    let session_secret_base64 = "B98ODiVCebRedSwdTk51zFSaGYyHtY1H2A0ocAi3/Ps=";
    let session_secret: &amp;[u8] = &amp;base64::engine::general_purpose::STANDARD.decode(session_secret_base64).unwrap();

    let auth_code_payload: &amp;[u8] = &amp;b"00NRcgi4Jk7WdIwgMPlyM8wRy9KMu4C_oQvd-N6PKoo"[..];

    let mut mac = Hmac::&lt;Sha256&gt;::new_from_slice(session_secret).expect("HMAC can take key of any size");
    mac.update(auth_code_payload);

    let auth_code_bytes = mac.finalize().into_bytes();

    const CUSTOM_ENGINE: engine::GeneralPurpose = base64::engine::GeneralPurpose::new(&amp;alphabet::URL_SAFE, general_purpose::NO_PAD);
    let auth_code: String = CUSTOM_ENGINE.encode(auth_code_bytes);
    println!("{}", auth_code)
}</code></pre>
</div>
</div>
</div>
<div id="_tabs_15_kotlin--panel" class="tabpanel" aria-labelledby="_tabs_15_kotlin">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">import javax.crypto.Mac;
import javax.crypto.spec.SecretKeySpec;
import java.nio.charset.StandardCharsets
import java.util.Base64

fun main() {
  val sessionSecretBase64: String = "B98ODiVCebRedSwdTk51zFSaGYyHtY1H2A0ocAi3/Ps="
  val sessionSecret: ByteArray = Base64.getDecoder()
    .decode(sessionSecretBase64)

  val authCodePayload: ByteArray = "00NRcgi4Jk7WdIwgMPlyM8wRy9KMu4C_oQvd-N6PKoo"
    .toByteArray(StandardCharsets.UTF_8)

  val hmac: Mac = Mac.getInstance("HmacSHA256")
  val secretKey: SecretKey = SecretKeySpec(sessionSecret, hmac.algorithm)
  hmac.init(secretKey)

  val authCodeBytes: ByteArray = hmac.doFinal(authCodePayload)

  val authCode: String = Base64.getUrlEncoder()
    .withoutPadding()
    .encodeToString(authCodeBytes)

  println(authCode)
}</code></pre>
</div>
</div>
</div>
<div id="_tabs_15_c--panel" class="tabpanel" aria-labelledby="_tabs_15_c">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-cs hljs" data-lang="cs">using System;
using System.Text;
using System.Security.Cryptography;

public class AuthCodeCalculator
{
    public static void Main(string[] args)
    {
        string sessionSecretBase64 = "B98ODiVCebRedSwdTk51zFSaGYyHtY1H2A0ocAi3/Ps=";
        byte[] sessionSecret = Convert.FromBase64String(sessionSecretBase64);
        byte[] authCodePayload = Encoding.UTF8.GetBytes("00NRcgi4Jk7WdIwgMPlyM8wRy9KMu4C_oQvd-N6PKoo");

        HMACSHA256 hmac = new HMACSHA256(sessionSecret);
        byte[] authCodeBytes = hmac.ComputeHash(authCodePayload);
        string authCode = Convert.ToBase64String(authCodeBytes)
            .Replace('+', '-')
            .Replace('/', '_')
            .TrimEnd('=');

        Console.WriteLine(authCode);
    }
}</code></pre>
</div>
</div>
</div>
<div id="_tabs_15_node_js--panel" class="tabpanel" aria-labelledby="_tabs_15_node_js">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-js hljs" data-lang="js">const crypto = require('crypto');

const sessionSecretBase64 = 'B98ODiVCebRedSwdTk51zFSaGYyHtY1H2A0ocAi3/Ps=';
const sessionSecret = Buffer.from(sessionSecretBase64, 'base64');

const authCodePayload = '00NRcgi4Jk7WdIwgMPlyM8wRy9KMu4C_oQvd-N6PKoo';

const hmac = crypto.createHmac('sha256', sessionSecret);
hmac.update(authCodePayload);

const authCode = hmac.digest('base64url')
    .replace(/=+$/, '');

console.log(authCode);</code></pre>
</div>
</div>
</div>
<div id="_tabs_15_ruby--panel" class="tabpanel" aria-labelledby="_tabs_15_ruby">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby">require 'base64'
require 'openssl'

session_secret_base64 = 'B98ODiVCebRedSwdTk51zFSaGYyHtY1H2A0ocAi3/Ps='
session_secret = Base64.decode64(session_secret_base64)

auth_code_payload = '00NRcgi4Jk7WdIwgMPlyM8wRy9KMu4C_oQvd-N6PKoo'

hmac = OpenSSL::HMAC.digest(
  'sha256', session_secret, auth_code_payload
)
auth_code = Base64.urlsafe_encode64(hmac).sub(/=*$/, '')

puts auth_code</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="exampleblock">
<div class="title">Example 4. <code>authCode</code> parameter</div>
<div class="content">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">00NRcgi4Jk7WdIwgMPlyM8wRy9KMu4C_oQvd-N6PKoo</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="_tabs_14_signature_session--panel" class="tabpanel" aria-labelledby="_tabs_14_signature_session">
<div class="openblock">
<div class="content">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">authCode := BASE64URL-ENCODE(HMAC-SHA256(sessionSecret, authCodePayload))</code></pre>
</div>
</div>
<div id="_tabs_16" class="openblock tabs is-sync is-loading">
<div class="content">
<div class="ulist tablist">
<ul>
<li id="_tabs_16_java" class="tab">
<p>Java</p>
</li>
<li id="_tabs_16_php" class="tab">
<p>PHP</p>
</li>
<li id="_tabs_16_python" class="tab">
<p>Python</p>
</li>
<li id="_tabs_16_go" class="tab">
<p>Go</p>
</li>
<li id="_tabs_16_rust" class="tab">
<p>Rust</p>
</li>
<li id="_tabs_16_kotlin" class="tab">
<p>Kotlin</p>
</li>
<li id="_tabs_16_c" class="tab">
<p>C#</p>
</li>
<li id="_tabs_16_node_js" class="tab">
<p>Node.js</p>
</li>
<li id="_tabs_16_ruby" class="tab">
<p>Ruby</p>
</li>
</ul>
</div>
<div id="_tabs_16_java--panel" class="tabpanel" aria-labelledby="_tabs_16_java">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">import java.nio.charset.StandardCharsets;
import java.util.Base64;

import javax.crypto.Mac;
import javax.crypto.spec.SecretKeySpec;

public class AuthCodeCalculator {

  public static void main(String[] args) throws Exception {
    String sessionSecretBase64 = "B98ODiVCebRedSwdTk51zFSaGYyHtY1H2A0ocAi3/Ps=";

    byte[] sessionSecret = Base64.getDecoder()
      .decode(sessionSecretBase64);

    byte[] authCodePayload = "8QZ16rkBW_ffkq6osT7UH1DbUlF9gEOZevgj-A0VNbM"
      .getBytes(StandardCharsets.UTF_8);

    Mac sha256Hmac = Mac.getInstance("HmacSHA256");
    SecretKeySpec secretKey = new SecretKeySpec(sessionSecret, sha256Hmac.getAlgorithm());
    sha256Hmac.init(secretKey);

    byte[] authCodeBytes = sha256Hmac.doFinal(authCodePayload);

    String authCode = Base64.getUrlEncoder()
      .withoutPadding()
      .encodeToString(authCodeBytes);

    System.out.println(authCode);
  }
}</code></pre>
</div>
</div>
</div>
<div id="_tabs_16_php--panel" class="tabpanel" aria-labelledby="_tabs_16_php">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-php hljs" data-lang="php">&lt;?php

$sessionSecretBase64 = 'B98ODiVCebRedSwdTk51zFSaGYyHtY1H2A0ocAi3/Ps=';
$sessionSecret = base64_decode($sessionSecretBase64);

$authCodePayload = '8QZ16rkBW_ffkq6osT7UH1DbUlF9gEOZevgj-A0VNbM';

$authCodeBytes = hash_hmac('sha256', $authCodePayload, $sessionSecret, true);

$authCode = rtrim(strtr(base64_encode($authCodeBytes), '+/', '-_'), '=');

echo $authCode;
?&gt;</code></pre>
</div>
</div>
</div>
<div id="_tabs_16_python--panel" class="tabpanel" aria-labelledby="_tabs_16_python">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">import hmac
import hashlib
import base64

session_secret_base64 = b'B98ODiVCebRedSwdTk51zFSaGYyHtY1H2A0ocAi3/Ps='
session_secret = base64.b64decode(session_secret_base64)

auth_code_payload = b'8QZ16rkBW_ffkq6osT7UH1DbUlF9gEOZevgj-A0VNbM'

auth_code_bytes = hmac.new(session_secret, auth_code_payload, hashlib.sha256).digest()

auth_code = base64.urlsafe_b64encode(auth_code_bytes).rstrip(b'=').decode('utf-8')
print(auth_code)</code></pre>
</div>
</div>
</div>
<div id="_tabs_16_go--panel" class="tabpanel" aria-labelledby="_tabs_16_go">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-go hljs" data-lang="go">package main

import (
	"crypto/hmac"
	"crypto/sha256"
	"encoding/base64"
	"fmt"
)

func main() {
	var sessionSecretBase64 = "B98ODiVCebRedSwdTk51zFSaGYyHtY1H2A0ocAi3/Ps="
	var authCodePayload []byte = []byte("8QZ16rkBW_ffkq6osT7UH1DbUlF9gEOZevgj-A0VNbM")

	sessionSecret, err := base64.StdEncoding.DecodeString(sessionSecretBase64)
	if err != nil {
		panic(err)
	}

	mac := hmac.New(sha256.New, sessionSecret)
	mac.Write(authCodePayload)
	var authCodeBytes []byte = mac.Sum(nil)

	var authCode string = base64.RawURLEncoding.EncodeToString(authCodeBytes)
	fmt.Printf("%s\n", authCode)
}</code></pre>
</div>
</div>
</div>
<div id="_tabs_16_rust--panel" class="tabpanel" aria-labelledby="_tabs_16_rust">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-rust hljs" data-lang="rust">use hmac::{Hmac, Mac};
use sha2::Sha256;
use base64::{Engine as _, engine::{self, general_purpose}, alphabet};

fn main() {
    let session_secret_base64 = "B98ODiVCebRedSwdTk51zFSaGYyHtY1H2A0ocAi3/Ps=";
    let session_secret: &amp;[u8] = &amp;base64::engine::general_purpose::STANDARD.decode(session_secret_base64).unwrap();

    let auth_code_payload: &amp;[u8] = &amp;b"8QZ16rkBW_ffkq6osT7UH1DbUlF9gEOZevgj-A0VNbM"[..];

    let mut mac = Hmac::&lt;Sha256&gt;::new_from_slice(session_secret).expect("HMAC can take key of any size");
    mac.update(auth_code_payload);

    let auth_code_bytes = mac.finalize().into_bytes();

    const CUSTOM_ENGINE: engine::GeneralPurpose = base64::engine::GeneralPurpose::new(&amp;alphabet::URL_SAFE, general_purpose::NO_PAD);
    let auth_code: String = CUSTOM_ENGINE.encode(auth_code_bytes);
    println!("{}", auth_code)
}</code></pre>
</div>
</div>
</div>
<div id="_tabs_16_kotlin--panel" class="tabpanel" aria-labelledby="_tabs_16_kotlin">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">import javax.crypto.Mac;
import javax.crypto.spec.SecretKeySpec;
import java.nio.charset.StandardCharsets
import java.util.Base64

fun main() {
  val sessionSecretBase64: String = "B98ODiVCebRedSwdTk51zFSaGYyHtY1H2A0ocAi3/Ps="
  val sessionSecret: ByteArray = Base64.getDecoder()
    .decode(sessionSecretBase64)

  val authCodePayload: ByteArray = "8QZ16rkBW_ffkq6osT7UH1DbUlF9gEOZevgj-A0VNbM"
    .toByteArray(StandardCharsets.UTF_8)

  val hmac: Mac = Mac.getInstance("HmacSHA256")
  val secretKey: SecretKey = SecretKeySpec(sessionSecret, hmac.algorithm)
  hmac.init(secretKey)

  val authCodeBytes: ByteArray = hmac.doFinal(authCodePayload)

  val authCode: String = Base64.getUrlEncoder()
    .withoutPadding()
    .encodeToString(authCodeBytes)

  println(authCode)
}</code></pre>
</div>
</div>
</div>
<div id="_tabs_16_c--panel" class="tabpanel" aria-labelledby="_tabs_16_c">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-cs hljs" data-lang="cs">using System;
using System.Text;
using System.Security.Cryptography;

public class AuthCodeCalculator
{
    public static void Main(string[] args)
    {
        string sessionSecretBase64 = "B98ODiVCebRedSwdTk51zFSaGYyHtY1H2A0ocAi3/Ps=";
        byte[] sessionSecret = Convert.FromBase64String(sessionSecretBase64);
        byte[] authCodePayload = Encoding.UTF8.GetBytes("8QZ16rkBW_ffkq6osT7UH1DbUlF9gEOZevgj-A0VNbM");

        HMACSHA256 hmac = new HMACSHA256(sessionSecret);
        byte[] authCodeBytes = hmac.ComputeHash(authCodePayload);
        string authCode = Convert.ToBase64String(authCodeBytes)
            .Replace('+', '-')
            .Replace('/', '_')
            .TrimEnd('=');

        Console.WriteLine(authCode);
    }
}</code></pre>
</div>
</div>
</div>
<div id="_tabs_16_node_js--panel" class="tabpanel" aria-labelledby="_tabs_16_node_js">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-js hljs" data-lang="js">const crypto = require('crypto');

const sessionSecretBase64 = 'B98ODiVCebRedSwdTk51zFSaGYyHtY1H2A0ocAi3/Ps=';
const sessionSecret = Buffer.from(sessionSecretBase64, 'base64');

const authCodePayload = '8QZ16rkBW_ffkq6osT7UH1DbUlF9gEOZevgj-A0VNbM';

const hmac = crypto.createHmac('sha256', sessionSecret);
hmac.update(authCodePayload);

const authCode = hmac.digest('base64url')
    .replace(/=+$/, '');

console.log(authCode);</code></pre>
</div>
</div>
</div>
<div id="_tabs_16_ruby--panel" class="tabpanel" aria-labelledby="_tabs_16_ruby">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby">require 'base64'
require 'openssl'

session_secret_base64 = 'B98ODiVCebRedSwdTk51zFSaGYyHtY1H2A0ocAi3/Ps='
session_secret = Base64.decode64(session_secret_base64)

auth_code_payload = '8QZ16rkBW_ffkq6osT7UH1DbUlF9gEOZevgj-A0VNbM'

hmac = OpenSSL::HMAC.digest(
  'sha256', session_secret, auth_code_payload
)
auth_code = Base64.urlsafe_encode64(hmac).sub(/=*$/, '')

puts auth_code</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="exampleblock">
<div class="title">Example 5. <code>authCode</code> parameter</div>
<div class="content">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">8QZ16rkBW_ffkq6osT7UH1DbUlF9gEOZevgj-A0VNbM</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="_tabs_14_certificate_choice_session--panel" class="tabpanel" aria-labelledby="_tabs_14_certificate_choice_session">
<div class="openblock">
<div class="content">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">authCode := BASE64URL-ENCODE(HMAC-SHA256(sessionSecret, authCodePayload))</code></pre>
</div>
</div>
<div id="_tabs_17" class="openblock tabs is-sync is-loading">
<div class="content">
<div class="ulist tablist">
<ul>
<li id="_tabs_17_java" class="tab">
<p>Java</p>
</li>
<li id="_tabs_17_php" class="tab">
<p>PHP</p>
</li>
<li id="_tabs_17_python" class="tab">
<p>Python</p>
</li>
<li id="_tabs_17_go" class="tab">
<p>Go</p>
</li>
<li id="_tabs_17_rust" class="tab">
<p>Rust</p>
</li>
<li id="_tabs_17_kotlin" class="tab">
<p>Kotlin</p>
</li>
<li id="_tabs_17_c" class="tab">
<p>C#</p>
</li>
<li id="_tabs_17_node_js" class="tab">
<p>Node.js</p>
</li>
<li id="_tabs_17_ruby" class="tab">
<p>Ruby</p>
</li>
</ul>
</div>
<div id="_tabs_17_java--panel" class="tabpanel" aria-labelledby="_tabs_17_java">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">import java.nio.charset.StandardCharsets;
import java.util.Base64;

import javax.crypto.Mac;
import javax.crypto.spec.SecretKeySpec;

public class AuthCodeCalculator {

  public static void main(String[] args) throws Exception {
    String sessionSecretBase64 = "B98ODiVCebRedSwdTk51zFSaGYyHtY1H2A0ocAi3/Ps=";

    byte[] sessionSecret = Base64.getDecoder()
      .decode(sessionSecretBase64);

    byte[] authCodePayload = "AtayuRPP3N59wXF8Cijwjt3pQ16knW2L-5VLDTRD_KU"
      .getBytes(StandardCharsets.UTF_8);

    Mac sha256Hmac = Mac.getInstance("HmacSHA256");
    SecretKeySpec secretKey = new SecretKeySpec(sessionSecret, sha256Hmac.getAlgorithm());
    sha256Hmac.init(secretKey);

    byte[] authCodeBytes = sha256Hmac.doFinal(authCodePayload);

    String authCode = Base64.getUrlEncoder()
      .withoutPadding()
      .encodeToString(authCodeBytes);

    System.out.println(authCode);
  }
}</code></pre>
</div>
</div>
</div>
<div id="_tabs_17_php--panel" class="tabpanel" aria-labelledby="_tabs_17_php">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-php hljs" data-lang="php">&lt;?php

$sessionSecretBase64 = 'B98ODiVCebRedSwdTk51zFSaGYyHtY1H2A0ocAi3/Ps=';
$sessionSecret = base64_decode($sessionSecretBase64);

$authCodePayload = 'AtayuRPP3N59wXF8Cijwjt3pQ16knW2L-5VLDTRD_KU';

$authCodeBytes = hash_hmac('sha256', $authCodePayload, $sessionSecret, true);

$authCode = rtrim(strtr(base64_encode($authCodeBytes), '+/', '-_'), '=');

echo $authCode;
?&gt;</code></pre>
</div>
</div>
</div>
<div id="_tabs_17_python--panel" class="tabpanel" aria-labelledby="_tabs_17_python">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">import hmac
import hashlib
import base64

session_secret_base64 = b'B98ODiVCebRedSwdTk51zFSaGYyHtY1H2A0ocAi3/Ps='
session_secret = base64.b64decode(session_secret_base64)

auth_code_payload = b'AtayuRPP3N59wXF8Cijwjt3pQ16knW2L-5VLDTRD_KU'

auth_code_bytes = hmac.new(session_secret, auth_code_payload, hashlib.sha256).digest()

auth_code = base64.urlsafe_b64encode(auth_code_bytes).rstrip(b'=').decode('utf-8')
print(auth_code)</code></pre>
</div>
</div>
</div>
<div id="_tabs_17_go--panel" class="tabpanel" aria-labelledby="_tabs_17_go">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-go hljs" data-lang="go">package main

import (
	"crypto/hmac"
	"crypto/sha256"
	"encoding/base64"
	"fmt"
)

func main() {
	var sessionSecretBase64 = "B98ODiVCebRedSwdTk51zFSaGYyHtY1H2A0ocAi3/Ps="
	var authCodePayload []byte = []byte("AtayuRPP3N59wXF8Cijwjt3pQ16knW2L-5VLDTRD_KU")

	sessionSecret, err := base64.StdEncoding.DecodeString(sessionSecretBase64)
	if err != nil {
		panic(err)
	}

	mac := hmac.New(sha256.New, sessionSecret)
	mac.Write(authCodePayload)
	var authCodeBytes []byte = mac.Sum(nil)

	var authCode string = base64.RawURLEncoding.EncodeToString(authCodeBytes)
	fmt.Printf("%s\n", authCode)
}</code></pre>
</div>
</div>
</div>
<div id="_tabs_17_rust--panel" class="tabpanel" aria-labelledby="_tabs_17_rust">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-rust hljs" data-lang="rust">use hmac::{Hmac, Mac};
use sha2::Sha256;
use base64::{Engine as _, engine::{self, general_purpose}, alphabet};

fn main() {
    let session_secret_base64 = "B98ODiVCebRedSwdTk51zFSaGYyHtY1H2A0ocAi3/Ps=";
    let session_secret: &amp;[u8] = &amp;base64::engine::general_purpose::STANDARD.decode(session_secret_base64).unwrap();

    let auth_code_payload: &amp;[u8] = &amp;b"AtayuRPP3N59wXF8Cijwjt3pQ16knW2L-5VLDTRD_KU"[..];

    let mut mac = Hmac::&lt;Sha256&gt;::new_from_slice(session_secret).expect("HMAC can take key of any size");
    mac.update(auth_code_payload);

    let auth_code_bytes = mac.finalize().into_bytes();

    const CUSTOM_ENGINE: engine::GeneralPurpose = base64::engine::GeneralPurpose::new(&amp;alphabet::URL_SAFE, general_purpose::NO_PAD);
    let auth_code: String = CUSTOM_ENGINE.encode(auth_code_bytes);
    println!("{}", auth_code)
}</code></pre>
</div>
</div>
</div>
<div id="_tabs_17_kotlin--panel" class="tabpanel" aria-labelledby="_tabs_17_kotlin">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">import javax.crypto.Mac;
import javax.crypto.spec.SecretKeySpec;
import java.nio.charset.StandardCharsets
import java.util.Base64

fun main() {
  val sessionSecretBase64: String = "B98ODiVCebRedSwdTk51zFSaGYyHtY1H2A0ocAi3/Ps="
  val sessionSecret: ByteArray = Base64.getDecoder()
    .decode(sessionSecretBase64)

  val authCodePayload: ByteArray = "AtayuRPP3N59wXF8Cijwjt3pQ16knW2L-5VLDTRD_KU"
    .toByteArray(StandardCharsets.UTF_8)

  val hmac: Mac = Mac.getInstance("HmacSHA256")
  val secretKey: SecretKey = SecretKeySpec(sessionSecret, hmac.algorithm)
  hmac.init(secretKey)

  val authCodeBytes: ByteArray = hmac.doFinal(authCodePayload)

  val authCode: String = Base64.getUrlEncoder()
    .withoutPadding()
    .encodeToString(authCodeBytes)

  println(authCode)
}</code></pre>
</div>
</div>
</div>
<div id="_tabs_17_c--panel" class="tabpanel" aria-labelledby="_tabs_17_c">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-cs hljs" data-lang="cs">using System;
using System.Text;
using System.Security.Cryptography;

public class AuthCodeCalculator
{
    public static void Main(string[] args)
    {
        string sessionSecretBase64 = "B98ODiVCebRedSwdTk51zFSaGYyHtY1H2A0ocAi3/Ps=";
        byte[] sessionSecret = Convert.FromBase64String(sessionSecretBase64);
        byte[] authCodePayload = Encoding.UTF8.GetBytes("AtayuRPP3N59wXF8Cijwjt3pQ16knW2L-5VLDTRD_KU");

        HMACSHA256 hmac = new HMACSHA256(sessionSecret);
        byte[] authCodeBytes = hmac.ComputeHash(authCodePayload);
        string authCode = Convert.ToBase64String(authCodeBytes)
            .Replace('+', '-')
            .Replace('/', '_')
            .TrimEnd('=');

        Console.WriteLine(authCode);
    }
}</code></pre>
</div>
</div>
</div>
<div id="_tabs_17_node_js--panel" class="tabpanel" aria-labelledby="_tabs_17_node_js">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-js hljs" data-lang="js">const crypto = require('crypto');

const sessionSecretBase64 = 'B98ODiVCebRedSwdTk51zFSaGYyHtY1H2A0ocAi3/Ps=';
const sessionSecret = Buffer.from(sessionSecretBase64, 'base64');

const authCodePayload = 'AtayuRPP3N59wXF8Cijwjt3pQ16knW2L-5VLDTRD_KU';

const hmac = crypto.createHmac('sha256', sessionSecret);
hmac.update(authCodePayload);

const authCode = hmac.digest('base64url')
    .replace(/=+$/, '');

console.log(authCode);</code></pre>
</div>
</div>
</div>
<div id="_tabs_17_ruby--panel" class="tabpanel" aria-labelledby="_tabs_17_ruby">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby">require 'base64'
require 'openssl'

session_secret_base64 = 'B98ODiVCebRedSwdTk51zFSaGYyHtY1H2A0ocAi3/Ps='
session_secret = Base64.decode64(session_secret_base64)

auth_code_payload = 'AtayuRPP3N59wXF8Cijwjt3pQ16knW2L-5VLDTRD_KU'

hmac = OpenSSL::HMAC.digest(
  'sha256', session_secret, auth_code_payload
)
auth_code = Base64.urlsafe_encode64(hmac).sub(/=*$/, '')

puts auth_code</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="exampleblock">
<div class="title">Example 6. <code>authCode</code> parameter</div>
<div class="content">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">AtayuRPP3N59wXF8Cijwjt3pQ16knW2L-5VLDTRD_KU</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="_tabs_1_qr--panel" class="tabpanel" aria-labelledby="_tabs_1_qr">
<div class="openblock">
<div class="content">
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="title">IMPORTANT</div>
<div class="paragraph">
<p>If QR flow is used, the <code>initialCallbackUrl</code> is empty and the field <strong>must</strong> be included as an empty byte array.</p>
</div>
</td>
</tr>
</table>
</div>
<div id="_tabs_18" class="openblock tabs is-sync is-loading">
<div class="content">
<div class="ulist tablist">
<ul>
<li id="_tabs_18_authentication_session" class="tab">
<p>Authentication Session</p>
</li>
<li id="_tabs_18_signature_session" class="tab">
<p>Signature Session</p>
</li>
<li id="_tabs_18_certificate_choice_session" class="tab">
<p>Certificate-choice Session</p>
</li>
</ul>
</div>
<div id="_tabs_18_authentication_session--panel" class="tabpanel" aria-labelledby="_tabs_18_authentication_session">
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>For authentication session device links <code>signatureProtocol</code> value is <code>ACSP_V2</code>:</p>
</div>
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">authCodePayload := UTF8-ENCODE(STR-CONCAT(
        'smart-id', '|',
        'ACSP_V2', '|',
        rpChallenge, '|',
        BASE64-ENCODE(relyingPartyName), '|',
        BASE64-ENCODE(brokeredRpName), '|',
        interactions, '|',
        '', '|',
        unprotectedDeviceLink))</code></pre>
</div>
</div>
<div id="_tabs_19" class="openblock tabs is-sync is-loading">
<div class="content">
<div class="ulist tablist">
<ul>
<li id="_tabs_19_java" class="tab">
<p>Java</p>
</li>
<li id="_tabs_19_php" class="tab">
<p>PHP</p>
</li>
<li id="_tabs_19_python" class="tab">
<p>Python</p>
</li>
<li id="_tabs_19_go" class="tab">
<p>Go</p>
</li>
<li id="_tabs_19_rust" class="tab">
<p>Rust</p>
</li>
<li id="_tabs_19_kotlin" class="tab">
<p>Kotlin</p>
</li>
<li id="_tabs_19_c" class="tab">
<p>C#</p>
</li>
<li id="_tabs_19_node_js" class="tab">
<p>Node.js</p>
</li>
<li id="_tabs_19_ruby" class="tab">
<p>Ruby</p>
</li>
</ul>
</div>
<div id="_tabs_19_java--panel" class="tabpanel" aria-labelledby="_tabs_19_java">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public class AuthCodePayload {

  public static void main(String[] args) throws Exception {
    String separator = "|";
    String schemeName = "smart-id";
    String signatureProtocol = "ACSP_V2";
    String rpChallenge = "GYS+yoah6emAcVDNIajwSs6UB/M95XrDxMzXBUkwQJ9YFDipXXzGpPc7raWcuc2+TEoRc7WvIZ/7dU/iRXenYg==";
    String relyingPartyNameBase64 = "REVNTw==";
    String brokeredRpNameBase64 = "RXhhbXBsZSBSUA==";
    String interactions = "W3sidHlwZSI6ImNvbmZpcm1hdGlvbk1lc3NhZ2UiLCJkaXNwbGF5VGV4dDIwMCI6IkxvbmdlciBkZXNjcmlwdGlvbiBvZiB0aGUgdHJhbnNhY3Rpb24gY29udGV4dCJ9LHsidHlwZSI6ImRpc3BsYXlUZXh0QW5kUElOIiwiZGlzcGxheVRleHQ2MCI6IlNob3J0IGRlc2NyaXB0aW9uIG9mIHRoZSB0cmFuc2FjdGlvbiBjb250ZXh0In1d";
    String initialCallbackUrl = "";
    String unprotectedDeviceLink = "https://smart-id.com/device-link?deviceLinkType=QR&amp;elapsedSeconds=22&amp;sessionToken=wGIrqveE6AuGDATZKmR1mtAZ&amp;sessionType=auth&amp;version=1.0&amp;lang=eng";

    String[] payloadParts = {
      schemeName,
      signatureProtocol,
      rpChallenge,
      relyingPartyNameBase64,
      brokeredRpNameBase64,
      interactions,
      initialCallbackUrl,
      unprotectedDeviceLink
    };

    String authCodePayload = String.join(separator, payloadParts);
    System.out.println(authCodePayload);
  }
}</code></pre>
</div>
</div>
</div>
<div id="_tabs_19_php--panel" class="tabpanel" aria-labelledby="_tabs_19_php">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-php hljs" data-lang="php">&lt;?php

$separator = '|';

$schemeName = 'smart-id';
$signatureProtocol = 'ACSP_V2';
$rpChallenge = 'GYS+yoah6emAcVDNIajwSs6UB/M95XrDxMzXBUkwQJ9YFDipXXzGpPc7raWcuc2+TEoRc7WvIZ/7dU/iRXenYg==';
$relyingPartyNameBase64 = 'REVNTw==';
$brokeredRpNameBase64 = 'RXhhbXBsZSBSUA==';
$interactions = 'W3sidHlwZSI6ImNvbmZpcm1hdGlvbk1lc3NhZ2UiLCJkaXNwbGF5VGV4dDIwMCI6IkxvbmdlciBkZXNjcmlwdGlvbiBvZiB0aGUgdHJhbnNhY3Rpb24gY29udGV4dCJ9LHsidHlwZSI6ImRpc3BsYXlUZXh0QW5kUElOIiwiZGlzcGxheVRleHQ2MCI6IlNob3J0IGRlc2NyaXB0aW9uIG9mIHRoZSB0cmFuc2FjdGlvbiBjb250ZXh0In1d';
$initialCallbackUrl = '';
$unprotectedDeviceLink = 'https://smart-id.com/device-link?deviceLinkType=QR&amp;elapsedSeconds=22&amp;sessionToken=wGIrqveE6AuGDATZKmR1mtAZ&amp;sessionType=auth&amp;version=1.0&amp;lang=eng';

$authCodePayload = implode($separator, [
    $schemeName,
    $signatureProtocol,
    $rpChallenge,
    $relyingPartyNameBase64,
    $brokeredRpNameBase64,
    $interactions,
    $initialCallbackUrl,
    $unprotectedDeviceLink
]);

echo $authCodePayload;

?&gt;</code></pre>
</div>
</div>
</div>
<div id="_tabs_19_python--panel" class="tabpanel" aria-labelledby="_tabs_19_python">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">separator = '|'

scheme_name = 'smart-id'
signature_protocol = 'ACSP_V2'
rp_challenge = 'GYS+yoah6emAcVDNIajwSs6UB/M95XrDxMzXBUkwQJ9YFDipXXzGpPc7raWcuc2+TEoRc7WvIZ/7dU/iRXenYg=='
relying_party_name_base64 = 'REVNTw=='
brokered_rp_name_base64 = 'RXhhbXBsZSBSUA=='
interactions = 'W3sidHlwZSI6ImNvbmZpcm1hdGlvbk1lc3NhZ2UiLCJkaXNwbGF5VGV4dDIwMCI6IkxvbmdlciBkZXNjcmlwdGlvbiBvZiB0aGUgdHJhbnNhY3Rpb24gY29udGV4dCJ9LHsidHlwZSI6ImRpc3BsYXlUZXh0QW5kUElOIiwiZGlzcGxheVRleHQ2MCI6IlNob3J0IGRlc2NyaXB0aW9uIG9mIHRoZSB0cmFuc2FjdGlvbiBjb250ZXh0In1d'
initial_callback_url = ''
unprotected_device_link = 'https://smart-id.com/device-link?deviceLinkType=QR&amp;elapsedSeconds=22&amp;sessionToken=wGIrqveE6AuGDATZKmR1mtAZ&amp;sessionType=auth&amp;version=1.0&amp;lang=eng'

auth_code_payload = separator.join([
    scheme_name,
    signature_protocol,
    rp_challenge,
    relying_party_name_base64,
    brokered_rp_name_base64,
    interactions,
    initial_callback_url,
    unprotected_device_link
])

print(auth_code_payload)</code></pre>
</div>
</div>
</div>
<div id="_tabs_19_go--panel" class="tabpanel" aria-labelledby="_tabs_19_go">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-go hljs" data-lang="go">package main

import (
	"fmt"
)

func main() {
	var separator string = "|"

	var schemeName string = "smart-id"
	var signatureProtocol string = "ACSP_V2"
	var rpChallenge string = "GYS+yoah6emAcVDNIajwSs6UB/M95XrDxMzXBUkwQJ9YFDipXXzGpPc7raWcuc2+TEoRc7WvIZ/7dU/iRXenYg=="
	var relyingPartyNameBase64 string = "REVNTw=="
	var brokeredRpNameBase64 string = "RXhhbXBsZSBSUA=="
	var interactions string = "W3sidHlwZSI6ImNvbmZpcm1hdGlvbk1lc3NhZ2UiLCJkaXNwbGF5VGV4dDIwMCI6IkxvbmdlciBkZXNjcmlwdGlvbiBvZiB0aGUgdHJhbnNhY3Rpb24gY29udGV4dCJ9LHsidHlwZSI6ImRpc3BsYXlUZXh0QW5kUElOIiwiZGlzcGxheVRleHQ2MCI6IlNob3J0IGRlc2NyaXB0aW9uIG9mIHRoZSB0cmFuc2FjdGlvbiBjb250ZXh0In1d"
	var initialCallbackUrl string = ""
	var unprotectedDeviceLink string = "https://smart-id.com/device-link?deviceLinkType=QR&amp;elapsedSeconds=22&amp;sessionToken=wGIrqveE6AuGDATZKmR1mtAZ&amp;sessionType=auth&amp;version=1.0&amp;lang=eng"

	var payloadParts = []string{
		schemeName,
		signatureProtocol,
		rpChallenge,
		relyingPartyNameBase64,
		brokeredRpNameBase64,
		interactions,
		initialCallbackUrl,
		unprotectedDeviceLink,
	}

	var authCodePayload string = strings.Join(payloadParts, separator)

	fmt.Printf("%q\n", authCodePayload)
}</code></pre>
</div>
</div>
</div>
<div id="_tabs_19_rust--panel" class="tabpanel" aria-labelledby="_tabs_19_rust">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-rust hljs" data-lang="rust">fn main() {
    let separator: &amp;str = "|";
    let scheme_name: &amp;str = "smart-id";
    let signature_protocol: &amp;str = "ACSP_V2";
    let rp_challenge: &amp;str = "GYS+yoah6emAcVDNIajwSs6UB/M95XrDxMzXBUkwQJ9YFDipXXzGpPc7raWcuc2+TEoRc7WvIZ/7dU/iRXenYg==";
    let relying_party_name_base64: &amp;str = "REVNTw==";
    let brokered_rp_name_base64: &amp;str = "RXhhbXBsZSBSUA==";
    let interactions: &amp;str = "W3sidHlwZSI6ImNvbmZpcm1hdGlvbk1lc3NhZ2UiLCJkaXNwbGF5VGV4dDIwMCI6IkxvbmdlciBkZXNjcmlwdGlvbiBvZiB0aGUgdHJhbnNhY3Rpb24gY29udGV4dCJ9LHsidHlwZSI6ImRpc3BsYXlUZXh0QW5kUElOIiwiZGlzcGxheVRleHQ2MCI6IlNob3J0IGRlc2NyaXB0aW9uIG9mIHRoZSB0cmFuc2FjdGlvbiBjb250ZXh0In1d";
    let initial_callback_url: &amp;str = "";
    let unprotected_device_link: &amp;str = "https://smart-id.com/device-link?deviceLinkType=QR&amp;elapsedSeconds=22&amp;sessionToken=wGIrqveE6AuGDATZKmR1mtAZ&amp;sessionType=auth&amp;version=1.0&amp;lang=eng";

    let auth_code_payload_parts: [&str; 7] = [
        scheme_name,
        signature_protocol,
        rp_challenge,
        relying_party_name_base64,
        brokered_rp_name_base64,
        interactions,
        initial_callback_url,
        unprotected_device_link
    ];

    let auth_code_payload: String = auth_code_payload_parts.join(separator);

    println!("{}", auth_code_payload)
}</code></pre>
</div>
</div>
</div>
<div id="_tabs_19_kotlin--panel" class="tabpanel" aria-labelledby="_tabs_19_kotlin">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">fun main() {
    val separator: String = "|"

    val schemeName: String = "smart-id"
    val signatureProtocol: String = "ACSP_V2"
    val rpChallenge: String = "GYS+yoah6emAcVDNIajwSs6UB/M95XrDxMzXBUkwQJ9YFDipXXzGpPc7raWcuc2+TEoRc7WvIZ/7dU/iRXenYg=="
    val relyingPartyNameBase64: String = "REVNTw=="
    val brokeredRpNameBase64: String = "RXhhbXBsZSBSUA=="
    val interactions: String = "W3sidHlwZSI6ImNvbmZpcm1hdGlvbk1lc3NhZ2UiLCJkaXNwbGF5VGV4dDIwMCI6IkxvbmdlciBkZXNjcmlwdGlvbiBvZiB0aGUgdHJhbnNhY3Rpb24gY29udGV4dCJ9LHsidHlwZSI6ImRpc3BsYXlUZXh0QW5kUElOIiwiZGlzcGxheVRleHQ2MCI6IlNob3J0IGRlc2NyaXB0aW9uIG9mIHRoZSB0cmFuc2FjdGlvbiBjb250ZXh0In1d"
    val initialCallbackUrl: String = ""
    val unprotectedDeviceLink: String = "https://smart-id.com/device-link?deviceLinkType=QR&amp;elapsedSeconds=22&amp;sessionToken=wGIrqveE6AuGDATZKmR1mtAZ&amp;sessionType=auth&amp;version=1.0&amp;lang=eng"

    val payloadParts: List&lt;String&gt; = listOf(
        schemeName,
        signatureProtocol,
        rpChallenge,
        relyingPartyNameBase64,
        brokeredRpNameBase64,
        interactions,
        initialCallbackUrl,
        unprotectedDeviceLink
    )

    val authCodePayload: String = payloadParts.joinToString(separator)

    println(authCodePayload)
}</code></pre>
</div>
</div>
</div>
<div id="_tabs_19_c--panel" class="tabpanel" aria-labelledby="_tabs_19_c">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-cs hljs" data-lang="cs">using System;

public class AuthCodePayload
{
    public static void Main()
    {
        string separator = "|";

        string schemeName = "smart-id";
        string signatureProtocol = "ACSP_V2";
        string rpChallenge = "GYS+yoah6emAcVDNIajwSs6UB/M95XrDxMzXBUkwQJ9YFDipXXzGpPc7raWcuc2+TEoRc7WvIZ/7dU/iRXenYg==";
        string relyingPartyNameBase64 = "REVNTw==";
        string brokeredRpNameBase64 = "RXhhbXBsZSBSUA==";
        string interactions = "W3sidHlwZSI6ImNvbmZpcm1hdGlvbk1lc3NhZ2UiLCJkaXNwbGF5VGV4dDIwMCI6IkxvbmdlciBkZXNjcmlwdGlvbiBvZiB0aGUgdHJhbnNhY3Rpb24gY29udGV4dCJ9LHsidHlwZSI6ImRpc3BsYXlUZXh0QW5kUElOIiwiZGlzcGxheVRleHQ2MCI6IlNob3J0IGRlc2NyaXB0aW9uIG9mIHRoZSB0cmFuc2FjdGlvbiBjb250ZXh0In1d";
        string initialCallbackUrl = "";
        string unprotectedDeviceLink = "https://smart-id.com/device-link?deviceLinkType=QR&amp;elapsedSeconds=22&amp;sessionToken=wGIrqveE6AuGDATZKmR1mtAZ&amp;sessionType=auth&amp;version=1.0&amp;lang=eng";

        string[] payloadParts = {
            schemeName,
            signatureProtocol,
            rpChallenge,
            relyingPartyNameBase64,
            brokeredRpNameBase64,
            interactions,
            initialCallbackUrl,
            unprotectedDeviceLink
        };

        string authCodePayload = string.Join(separator, payloadParts);
        Console.WriteLine(authCodePayload);
    }
}</code></pre>
</div>
</div>
</div>
<div id="_tabs_19_node_js--panel" class="tabpanel" aria-labelledby="_tabs_19_node_js">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-js hljs" data-lang="js">const separator = '|';

const schemeName = 'smart-id';
const signatureProtocol = 'ACSP_V2';
const rpChallenge = 'GYS+yoah6emAcVDNIajwSs6UB/M95XrDxMzXBUkwQJ9YFDipXXzGpPc7raWcuc2+TEoRc7WvIZ/7dU/iRXenYg==';
const relyingPartyNameBase64 = 'REVNTw==';
const brokeredRpNameBase64 = 'RXhhbXBsZSBSUA==';
const interactions = 'W3sidHlwZSI6ImNvbmZpcm1hdGlvbk1lc3NhZ2UiLCJkaXNwbGF5VGV4dDIwMCI6IkxvbmdlciBkZXNjcmlwdGlvbiBvZiB0aGUgdHJhbnNhY3Rpb24gY29udGV4dCJ9LHsidHlwZSI6ImRpc3BsYXlUZXh0QW5kUElOIiwiZGlzcGxheVRleHQ2MCI6IlNob3J0IGRlc2NyaXB0aW9uIG9mIHRoZSB0cmFuc2FjdGlvbiBjb250ZXh0In1d';
const initialCallbackUrl = '';
const unprotectedDeviceLink = 'https://smart-id.com/device-link?deviceLinkType=QR&amp;elapsedSeconds=22&amp;sessionToken=wGIrqveE6AuGDATZKmR1mtAZ&amp;sessionType=auth&amp;version=1.0&amp;lang=eng';

const authCodePayload = [
    schemeName,
    signatureProtocol,
    rpChallenge,
    relyingPartyNameBase64,
    brokeredRpNameBase64,
    interactions,
    initialCallbackUrl,
    unprotectedDeviceLink
].join(separator);

console.log(authCodePayload);</code></pre>
</div>
</div>
</div>
<div id="_tabs_19_ruby--panel" class="tabpanel" aria-labelledby="_tabs_19_ruby">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby">separator = '|'

scheme_name = 'smart-id'
signature_protocol = 'ACSP_V2'
rp_challenge = 'GYS+yoah6emAcVDNIajwSs6UB/M95XrDxMzXBUkwQJ9YFDipXXzGpPc7raWcuc2+TEoRc7WvIZ/7dU/iRXenYg=='
relying_party_name_base64 = 'REVNTw=='
brokered_rp_name_base64 = 'RXhhbXBsZSBSUA=='
interactions = 'W3sidHlwZSI6ImNvbmZpcm1hdGlvbk1lc3NhZ2UiLCJkaXNwbGF5VGV4dDIwMCI6IkxvbmdlciBkZXNjcmlwdGlvbiBvZiB0aGUgdHJhbnNhY3Rpb24gY29udGV4dCJ9LHsidHlwZSI6ImRpc3BsYXlUZXh0QW5kUElOIiwiZGlzcGxheVRleHQ2MCI6IlNob3J0IGRlc2NyaXB0aW9uIG9mIHRoZSB0cmFuc2FjdGlvbiBjb250ZXh0In1d'
initial_callback_url = ''
unprotected_device_link = 'https://smart-id.com/device-link?deviceLinkType=QR&amp;elapsedSeconds=22&amp;sessionToken=wGIrqveE6AuGDATZKmR1mtAZ&amp;sessionType=auth&amp;version=1.0&amp;lang=eng'

auth_code_payload = [
    scheme_name,
    signature_protocol,
    rp_challenge,
    relying_party_name_base64,
    brokered_rp_name_base64,
    interactions,
    initial_callback_url,
    unprotected_device_link
].join(separator)

puts auth_code_payload</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="_tabs_18_signature_session--panel" class="tabpanel" aria-labelledby="_tabs_18_signature_session">
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>For signature session device links <code>digest</code> value replaces the <code>rpChallenge</code>, and <code>signatureProtocol</code> value is <code>RAW_DIGEST_SIGNATURE</code>:</p>
</div>
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">authCodePayload := UTF8-ENCODE(STR-CONCAT(
        'smart-id', '|',
        'RAW_DIGEST_SIGNATURE', '|',
        digest, '|',
        BASE64-ENCODE(relyingPartyName), '|',
        BASE64-ENCODE(brokeredRpName), '|',
        interactions, '|',
        '', '|',
        unprotectedDeviceLink))</code></pre>
</div>
</div>
<div id="_tabs_20" class="openblock tabs is-sync is-loading">
<div class="content">
<div class="ulist tablist">
<ul>
<li id="_tabs_20_java" class="tab">
<p>Java</p>
</li>
<li id="_tabs_20_php" class="tab">
<p>PHP</p>
</li>
<li id="_tabs_20_python" class="tab">
<p>Python</p>
</li>
<li id="_tabs_20_go" class="tab">
<p>Go</p>
</li>
<li id="_tabs_20_rust" class="tab">
<p>Rust</p>
</li>
<li id="_tabs_20_kotlin" class="tab">
<p>Kotlin</p>
</li>
<li id="_tabs_20_c" class="tab">
<p>C#</p>
</li>
<li id="_tabs_20_node_js" class="tab">
<p>Node.js</p>
</li>
<li id="_tabs_20_ruby" class="tab">
<p>Ruby</p>
</li>
</ul>
</div>
<div id="_tabs_20_java--panel" class="tabpanel" aria-labelledby="_tabs_20_java">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public class AuthCodePayload {

  public static void main(String[] args) throws Exception {
    String separator = "|";
    String schemeName = "smart-id";
    String signatureProtocol = "RAW_DIGEST_SIGNATURE";
    String digest = "FNZFFya5wGLv9b27fZngaWrOBqle4tGwxZuDFRBdPl1RQvxJsfoqvTbjafd+8BcehMOQGvak6zlP+F8tga4bfQ==";
    String relyingPartyNameBase64 = "REVNTw==";
    String brokeredRpNameBase64 = "RXhhbXBsZSBSUA==";
    String interactions = "W3sidHlwZSI6ImNvbmZpcm1hdGlvbk1lc3NhZ2UiLCJkaXNwbGF5VGV4dDIwMCI6IkxvbmdlciBkZXNjcmlwdGlvbiBvZiB0aGUgdHJhbnNhY3Rpb24gY29udGV4dCJ9LHsidHlwZSI6ImRpc3BsYXlUZXh0QW5kUElOIiwiZGlzcGxheVRleHQ2MCI6IlNob3J0IGRlc2NyaXB0aW9uIG9mIHRoZSB0cmFuc2FjdGlvbiBjb250ZXh0In1d";
    String initialCallbackUrl = "";
    String unprotectedDeviceLink = "https://smart-id.com/device-link?deviceLinkType=QR&amp;elapsedSeconds=22&amp;sessionToken=wGIrqveE6AuGDATZKmR1mtAZ&amp;sessionType=auth&amp;version=1.0&amp;lang=eng";

    String[] payloadParts = {
      schemeName,
      signatureProtocol,
      digest,
      relyingPartyNameBase64,
      brokeredRpNameBase64,
      interactions,
      initialCallbackUrl,
      unprotectedDeviceLink
    };

    String authCodePayload = String.join(separator, payloadParts);
    System.out.println(authCodePayload);
  }
}</code></pre>
</div>
</div>
</div>
<div id="_tabs_20_php--panel" class="tabpanel" aria-labelledby="_tabs_20_php">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-php hljs" data-lang="php">&lt;?php

$separator = '|';

$schemeName = 'smart-id';
$signatureProtocol = 'RAW_DIGEST_SIGNATURE';
$digest = 'FNZFFya5wGLv9b27fZngaWrOBqle4tGwxZuDFRBdPl1RQvxJsfoqvTbjafd+8BcehMOQGvak6zlP+F8tga4bfQ==';
$relyingPartyNameBase64 = 'REVNTw==';
$brokeredRpNameBase64 = 'RXhhbXBsZSBSUA==';
$interactions = 'W3sidHlwZSI6ImNvbmZpcm1hdGlvbk1lc3NhZ2UiLCJkaXNwbGF5VGV4dDIwMCI6IkxvbmdlciBkZXNjcmlwdGlvbiBvZiB0aGUgdHJhbnNhY3Rpb24gY29udGV4dCJ9LHsidHlwZSI6ImRpc3BsYXlUZXh0QW5kUElOIiwiZGlzcGxheVRleHQ2MCI6IlNob3J0IGRlc2NyaXB0aW9uIG9mIHRoZSB0cmFuc2FjdGlvbiBjb250ZXh0In1d';
$initialCallbackUrl = '';
$unprotectedDeviceLink = 'https://smart-id.com/device-link?deviceLinkType=QR&amp;elapsedSeconds=22&amp;sessionToken=wGIrqveE6AuGDATZKmR1mtAZ&amp;sessionType=auth&amp;version=1.0&amp;lang=eng';

$authCodePayload = implode($separator, [
    $schemeName,
    $signatureProtocol,
    $digest,
    $relyingPartyNameBase64,
    $brokeredRpNameBase64,
    $interactions,
    $initialCallbackUrl,
    $unprotectedDeviceLink
]);

echo $authCodePayload;

?&gt;</code></pre>
</div>
</div>
</div>
<div id="_tabs_20_python--panel" class="tabpanel" aria-labelledby="_tabs_20_python">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">separator = '|'

scheme_name = 'smart-id'
signature_protocol = 'RAW_DIGEST_SIGNATURE'
digest = 'FNZFFya5wGLv9b27fZngaWrOBqle4tGwxZuDFRBdPl1RQvxJsfoqvTbjafd+8BcehMOQGvak6zlP+F8tga4bfQ=='
relying_party_name_base64 = 'REVNTw=='
brokered_rp_name_base64 = 'RXhhbXBsZSBSUA=='
interactions = 'W3sidHlwZSI6ImNvbmZpcm1hdGlvbk1lc3NhZ2UiLCJkaXNwbGF5VGV4dDIwMCI6IkxvbmdlciBkZXNjcmlwdGlvbiBvZiB0aGUgdHJhbnNhY3Rpb24gY29udGV4dCJ9LHsidHlwZSI6ImRpc3BsYXlUZXh0QW5kUElOIiwiZGlzcGxheVRleHQ2MCI6IlNob3J0IGRlc2NyaXB0aW9uIG9mIHRoZSB0cmFuc2FjdGlvbiBjb250ZXh0In1d'
initial_callback_url = ''
unprotected_device_link = 'https://smart-id.com/device-link?deviceLinkType=QR&amp;elapsedSeconds=22&amp;sessionToken=wGIrqveE6AuGDATZKmR1mtAZ&amp;sessionType=auth&amp;version=1.0&amp;lang=eng'

auth_code_payload = separator.join([
    scheme_name,
    signature_protocol,
    digest,
    relying_party_name_base64,
    brokered_rp_name_base64,
    interactions,
    initial_callback_url,
    unprotected_device_link
])

print(auth_code_payload)</code></pre>
</div>
</div>
</div>
<div id="_tabs_20_go--panel" class="tabpanel" aria-labelledby="_tabs_20_go">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-go hljs" data-lang="go">package main

import (
	"fmt"
)

func main() {
	var separator string = "|"

	var schemeName string = "smart-id"
	var signatureProtocol string = "RAW_DIGEST_SIGNATURE"
	var digest string = "FNZFFya5wGLv9b27fZngaWrOBqle4tGwxZuDFRBdPl1RQvxJsfoqvTbjafd+8BcehMOQGvak6zlP+F8tga4bfQ=="
	var relyingPartyNameBase64 string = "REVNTw=="
	var brokeredRpNameBase64 string = "RXhhbXBsZSBSUA=="
	var interactions string = "W3sidHlwZSI6ImNvbmZpcm1hdGlvbk1lc3NhZ2UiLCJkaXNwbGF5VGV4dDIwMCI6IkxvbmdlciBkZXNjcmlwdGlvbiBvZiB0aGUgdHJhbnNhY3Rpb24gY29udGV4dCJ9LHsidHlwZSI6ImRpc3BsYXlUZXh0QW5kUElOIiwiZGlzcGxheVRleHQ2MCI6IlNob3J0IGRlc2NyaXB0aW9uIG9mIHRoZSB0cmFuc2FjdGlvbiBjb250ZXh0In1d"
	var initialCallbackUrl string = ""
	var unprotectedDeviceLink string = "https://smart-id.com/device-link?deviceLinkType=QR&amp;elapsedSeconds=22&amp;sessionToken=wGIrqveE6AuGDATZKmR1mtAZ&amp;sessionType=auth&amp;version=1.0&amp;lang=eng"

	var payloadParts = []string{
		schemeName,
		signatureProtocol,
		digest,
		relyingPartyNameBase64,
		brokeredRpNameBase64,
		interactions,
		initialCallbackUrl,
		unprotectedDeviceLink,
	}

	var authCodePayload string = strings.Join(payloadParts, separator)

	fmt.Printf("%q\n", authCodePayload)
}</code></pre>
</div>
</div>
</div>
<div id="_tabs_20_rust--panel" class="tabpanel" aria-labelledby="_tabs_20_rust">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-rust hljs" data-lang="rust">fn main() {
    let separator: &amp;str = "|";
    let scheme_name: &amp;str = "smart-id";
    let signature_protocol: &amp;str = "RAW_DIGEST_SIGNATURE";
    let digest: &amp;str = "FNZFFya5wGLv9b27fZngaWrOBqle4tGwxZuDFRBdPl1RQvxJsfoqvTbjafd+8BcehMOQGvak6zlP+F8tga4bfQ==";
    let relying_party_name_base64: &amp;str = "REVNTw==";
    let brokered_rp_name_base64: &amp;str = "RXhhbXBsZSBSUA==";
    let interactions: &amp;str = "W3sidHlwZSI6ImNvbmZpcm1hdGlvbk1lc3NhZ2UiLCJkaXNwbGF5VGV4dDIwMCI6IkxvbmdlciBkZXNjcmlwdGlvbiBvZiB0aGUgdHJhbnNhY3Rpb24gY29udGV4dCJ9LHsidHlwZSI6ImRpc3BsYXlUZXh0QW5kUElOIiwiZGlzcGxheVRleHQ2MCI6IlNob3J0IGRlc2NyaXB0aW9uIG9mIHRoZSB0cmFuc2FjdGlvbiBjb250ZXh0In1d";
    let initial_callback_url: &amp;str = "";
    let unprotected_device_link: &amp;str = "https://smart-id.com/device-link?deviceLinkType=QR&amp;elapsedSeconds=22&amp;sessionToken=wGIrqveE6AuGDATZKmR1mtAZ&amp;sessionType=auth&amp;version=1.0&amp;lang=eng";

    let auth_code_payload_parts: [&str; 7] = [
        scheme_name,
        signature_protocol,
        digest,
        relying_party_name_base64,
        brokered_rp_name_base64,
        interactions,
        initial_callback_url,
        unprotected_device_link
    ];

    let auth_code_payload: String = auth_code_payload_parts.join(separator);

    println!("{}", auth_code_payload)
}</code></pre>
</div>
</div>
</div>
<div id="_tabs_20_kotlin--panel" class="tabpanel" aria-labelledby="_tabs_20_kotlin">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">fun main() {
    val separator: String = "|"

    val schemeName: String = "smart-id"
    val signatureProtocol: String = "RAW_DIGEST_SIGNATURE"
    val digest: String = "FNZFFya5wGLv9b27fZngaWrOBqle4tGwxZuDFRBdPl1RQvxJsfoqvTbjafd+8BcehMOQGvak6zlP+F8tga4bfQ=="
    val relyingPartyNameBase64: String = "REVNTw=="
    val brokeredRpNameBase64: String = "RXhhbXBsZSBSUA=="
    val interactions: String = "W3sidHlwZSI6ImNvbmZpcm1hdGlvbk1lc3NhZ2UiLCJkaXNwbGF5VGV4dDIwMCI6IkxvbmdlciBkZXNjcmlwdGlvbiBvZiB0aGUgdHJhbnNhY3Rpb24gY29udGV4dCJ9LHsidHlwZSI6ImRpc3BsYXlUZXh0QW5kUElOIiwiZGlzcGxheVRleHQ2MCI6IlNob3J0IGRlc2NyaXB0aW9uIG9mIHRoZSB0cmFuc2FjdGlvbiBjb250ZXh0In1d"
    val initialCallbackUrl: String = ""
    val unprotectedDeviceLink: String = "https://smart-id.com/device-link?deviceLinkType=QR&amp;elapsedSeconds=22&amp;sessionToken=wGIrqveE6AuGDATZKmR1mtAZ&amp;sessionType=auth&amp;version=1.0&amp;lang=eng"

    val payloadParts: List&lt;String&gt; = listOf(
        schemeName,
        signatureProtocol,
        digest,
        relyingPartyNameBase64,
        brokeredRpNameBase64,
        interactions,
        initialCallbackUrl,
        unprotectedDeviceLink
    )

    val authCodePayload: String = payloadParts.joinToString(separator)

    println(authCodePayload)
}</code></pre>
</div>
</div>
</div>
<div id="_tabs_20_c--panel" class="tabpanel" aria-labelledby="_tabs_20_c">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-cs hljs" data-lang="cs">using System;

public class AuthCodePayload
{
    public static void Main()
    {
        string separator = "|";

        string schemeName = "smart-id";
        string signatureProtocol = "RAW_DIGEST_SIGNATURE";
        string digest = "FNZFFya5wGLv9b27fZngaWrOBqle4tGwxZuDFRBdPl1RQvxJsfoqvTbjafd+8BcehMOQGvak6zlP+F8tga4bfQ==";
        string relyingPartyNameBase64 = "REVNTw==";
        string brokeredRpNameBase64 = "RXhhbXBsZSBSUA==";
        string interactions = "W3sidHlwZSI6ImNvbmZpcm1hdGlvbk1lc3NhZ2UiLCJkaXNwbGF5VGV4dDIwMCI6IkxvbmdlciBkZXNjcmlwdGlvbiBvZiB0aGUgdHJhbnNhY3Rpb24gY29udGV4dCJ9LHsidHlwZSI6ImRpc3BsYXlUZXh0QW5kUElOIiwiZGlzcGxheVRleHQ2MCI6IlNob3J0IGRlc2NyaXB0aW9uIG9mIHRoZSB0cmFuc2FjdGlvbiBjb250ZXh0In1d";
        string initialCallbackUrl = "";
        string unprotectedDeviceLink = "https://smart-id.com/device-link?deviceLinkType=QR&amp;elapsedSeconds=22&amp;sessionToken=wGIrqveE6AuGDATZKmR1mtAZ&amp;sessionType=auth&amp;version=1.0&amp;lang=eng";

        string[] payloadParts = {
            schemeName,
            signatureProtocol,
            digest,
            relyingPartyNameBase64,
            brokeredRpNameBase64,
            interactions,
            initialCallbackUrl,
            unprotectedDeviceLink
        };

        string authCodePayload = string.Join(separator, payloadParts);
        Console.WriteLine(authCodePayload);
    }
}</code></pre>
</div>
</div>
</div>
<div id="_tabs_20_node_js--panel" class="tabpanel" aria-labelledby="_tabs_20_node_js">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-js hljs" data-lang="js">const separator = '|';

const schemeName = 'smart-id';
const signatureProtocol = 'RAW_DIGEST_SIGNATURE';
const digest = 'FNZFFya5wGLv9b27fZngaWrOBqle4tGwxZuDFRBdPl1RQvxJsfoqvTbjafd+8BcehMOQGvak6zlP+F8tga4bfQ==';
const relyingPartyNameBase64 = 'REVNTw==';
const brokeredRpNameBase64 = 'RXhhbXBsZSBSUA==';
const interactions = 'W3sidHlwZSI6ImNvbmZpcm1hdGlvbk1lc3NhZ2UiLCJkaXNwbGF5VGV4dDIwMCI6IkxvbmdlciBkZXNjcmlwdGlvbiBvZiB0aGUgdHJhbnNhY3Rpb24gY29udGV4dCJ9LHsidHlwZSI6ImRpc3BsYXlUZXh0QW5kUElOIiwiZGlzcGxheVRleHQ2MCI6IlNob3J0IGRlc2NyaXB0aW9uIG9mIHRoZSB0cmFuc2FjdGlvbiBjb250ZXh0In1d';
const initialCallbackUrl = '';
const unprotectedDeviceLink = 'https://smart-id.com/device-link?deviceLinkType=QR&amp;elapsedSeconds=22&amp;sessionToken=wGIrqveE6AuGDATZKmR1mtAZ&amp;sessionType=auth&amp;version=1.0&amp;lang=eng';

const authCodePayload = [
    schemeName,
    signatureProtocol,
    digest,
    relyingPartyNameBase64,
    brokeredRpNameBase64,
    interactions,
    initialCallbackUrl,
    unprotectedDeviceLink
].join(separator);

console.log(authCodePayload);</code></pre>
</div>
</div>
</div>
<div id="_tabs_20_ruby--panel" class="tabpanel" aria-labelledby="_tabs_20_ruby">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby">separator = '|'

scheme_name = 'smart-id'
signature_protocol = 'RAW_DIGEST_SIGNATURE'
digest = 'FNZFFya5wGLv9b27fZngaWrOBqle4tGwxZuDFRBdPl1RQvxJsfoqvTbjafd+8BcehMOQGvak6zlP+F8tga4bfQ=='
relying_party_name_base64 = 'REVNTw=='
brokered_rp_name_base64 = 'RXhhbXBsZSBSUA=='
interactions = 'W3sidHlwZSI6ImNvbmZpcm1hdGlvbk1lc3NhZ2UiLCJkaXNwbGF5VGV4dDIwMCI6IkxvbmdlciBkZXNjcmlwdGlvbiBvZiB0aGUgdHJhbnNhY3Rpb24gY29udGV4dCJ9LHsidHlwZSI6ImRpc3BsYXlUZXh0QW5kUElOIiwiZGlzcGxheVRleHQ2MCI6IlNob3J0IGRlc2NyaXB0aW9uIG9mIHRoZSB0cmFuc2FjdGlvbiBjb250ZXh0In1d'
initial_callback_url = ''
unprotected_device_link = 'https://smart-id.com/device-link?deviceLinkType=QR&amp;elapsedSeconds=22&amp;sessionToken=wGIrqveE6AuGDATZKmR1mtAZ&amp;sessionType=auth&amp;version=1.0&amp;lang=eng'

auth_code_payload = [
    scheme_name,
    signature_protocol,
    digest,
    relying_party_name_base64,
    brokered_rp_name_base64,
    interactions,
    initial_callback_url,
    unprotected_device_link
].join(separator)

puts auth_code_payload</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="_tabs_18_certificate_choice_session--panel" class="tabpanel" aria-labelledby="_tabs_18_certificate_choice_session">
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>For certificate-choice session device links, <code>digest</code>, <code>interactions</code> and <code>signatureProtocol</code> values are omitted:</p>
</div>
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">authCodePayload := UTF8-ENCODE(STR-CONCAT(
        'smart-id', '|',
        '', '|',
        '', '|',
        BASE64-ENCODE(relyingPartyName), '|',
        BASE64-ENCODE(brokeredRpName), '|',
        '', '|',
        '', '|',
        unprotectedDeviceLink))</code></pre>
</div>
</div>
<div id="_tabs_21" class="openblock tabs is-sync is-loading">
<div class="content">
<div class="ulist tablist">
<ul>
<li id="_tabs_21_java" class="tab">
<p>Java</p>
</li>
<li id="_tabs_21_php" class="tab">
<p>PHP</p>
</li>
<li id="_tabs_21_python" class="tab">
<p>Python</p>
</li>
<li id="_tabs_21_go" class="tab">
<p>Go</p>
</li>
<li id="_tabs_21_rust" class="tab">
<p>Rust</p>
</li>
<li id="_tabs_21_kotlin" class="tab">
<p>Kotlin</p>
</li>
<li id="_tabs_21_c" class="tab">
<p>C#</p>
</li>
<li id="_tabs_21_node_js" class="tab">
<p>Node.js</p>
</li>
<li id="_tabs_21_ruby" class="tab">
<p>Ruby</p>
</li>
</ul>
</div>
<div id="_tabs_21_java--panel" class="tabpanel" aria-labelledby="_tabs_21_java">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public class AuthCodePayload {

  public static void main(String[] args) throws Exception {
    String separator = "|";
    String schemeName = "smart-id";
    String signatureProtocol = "";
    String digest = "";
    String relyingPartyNameBase64 = "REVNTw==";
    String brokeredRpNameBase64 = "RXhhbXBsZSBSUA==";
    String interactions = "";
    String initialCallbackUrl = "";
    String unprotectedDeviceLink = "https://smart-id.com/device-link?deviceLinkType=QR&amp;elapsedSeconds=22&amp;sessionToken=wGIrqveE6AuGDATZKmR1mtAZ&amp;sessionType=auth&amp;version=1.0&amp;lang=eng";

    String[] payloadParts = {
      schemeName,
      signatureProtocol,
      digest,
      relyingPartyNameBase64,
      brokeredRpNameBase64,
      interactions,
      initialCallbackUrl,
      unprotectedDeviceLink
    };

    String authCodePayload = String.join(separator, payloadParts);
    System.out.println(authCodePayload);
  }
}</code></pre>
</div>
</div>
</div>
<div id="_tabs_21_php--panel" class="tabpanel" aria-labelledby="_tabs_21_php">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-php hljs" data-lang="php">&lt;?php

$separator = '|';

$schemeName = 'smart-id';
$signatureProtocol = '';
$digest = '';
$relyingPartyNameBase64 = 'REVNTw==';
$brokeredRpNameBase64 = 'RXhhbXBsZSBSUA==';
$interactions = '';
$initialCallbackUrl = '';
$unprotectedDeviceLink = 'https://smart-id.com/device-link?deviceLinkType=QR&amp;elapsedSeconds=22&amp;sessionToken=wGIrqveE6AuGDATZKmR1mtAZ&amp;sessionType=auth&amp;version=1.0&amp;lang=eng';

$authCodePayload = implode($separator, [
    $schemeName,
    $signatureProtocol,
    $digest,
    $relyingPartyNameBase64,
    $brokeredRpNameBase64,
    $interactions,
    $initialCallbackUrl,
    $unprotectedDeviceLink
]);

echo $authCodePayload;

?&gt;</code></pre>
</div>
</div>
</div>
<div id="_tabs_21_python--panel" class="tabpanel" aria-labelledby="_tabs_21_python">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">separator = '|'

scheme_name = 'smart-id'
signature_protocol = ''
digest = ''
relying_party_name_base64 = 'REVNTw=='
brokered_rp_name_base64 = 'RXhhbXBsZSBSUA=='
interactions = ''
initial_callback_url = ''
unprotected_device_link = 'https://smart-id.com/device-link?deviceLinkType=QR&amp;elapsedSeconds=22&amp;sessionToken=wGIrqveE6AuGDATZKmR1mtAZ&amp;sessionType=auth&amp;version=1.0&amp;lang=eng'

auth_code_payload = separator.join([
    scheme_name,
    signature_protocol,
    digest,
    relying_party_name_base64,
    brokered_rp_name_base64,
    interactions,
    initial_callback_url,
    unprotected_device_link
])

print(auth_code_payload)</code></pre>
</div>
</div>
</div>
<div id="_tabs_21_go--panel" class="tabpanel" aria-labelledby="_tabs_21_go">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-go hljs" data-lang="go">package main

import (
	"fmt"
)

func main() {
	var separator string = "|"

	var schemeName string = "smart-id"
	var signatureProtocol string = ""
	var digest string = ""
	var relyingPartyNameBase64 string = "REVNTw=="
	var brokeredRpNameBase64 string = "RXhhbXBsZSBSUA=="
	var interactions string = ""
	var initialCallbackUrl string = ""
	var unprotectedDeviceLink string = "https://smart-id.com/device-link?deviceLinkType=QR&amp;elapsedSeconds=22&amp;sessionToken=wGIrqveE6AuGDATZKmR1mtAZ&amp;sessionType=auth&amp;version=1.0&amp;lang=eng"

	var payloadParts = []string{
		schemeName,
		signatureProtocol,
		digest,
		relyingPartyNameBase64,
		brokeredRpNameBase64,
		interactions,
		initialCallbackUrl,
		unprotectedDeviceLink,
	}

	var authCodePayload string = strings.Join(payloadParts, separator)

	fmt.Printf("%q\n", authCodePayload)
}</code></pre>
</div>
</div>
</div>
<div id="_tabs_21_rust--panel" class="tabpanel" aria-labelledby="_tabs_21_rust">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-rust hljs" data-lang="rust">fn main() {
    let separator: &amp;str = "|";
    let scheme_name: &amp;str = "smart-id";
    let signature_protocol: &amp;str = "";
    let digest: &amp;str = "";
    let relying_party_name_base64: &amp;str = "REVNTw==";
    let brokered_rp_name_base64: &amp;str = "RXhhbXBsZSBSUA==";
    let interactions: &amp;str = "";
    let initial_callback_url: &amp;str = "";
    let unprotected_device_link: &amp;str = "https://smart-id.com/device-link?deviceLinkType=QR&amp;elapsedSeconds=22&amp;sessionToken=wGIrqveE6AuGDATZKmR1mtAZ&amp;sessionType=auth&amp;version=1.0&amp;lang=eng";

    let auth_code_payload_parts: [&str; 7] = [
        scheme_name,
        signature_protocol,
        digest,
        relying_party_name_base64,
        brokered_rp_name_base64,
        interactions,
        initial_callback_url,
        unprotected_device_link
    ];

    let auth_code_payload: String = auth_code_payload_parts.join(separator);

    println!("{}", auth_code_payload)
}</code></pre>
</div>
</div>
</div>
<div id="_tabs_21_kotlin--panel" class="tabpanel" aria-labelledby="_tabs_21_kotlin">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">fun main() {
    val separator: String = "|"

    val schemeName: String = "smart-id"
    val signatureProtocol: String = ""
    val digest: String = ""
    val relyingPartyNameBase64: String = "REVNTw=="
    val brokeredRpNameBase64: String = "RXhhbXBsZSBSUA=="
    val interactions: String = ""
    val initialCallbackUrl: String = ""
    val unprotectedDeviceLink: String = "https://smart-id.com/device-link?deviceLinkType=QR&amp;elapsedSeconds=22&amp;sessionToken=wGIrqveE6AuGDATZKmR1mtAZ&amp;sessionType=auth&amp;version=1.0&amp;lang=eng"

    val payloadParts: List&lt;String&gt; = listOf(
        schemeName,
        signatureProtocol,
        digest,
        relyingPartyNameBase64,
        brokeredRpNameBase64,
        interactions,
        initialCallbackUrl,
        unprotectedDeviceLink
    )

    val authCodePayload: String = payloadParts.joinToString(separator)

    println(authCodePayload)
}</code></pre>
</div>
</div>
</div>
<div id="_tabs_21_c--panel" class="tabpanel" aria-labelledby="_tabs_21_c">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-cs hljs" data-lang="cs">using System;

public class AuthCodePayload
{
    public static void Main()
    {
        string separator = "|";

        string schemeName = "smart-id";
        string signatureProtocol = "";
        string digest = "";
        string relyingPartyNameBase64 = "REVNTw==";
        string brokeredRpNameBase64 = "RXhhbXBsZSBSUA==";
        string interactions = "";
        string initialCallbackUrl = "";
        string unprotectedDeviceLink = "https://smart-id.com/device-link?deviceLinkType=QR&amp;elapsedSeconds=22&amp;sessionToken=wGIrqveE6AuGDATZKmR1mtAZ&amp;sessionType=auth&amp;version=1.0&amp;lang=eng";

        string[] payloadParts = {
            schemeName,
            signatureProtocol,
            digest,
            relyingPartyNameBase64,
            brokeredRpNameBase64,
            interactions,
            initialCallbackUrl,
            unprotectedDeviceLink
        };

        string authCodePayload = string.Join(separator, payloadParts);
        Console.WriteLine(authCodePayload);
    }
}</code></pre>
</div>
</div>
</div>
<div id="_tabs_21_node_js--panel" class="tabpanel" aria-labelledby="_tabs_21_node_js">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-js hljs" data-lang="js">const separator = '|';

const schemeName = 'smart-id';
const signatureProtocol = '';
const digest = '';
const relyingPartyNameBase64 = 'REVNTw==';
const brokeredRpNameBase64 = 'RXhhbXBsZSBSUA==';
const interactions = '';
const initialCallbackUrl = '';
const unprotectedDeviceLink = 'https://smart-id.com/device-link?deviceLinkType=QR&amp;elapsedSeconds=22&amp;sessionToken=wGIrqveE6AuGDATZKmR1mtAZ&amp;sessionType=auth&amp;version=1.0&amp;lang=eng';

const authCodePayload = [
    schemeName,
    signatureProtocol,
    digest,
    relyingPartyNameBase64,
    brokeredRpNameBase64,
    interactions,
    initialCallbackUrl,
    unprotectedDeviceLink
].join(separator);

console.log(authCodePayload);</code></pre>
</div>
</div>
</div>
<div id="_tabs_21_ruby--panel" class="tabpanel" aria-labelledby="_tabs_21_ruby">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby">separator = '|'

scheme_name = 'smart-id'
signature_protocol = ''
digest = ''
relying_party_name_base64 = 'REVNTw=='
brokered_rp_name_base64 = 'RXhhbXBsZSBSUA=='
interactions = ''
initial_callback_url = ''
unprotected_device_link = 'https://smart-id.com/device-link?deviceLinkType=QR&amp;elapsedSeconds=22&amp;sessionToken=wGIrqveE6AuGDATZKmR1mtAZ&amp;sessionType=auth&amp;version=1.0&amp;lang=eng'

auth_code_payload = [
    scheme_name,
    signature_protocol,
    digest,
    relying_party_name_base64,
    brokered_rp_name_base64,
    interactions,
    initial_callback_url,
    unprotected_device_link
].join(separator)

puts auth_code_payload</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>After the RP assembles the <code>authCodePayload</code>, <code>authCode</code> can be calculated as follows:</p>
</div>
<div id="_tabs_22" class="openblock tabs is-sync is-loading">
<div class="content">
<div class="ulist tablist">
<ul>
<li id="_tabs_22_authentication_session" class="tab">
<p>Authentication Session</p>
</li>
<li id="_tabs_22_signature_session" class="tab">
<p>Signature Session</p>
</li>
<li id="_tabs_22_certificate_choice_session" class="tab">
<p>Certificate-choice Session</p>
</li>
</ul>
</div>
<div id="_tabs_22_authentication_session--panel" class="tabpanel" aria-labelledby="_tabs_22_authentication_session">
<div class="openblock">
<div class="content">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">authCode := BASE64URL-ENCODE(HMAC-SHA256(sessionSecret, authCodePayload))</code></pre>
</div>
</div>
<div id="_tabs_23" class="openblock tabs is-sync is-loading">
<div class="content">
<div class="ulist tablist">
<ul>
<li id="_tabs_23_java" class="tab">
<p>Java</p>
</li>
<li id="_tabs_23_php" class="tab">
<p>PHP</p>
</li>
<li id="_tabs_23_python" class="tab">
<p>Python</p>
</li>
<li id="_tabs_23_go" class="tab">
<p>Go</p>
</li>
<li id="_tabs_23_rust" class="tab">
<p>Rust</p>
</li>
<li id="_tabs_23_kotlin" class="tab">
<p>Kotlin</p>
</li>
<li id="_tabs_23_c" class="tab">
<p>C#</p>
</li>
<li id="_tabs_23_node_js" class="tab">
<p>Node.js</p>
</li>
<li id="_tabs_23_ruby" class="tab">
<p>Ruby</p>
</li>
</ul>
</div>
<div id="_tabs_23_java--panel" class="tabpanel" aria-labelledby="_tabs_23_java">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">import java.nio.charset.StandardCharsets;
import java.util.Base64;

import javax.crypto.Mac;
import javax.crypto.spec.SecretKeySpec;

public class AuthCodeCalculator {

  public static void main(String[] args) throws Exception {
    String sessionSecretBase64 = "B98ODiVCebRedSwdTk51zFSaGYyHtY1H2A0ocAi3/Ps=";

    byte[] sessionSecret = Base64.getDecoder()
      .decode(sessionSecretBase64);

    byte[] authCodePayload = "OY1eHaD4UYedrBwtqUbSkpa0w7ttm4FllPkCD_3wlE0"
      .getBytes(StandardCharsets.UTF_8);

    Mac sha256Hmac = Mac.getInstance("HmacSHA256");
    SecretKeySpec secretKey = new SecretKeySpec(sessionSecret, sha256Hmac.getAlgorithm());
    sha256Hmac.init(secretKey);

    byte[] authCodeBytes = sha256Hmac.doFinal(authCodePayload);

    String authCode = Base64.getUrlEncoder()
      .withoutPadding()
      .encodeToString(authCodeBytes);

    System.out.println(authCode);
  }
}</code></pre>
</div>
</div>
</div>
<div id="_tabs_23_php--panel" class="tabpanel" aria-labelledby="_tabs_23_php">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-php hljs" data-lang="php">&lt;?php

$sessionSecretBase64 = 'B98ODiVCebRedSwdTk51zFSaGYyHtY1H2A0ocAi3/Ps=';
$sessionSecret = base64_decode($sessionSecretBase64);

$authCodePayload = 'OY1eHaD4UYedrBwtqUbSkpa0w7ttm4FllPkCD_3wlE0';

$authCodeBytes = hash_hmac('sha256', $authCodePayload, $sessionSecret, true);

$authCode = rtrim(strtr(base64_encode($authCodeBytes), '+/', '-_'), '=');

echo $authCode;
?&gt;</code></pre>
</div>
</div>
</div>
<div id="_tabs_23_python--panel" class="tabpanel" aria-labelledby="_tabs_23_python">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">import hmac
import hashlib
import base64

session_secret_base64 = b'B98ODiVCebRedSwdTk51zFSaGYyHtY1H2A0ocAi3/Ps='
session_secret = base64.b64decode(session_secret_base64)

auth_code_payload = b'OY1eHaD4UYedrBwtqUbSkpa0w7ttm4FllPkCD_3wlE0'

auth_code_bytes = hmac.new(session_secret, auth_code_payload, hashlib.sha256).digest()

auth_code = base64.urlsafe_b64encode(auth_code_bytes).rstrip(b'=').decode('utf-8')
print(auth_code)</code></pre>
</div>
</div>
</div>
<div id="_tabs_23_go--panel" class="tabpanel" aria-labelledby="_tabs_23_go">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-go hljs" data-lang="go">package main

import (
	"crypto/hmac"
	"crypto/sha256"
	"encoding/base64"
	"fmt"
)

func main() {
	var sessionSecretBase64 = "B98ODiVCebRedSwdTk51zFSaGYyHtY1H2A0ocAi3/Ps="
	var authCodePayload []byte = []byte("OY1eHaD4UYedrBwtqUbSkpa0w7ttm4FllPkCD_3wlE0")

	sessionSecret, err := base64.StdEncoding.DecodeString(sessionSecretBase64)
	if err != nil {
		panic(err)
	}

	mac := hmac.New(sha256.New, sessionSecret)
	mac.Write(authCodePayload)
	var authCodeBytes []byte = mac.Sum(nil)

	var authCode string = base64.RawURLEncoding.EncodeToString(authCodeBytes)
	fmt.Printf("%s\n", authCode)
}</code></pre>
</div>
</div>
</div>
<div id="_tabs_23_rust--panel" class="tabpanel" aria-labelledby="_tabs_23_rust">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-rust hljs" data-lang="rust">use hmac::{Hmac, Mac};
use sha2::Sha256;
use base64::{Engine as _, engine::{self, general_purpose}, alphabet};

fn main() {
    let session_secret_base64 = "B98ODiVCebRedSwdTk51zFSaGYyHtY1H2A0ocAi3/Ps=";
    let session_secret: &amp;[u8] = &amp;base64::engine::general_purpose::STANDARD.decode(session_secret_base64).unwrap();

    let auth_code_payload: &amp;[u8] = &amp;b"OY1eHaD4UYedrBwtqUbSkpa0w7ttm4FllPkCD_3wlE0"[..];

    let mut mac = Hmac::&lt;Sha256&gt;::new_from_slice(session_secret).expect("HMAC can take key of any size");
    mac.update(auth_code_payload);

    let auth_code_bytes = mac.finalize().into_bytes();

    const CUSTOM_ENGINE: engine::GeneralPurpose = base64::engine::GeneralPurpose::new(&amp;alphabet::URL_SAFE, general_purpose::NO_PAD);
    let auth_code: String = CUSTOM_ENGINE.encode(auth_code_bytes);
    println!("{}", auth_code)
}</code></pre>
</div>
</div>
</div>
<div id="_tabs_23_kotlin--panel" class="tabpanel" aria-labelledby="_tabs_23_kotlin">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">import javax.crypto.Mac;
import javax.crypto.spec.SecretKeySpec;
import java.nio.charset.StandardCharsets
import java.util.Base64

fun main() {
  val sessionSecretBase64: String = "B98ODiVCebRedSwdTk51zFSaGYyHtY1H2A0ocAi3/Ps="
  val sessionSecret: ByteArray = Base64.getDecoder()
    .decode(sessionSecretBase64)

  val authCodePayload: ByteArray = "OY1eHaD4UYedrBwtqUbSkpa0w7ttm4FllPkCD_3wlE0"
    .toByteArray(StandardCharsets.UTF_8)

  val hmac: Mac = Mac.getInstance("HmacSHA256")
  val secretKey: SecretKey = SecretKeySpec(sessionSecret, hmac.algorithm)
  hmac.init(secretKey)

  val authCodeBytes: ByteArray = hmac.doFinal(authCodePayload)

  val authCode: String = Base64.getUrlEncoder()
    .withoutPadding()
    .encodeToString(authCodeBytes)

  println(authCode)
}</code></pre>
</div>
</div>
</div>
<div id="_tabs_23_c--panel" class="tabpanel" aria-labelledby="_tabs_23_c">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-cs hljs" data-lang="cs">using System;
using System.Text;
using System.Security.Cryptography;

public class AuthCodeCalculator
{
    public static void Main(string[] args)
    {
        string sessionSecretBase64 = "B98ODiVCebRedSwdTk51zFSaGYyHtY1H2A0ocAi3/Ps=";
        byte[] sessionSecret = Convert.FromBase64String(sessionSecretBase64);
        byte[] authCodePayload = Encoding.UTF8.GetBytes("OY1eHaD4UYedrBwtqUbSkpa0w7ttm4FllPkCD_3wlE0");

        HMACSHA256 hmac = new HMACSHA256(sessionSecret);
        byte[] authCodeBytes = hmac.ComputeHash(authCodePayload);
        string authCode = Convert.ToBase64String(authCodeBytes)
            .Replace('+', '-')
            .Replace('/', '_')
            .TrimEnd('=');

        Console.WriteLine(authCode);
    }
}</code></pre>
</div>
</div>
</div>
<div id="_tabs_23_node_js--panel" class="tabpanel" aria-labelledby="_tabs_23_node_js">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-js hljs" data-lang="js">const crypto = require('crypto');

const sessionSecretBase64 = 'B98ODiVCebRedSwdTk51zFSaGYyHtY1H2A0ocAi3/Ps=';
const sessionSecret = Buffer.from(sessionSecretBase64, 'base64');

const authCodePayload = 'OY1eHaD4UYedrBwtqUbSkpa0w7ttm4FllPkCD_3wlE0';

const hmac = crypto.createHmac('sha256', sessionSecret);
hmac.update(authCodePayload);

const authCode = hmac.digest('base64url')
    .replace(/=+$/, '');

console.log(authCode);</code></pre>
</div>
</div>
</div>
<div id="_tabs_23_ruby--panel" class="tabpanel" aria-labelledby="_tabs_23_ruby">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby">require 'base64'
require 'openssl'

session_secret_base64 = 'B98ODiVCebRedSwdTk51zFSaGYyHtY1H2A0ocAi3/Ps='
session_secret = Base64.decode64(session_secret_base64)

auth_code_payload = 'OY1eHaD4UYedrBwtqUbSkpa0w7ttm4FllPkCD_3wlE0'

hmac = OpenSSL::HMAC.digest(
  'sha256', session_secret, auth_code_payload
)
auth_code = Base64.urlsafe_encode64(hmac).sub(/=*$/, '')

puts auth_code</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="exampleblock">
<div class="title">Example 7. <code>authCode</code> parameter</div>
<div class="content">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">OY1eHaD4UYedrBwtqUbSkpa0w7ttm4FllPkCD_3wlE0</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="_tabs_22_signature_session--panel" class="tabpanel" aria-labelledby="_tabs_22_signature_session">
<div class="openblock">
<div class="content">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">authCode := BASE64URL-ENCODE(HMAC-SHA256(sessionSecret, authCodePayload))</code></pre>
</div>
</div>
<div id="_tabs_24" class="openblock tabs is-sync is-loading">
<div class="content">
<div class="ulist tablist">
<ul>
<li id="_tabs_24_java" class="tab">
<p>Java</p>
</li>
<li id="_tabs_24_php" class="tab">
<p>PHP</p>
</li>
<li id="_tabs_24_python" class="tab">
<p>Python</p>
</li>
<li id="_tabs_24_go" class="tab">
<p>Go</p>
</li>
<li id="_tabs_24_rust" class="tab">
<p>Rust</p>
</li>
<li id="_tabs_24_kotlin" class="tab">
<p>Kotlin</p>
</li>
<li id="_tabs_24_c" class="tab">
<p>C#</p>
</li>
<li id="_tabs_24_node_js" class="tab">
<p>Node.js</p>
</li>
<li id="_tabs_24_ruby" class="tab">
<p>Ruby</p>
</li>
</ul>
</div>
<div id="_tabs_24_java--panel" class="tabpanel" aria-labelledby="_tabs_24_java">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">import java.nio.charset.StandardCharsets;
import java.util.Base64;

import javax.crypto.Mac;
import javax.crypto.spec.SecretKeySpec;

public class AuthCodeCalculator {

  public static void main(String[] args) throws Exception {
    String sessionSecretBase64 = "B98ODiVCebRedSwdTk51zFSaGYyHtY1H2A0ocAi3/Ps=";

    byte[] sessionSecret = Base64.getDecoder()
      .decode(sessionSecretBase64);

    byte[] authCodePayload = "5PZVhiNDTnt1MjLz8_YCjnNtR7p0iGevaL2G1ajfMco"
      .getBytes(StandardCharsets.UTF_8);

    Mac sha256Hmac = Mac.getInstance("HmacSHA256");
    SecretKeySpec secretKey = new SecretKeySpec(sessionSecret, sha256Hmac.getAlgorithm());
    sha256Hmac.init(secretKey);

    byte[] authCodeBytes = sha256Hmac.doFinal(authCodePayload);

    String authCode = Base64.getUrlEncoder()
      .withoutPadding()
      .encodeToString(authCodeBytes);

    System.out.println(authCode);
  }
}</code></pre>
</div>
</div>
</div>
<div id="_tabs_24_php--panel" class="tabpanel" aria-labelledby="_tabs_24_php">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-php hljs" data-lang="php">&lt;?php

$sessionSecretBase64 = 'B98ODiVCebRedSwdTk51zFSaGYyHtY1H2A0ocAi3/Ps=';
$sessionSecret = base64_decode($sessionSecretBase64);

$authCodePayload = '5PZVhiNDTnt1MjLz8_YCjnNtR7p0iGevaL2G1ajfMco';

$authCodeBytes = hash_hmac('sha256', $authCodePayload, $sessionSecret, true);

$authCode = rtrim(strtr(base64_encode($authCodeBytes), '+/', '-_'), '=');

echo $authCode;
?&gt;</code></pre>
</div>
</div>
</div>
<div id="_tabs_24_python--panel" class="tabpanel" aria-labelledby="_tabs_24_python">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">import hmac
import hashlib
import base64

session_secret_base64 = b'B98ODiVCebRedSwdTk51zFSaGYyHtY1H2A0ocAi3/Ps='
session_secret = base64.b64decode(session_secret_base64)

auth_code_payload = b'5PZVhiNDTnt1MjLz8_YCjnNtR7p0iGevaL2G1ajfMco'

auth_code_bytes = hmac.new(session_secret, auth_code_payload, hashlib.sha256).digest()

auth_code = base64.urlsafe_b64encode(auth_code_bytes).rstrip(b'=').decode('utf-8')
print(auth_code)</code></pre>
</div>
</div>
</div>
<div id="_tabs_24_go--panel" class="tabpanel" aria-labelledby="_tabs_24_go">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-go hljs" data-lang="go">package main

import (
	"crypto/hmac"
	"crypto/sha256"
	"encoding/base64"
	"fmt"
)

func main() {
	var sessionSecretBase64 = "B98ODiVCebRedSwdTk51zFSaGYyHtY1H2A0ocAi3/Ps="
	var authCodePayload []byte = []byte("5PZVhiNDTnt1MjLz8_YCjnNtR7p0iGevaL2G1ajfMco")

	sessionSecret, err := base64.StdEncoding.DecodeString(sessionSecretBase64)
	if err != nil {
		panic(err)
	}

	mac := hmac.New(sha256.New, sessionSecret)
	mac.Write(authCodePayload)
	var authCodeBytes []byte = mac.Sum(nil)

	var authCode string = base64.RawURLEncoding.EncodeToString(authCodeBytes)
	fmt.Printf("%s\n", authCode)
}</code></pre>
</div>
</div>
</div>
<div id="_tabs_24_rust--panel" class="tabpanel" aria-labelledby="_tabs_24_rust">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-rust hljs" data-lang="rust">use hmac::{Hmac, Mac};
use sha2::Sha256;
use base64::{Engine as _, engine::{self, general_purpose}, alphabet};

fn main() {
    let session_secret_base64 = "B98ODiVCebRedSwdTk51zFSaGYyHtY1H2A0ocAi3/Ps=";
    let session_secret: &amp;[u8] = &amp;base64::engine::general_purpose::STANDARD.decode(session_secret_base64).unwrap();

    let auth_code_payload: &amp;[u8] = &amp;b"5PZVhiNDTnt1MjLz8_YCjnNtR7p0iGevaL2G1ajfMco"[..];

    let mut mac = Hmac::&lt;Sha256&gt;::new_from_slice(session_secret).expect("HMAC can take key of any size");
    mac.update(auth_code_payload);

    let auth_code_bytes = mac.finalize().into_bytes();

    const CUSTOM_ENGINE: engine::GeneralPurpose = base64::engine::GeneralPurpose::new(&amp;alphabet::URL_SAFE, general_purpose::NO_PAD);
    let auth_code: String = CUSTOM_ENGINE.encode(auth_code_bytes);
    println!("{}", auth_code)
}</code></pre>
</div>
</div>
</div>
<div id="_tabs_24_kotlin--panel" class="tabpanel" aria-labelledby="_tabs_24_kotlin">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">import javax.crypto.Mac;
import javax.crypto.spec.SecretKeySpec;
import java.nio.charset.StandardCharsets
import java.util.Base64

fun main() {
  val sessionSecretBase64: String = "B98ODiVCebRedSwdTk51zFSaGYyHtY1H2A0ocAi3/Ps="
  val sessionSecret: ByteArray = Base64.getDecoder()
    .decode(sessionSecretBase64)

  val authCodePayload: ByteArray = "5PZVhiNDTnt1MjLz8_YCjnNtR7p0iGevaL2G1ajfMco"
    .toByteArray(StandardCharsets.UTF_8)

  val hmac: Mac = Mac.getInstance("HmacSHA256")
  val secretKey: SecretKey = SecretKeySpec(sessionSecret, hmac.algorithm)
  hmac.init(secretKey)

  val authCodeBytes: ByteArray = hmac.doFinal(authCodePayload)

  val authCode: String = Base64.getUrlEncoder()
    .withoutPadding()
    .encodeToString(authCodeBytes)

  println(authCode)
}</code></pre>
</div>
</div>
</div>
<div id="_tabs_24_c--panel" class="tabpanel" aria-labelledby="_tabs_24_c">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-cs hljs" data-lang="cs">using System;
using System.Text;
using System.Security.Cryptography;

public class AuthCodeCalculator
{
    public static void Main(string[] args)
    {
        string sessionSecretBase64 = "B98ODiVCebRedSwdTk51zFSaGYyHtY1H2A0ocAi3/Ps=";
        byte[] sessionSecret = Convert.FromBase64String(sessionSecretBase64);
        byte[] authCodePayload = Encoding.UTF8.GetBytes("5PZVhiNDTnt1MjLz8_YCjnNtR7p0iGevaL2G1ajfMco");

        HMACSHA256 hmac = new HMACSHA256(sessionSecret);
        byte[] authCodeBytes = hmac.ComputeHash(authCodePayload);
        string authCode = Convert.ToBase64String(authCodeBytes)
            .Replace('+', '-')
            .Replace('/', '_')
            .TrimEnd('=');

        Console.WriteLine(authCode);
    }
}</code></pre>
</div>
</div>
</div>
<div id="_tabs_24_node_js--panel" class="tabpanel" aria-labelledby="_tabs_24_node_js">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-js hljs" data-lang="js">const crypto = require('crypto');

const sessionSecretBase64 = 'B98ODiVCebRedSwdTk51zFSaGYyHtY1H2A0ocAi3/Ps=';
const sessionSecret = Buffer.from(sessionSecretBase64, 'base64');

const authCodePayload = '5PZVhiNDTnt1MjLz8_YCjnNtR7p0iGevaL2G1ajfMco';

const hmac = crypto.createHmac('sha256', sessionSecret);
hmac.update(authCodePayload);

const authCode = hmac.digest('base64url')
    .replace(/=+$/, '');

console.log(authCode);</code></pre>
</div>
</div>
</div>
<div id="_tabs_24_ruby--panel" class="tabpanel" aria-labelledby="_tabs_24_ruby">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby">require 'base64'
require 'openssl'

session_secret_base64 = 'B98ODiVCebRedSwdTk51zFSaGYyHtY1H2A0ocAi3/Ps='
session_secret = Base64.decode64(session_secret_base64)

auth_code_payload = '5PZVhiNDTnt1MjLz8_YCjnNtR7p0iGevaL2G1ajfMco'

hmac = OpenSSL::HMAC.digest(
  'sha256', session_secret, auth_code_payload
)
auth_code = Base64.urlsafe_encode64(hmac).sub(/=*$/, '')

puts auth_code</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="exampleblock">
<div class="title">Example 8. <code>authCode</code> parameter</div>
<div class="content">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">5PZVhiNDTnt1MjLz8_YCjnNtR7p0iGevaL2G1ajfMco</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="_tabs_22_certificate_choice_session--panel" class="tabpanel" aria-labelledby="_tabs_22_certificate_choice_session">
<div class="openblock">
<div class="content">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">authCode := BASE64URL-ENCODE(HMAC-SHA256(sessionSecret, authCodePayload))</code></pre>
</div>
</div>
<div id="_tabs_25" class="openblock tabs is-sync is-loading">
<div class="content">
<div class="ulist tablist">
<ul>
<li id="_tabs_25_java" class="tab">
<p>Java</p>
</li>
<li id="_tabs_25_php" class="tab">
<p>PHP</p>
</li>
<li id="_tabs_25_python" class="tab">
<p>Python</p>
</li>
<li id="_tabs_25_go" class="tab">
<p>Go</p>
</li>
<li id="_tabs_25_rust" class="tab">
<p>Rust</p>
</li>
<li id="_tabs_25_kotlin" class="tab">
<p>Kotlin</p>
</li>
<li id="_tabs_25_c" class="tab">
<p>C#</p>
</li>
<li id="_tabs_25_node_js" class="tab">
<p>Node.js</p>
</li>
<li id="_tabs_25_ruby" class="tab">
<p>Ruby</p>
</li>
</ul>
</div>
<div id="_tabs_25_java--panel" class="tabpanel" aria-labelledby="_tabs_25_java">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">import java.nio.charset.StandardCharsets;
import java.util.Base64;

import javax.crypto.Mac;
import javax.crypto.spec.SecretKeySpec;

public class AuthCodeCalculator {

  public static void main(String[] args) throws Exception {
    String sessionSecretBase64 = "B98ODiVCebRedSwdTk51zFSaGYyHtY1H2A0ocAi3/Ps=";

    byte[] sessionSecret = Base64.getDecoder()
      .decode(sessionSecretBase64);

    byte[] authCodePayload = "T5pDDPAjoMS0byqS-FoaWVjlubODXoCCF4XDB4HeYNo"
      .getBytes(StandardCharsets.UTF_8);

    Mac sha256Hmac = Mac.getInstance("HmacSHA256");
    SecretKeySpec secretKey = new SecretKeySpec(sessionSecret, sha256Hmac.getAlgorithm());
    sha256Hmac.init(secretKey);

    byte[] authCodeBytes = sha256Hmac.doFinal(authCodePayload);

    String authCode = Base64.getUrlEncoder()
      .withoutPadding()
      .encodeToString(authCodeBytes);

    System.out.println(authCode);
  }
}</code></pre>
</div>
</div>
</div>
<div id="_tabs_25_php--panel" class="tabpanel" aria-labelledby="_tabs_25_php">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-php hljs" data-lang="php">&lt;?php

$sessionSecretBase64 = 'B98ODiVCebRedSwdTk51zFSaGYyHtY1H2A0ocAi3/Ps=';
$sessionSecret = base64_decode($sessionSecretBase64);

$authCodePayload = 'T5pDDPAjoMS0byqS-FoaWVjlubODXoCCF4XDB4HeYNo';

$authCodeBytes = hash_hmac('sha256', $authCodePayload, $sessionSecret, true);

$authCode = rtrim(strtr(base64_encode($authCodeBytes), '+/', '-_'), '=');

echo $authCode;
?&gt;</code></pre>
</div>
</div>
</div>
<div id="_tabs_25_python--panel" class="tabpanel" aria-labelledby="_tabs_25_python">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">import hmac
import hashlib
import base64

session_secret_base64 = b'B98ODiVCebRedSwdTk51zFSaGYyHtY1H2A0ocAi3/Ps='
session_secret = base64.b64decode(session_secret_base64)

auth_code_payload = b'T5pDDPAjoMS0byqS-FoaWVjlubODXoCCF4XDB4HeYNo'

auth_code_bytes = hmac.new(session_secret, auth_code_payload, hashlib.sha256).digest()

auth_code = base64.urlsafe_b64encode(auth_code_bytes).rstrip(b'=').decode('utf-8')
print(auth_code)</code></pre>
</div>
</div>
</div>
<div id="_tabs_25_go--panel" class="tabpanel" aria-labelledby="_tabs_25_go">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-go hljs" data-lang="go">package main

import (
	"crypto/hmac"
	"crypto/sha256"
	"encoding/base64"
	"fmt"
)

func main() {
	var sessionSecretBase64 = "B98ODiVCebRedSwdTk51zFSaGYyHtY1H2A0ocAi3/Ps="
	var authCodePayload []byte = []byte("T5pDDPAjoMS0byqS-FoaWVjlubODXoCCF4XDB4HeYNo")

	sessionSecret, err := base64.StdEncoding.DecodeString(sessionSecretBase64)
	if err != nil {
		panic(err)
	}

	mac := hmac.New(sha256.New, sessionSecret)
	mac.Write(authCodePayload)
	var authCodeBytes []byte = mac.Sum(nil)

	var authCode string = base64.RawURLEncoding.EncodeToString(authCodeBytes)
	fmt.Printf("%s\n", authCode)
}</code></pre>
</div>
</div>
</div>
<div id="_tabs_25_rust--panel" class="tabpanel" aria-labelledby="_tabs_25_rust">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-rust hljs" data-lang="rust">use hmac::{Hmac, Mac};
use sha2::Sha256;
use base64::{Engine as _, engine::{self, general_purpose}, alphabet};

fn main() {
    let session_secret_base64 = "B98ODiVCebRedSwdTk51zFSaGYyHtY1H2A0ocAi3/Ps=";
    let session_secret: &amp;[u8] = &amp;base64::engine::general_purpose::STANDARD.decode(session_secret_base64).unwrap();

    let auth_code_payload: &amp;[u8] = &amp;b"T5pDDPAjoMS0byqS-FoaWVjlubODXoCCF4XDB4HeYNo"[..];

    let mut mac = Hmac::&lt;Sha256&gt;::new_from_slice(session_secret).expect("HMAC can take key of any size");
    mac.update(auth_code_payload);

    let auth_code_bytes = mac.finalize().into_bytes();

    const CUSTOM_ENGINE: engine::GeneralPurpose = base64::engine::GeneralPurpose::new(&amp;alphabet::URL_SAFE, general_purpose::NO_PAD);
    let auth_code: String = CUSTOM_ENGINE.encode(auth_code_bytes);
    println!("{}", auth_code)
}</code></pre>
</div>
</div>
</div>
<div id="_tabs_25_kotlin--panel" class="tabpanel" aria-labelledby="_tabs_25_kotlin">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">import javax.crypto.Mac;
import javax.crypto.spec.SecretKeySpec;
import java.nio.charset.StandardCharsets
import java.util.Base64

fun main() {
  val sessionSecretBase64: String = "B98ODiVCebRedSwdTk51zFSaGYyHtY1H2A0ocAi3/Ps="
  val sessionSecret: ByteArray = Base64.getDecoder()
    .decode(sessionSecretBase64)

  val authCodePayload: ByteArray = "T5pDDPAjoMS0byqS-FoaWVjlubODXoCCF4XDB4HeYNo"
    .toByteArray(StandardCharsets.UTF_8)

  val hmac: Mac = Mac.getInstance("HmacSHA256")
  val secretKey: SecretKey = SecretKeySpec(sessionSecret, hmac.algorithm)
  hmac.init(secretKey)

  val authCodeBytes: ByteArray = hmac.doFinal(authCodePayload)

  val authCode: String = Base64.getUrlEncoder()
    .withoutPadding()
    .encodeToString(authCodeBytes)

  println(authCode)
}</code></pre>
</div>
</div>
</div>
<div id="_tabs_25_c--panel" class="tabpanel" aria-labelledby="_tabs_25_c">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-cs hljs" data-lang="cs">using System;
using System.Text;
using System.Security.Cryptography;

public class AuthCodeCalculator
{
    public static void Main(string[] args)
    {
        string sessionSecretBase64 = "B98ODiVCebRedSwdTk51zFSaGYyHtY1H2A0ocAi3/Ps=";
        byte[] sessionSecret = Convert.FromBase64String(sessionSecretBase64);
        byte[] authCodePayload = Encoding.UTF8.GetBytes("T5pDDPAjoMS0byqS-FoaWVjlubODXoCCF4XDB4HeYNo");

        HMACSHA256 hmac = new HMACSHA256(sessionSecret);
        byte[] authCodeBytes = hmac.ComputeHash(authCodePayload);
        string authCode = Convert.ToBase64String(authCodeBytes)
            .Replace('+', '-')
            .Replace('/', '_')
            .TrimEnd('=');

        Console.WriteLine(authCode);
    }
}</code></pre>
</div>
</div>
</div>
<div id="_tabs_25_node_js--panel" class="tabpanel" aria-labelledby="_tabs_25_node_js">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-js hljs" data-lang="js">const crypto = require('crypto');

const sessionSecretBase64 = 'B98ODiVCebRedSwdTk51zFSaGYyHtY1H2A0ocAi3/Ps=';
const sessionSecret = Buffer.from(sessionSecretBase64, 'base64');

const authCodePayload = 'T5pDDPAjoMS0byqS-FoaWVjlubODXoCCF4XDB4HeYNo';

const hmac = crypto.createHmac('sha256', sessionSecret);
hmac.update(authCodePayload);

const authCode = hmac.digest('base64url')
    .replace(/=+$/, '');

console.log(authCode);</code></pre>
</div>
</div>
</div>
<div id="_tabs_25_ruby--panel" class="tabpanel" aria-labelledby="_tabs_25_ruby">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby">require 'base64'
require 'openssl'

session_secret_base64 = 'B98ODiVCebRedSwdTk51zFSaGYyHtY1H2A0ocAi3/Ps='
session_secret = Base64.decode64(session_secret_base64)

auth_code_payload = 'T5pDDPAjoMS0byqS-FoaWVjlubODXoCCF4XDB4HeYNo'

hmac = OpenSSL::HMAC.digest(
  'sha256', session_secret, auth_code_payload
)
auth_code = Base64.urlsafe_encode64(hmac).sub(/=*$/, '')

puts auth_code</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="exampleblock">
<div class="title">Example 9. <code>authCode</code> parameter</div>
<div class="content">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">T5pDDPAjoMS0byqS-FoaWVjlubODXoCCF4XDB4HeYNo</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_parameters_in_authcode"><a class="anchor" href="#_parameters_in_authcode"></a>Parameters in <code>authCode</code></h3>
<div class="paragraph">
<p>The parameters included in the <code>authCode</code> calculation are explained below:</p>
</div>
<table class="tableblock frame-all grid-none stripes-odd stretch">
<colgroup>
<col style="width: 10%;">
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Formula</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>sessionSecret</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Generated by RP API. Used as the key in <code>authCode</code> calculation. Must be Base64 decoded before use.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>schemeName</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Scheme name is defined by Smart-ID service and it ties the link to the Smart-ID context.
The <code>schemeName</code> value depends on the environment. See <a href="../../environments.html" class="xref page">Environments</a> page for concrete values.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>signatureProtocol</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Allowed values:<br></p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>ACSP_V2</code> - for authentication session,</p>
</li>
<li>
<p><code>RAW_DIGEST_SIGNATURE</code> - for signature session,</p>
</li>
<li>
<p>empty - for certificate-choice session.</p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>rpChallenge</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>rpChallenge</code> used in the initial authentication request. For more details, see <a href="signature_protocols.html#acsp_v2_signature_request_parameters" class="xref page"><code>ACSP_V2</code> signature request parameters</a>.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>digest</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>digest</code> used in the initial signature request. For more details, see <a href="signature_protocols.html#raw_digest_signature_request_parameters" class="xref page"><code>RAW_DIGEST_SIGNATURE</code> signature request parameters</a>.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>relyingPartyName</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>relyingPartyName</code> used in the initial authentication or signature requests in Base64 encoded form.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>brokeredRpName</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>brokeredRpName</code> used in the initial authentication or signature requests in Base64 encoded form. This is only used by those RPs that act as a broker for other RPs. Otherwise <strong>must be empty</strong>.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>interactions</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>interactions</code> used in the initial authentication or signature request in Base64 encoded form. Empty for certificate-choice session request. Since JSON to Base64 encoding is non-deterministic (parameters may be ordered randomly, whitespace can be optional), the specific Base64-encoded string generated from the interactions object to initiate the session must be reused here in order to guarantee that the values match exactly.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>initialCallbackUrl</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Callback URL the Smart-ID app will add parameters to and launch after a successful signature has been given (only in Web2App and App2App flows). Must use <code>HTTPS</code> scheme and there must not be URL fragments (<code>#</code>) in the URL. Must be different URLs in App2App and Web2App flows.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>unprotectedDeviceLink</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The final URL without the <code>authCode</code> field. Including this in <code>authCode</code> calculation ensures that the link itself can&#8217;t be changed by any malicious party.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_sessionsecret_parameter"><a class="anchor" href="#_sessionsecret_parameter"></a><code>sessionSecret</code> parameter</h3>
<div class="paragraph">
<p>RP API returns <code>sessionSecret</code> in Base64 encoded form. The Base64 string value must be decoded into a byte array before use:</p>
</div>
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">sessionSecret := BASE64-DECODE(sessionSecret)</code></pre>
</div>
</div>
<div id="_tabs_26" class="openblock tabs is-sync is-loading">
<div class="content">
<div class="ulist tablist">
<ul>
<li id="_tabs_26_java" class="tab">
<p>Java</p>
</li>
<li id="_tabs_26_php" class="tab">
<p>PHP</p>
</li>
<li id="_tabs_26_python" class="tab">
<p>Python</p>
</li>
<li id="_tabs_26_go" class="tab">
<p>Go</p>
</li>
<li id="_tabs_26_rust" class="tab">
<p>Rust</p>
</li>
<li id="_tabs_26_kotlin" class="tab">
<p>Kotlin</p>
</li>
<li id="_tabs_26_c" class="tab">
<p>C#</p>
</li>
<li id="_tabs_26_node_js" class="tab">
<p>Node.js</p>
</li>
<li id="_tabs_26_ruby" class="tab">
<p>Ruby</p>
</li>
</ul>
</div>
<div id="_tabs_26_java--panel" class="tabpanel" aria-labelledby="_tabs_26_java">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">import java.util.Base64;

public class Base64Decode {

    public static void main(String[] args) {
        String sessionSecretBase64 = "B98ODiVCebRedSwdTk51zFSaGYyHtY1H2A0ocAi3/Ps=";

        byte[] sessionSecretBytes =
        Base64.getDecoder().decode(
            sessionSecretBase64
        );
    }
}</code></pre>
</div>
</div>
</div>
<div id="_tabs_26_php--panel" class="tabpanel" aria-labelledby="_tabs_26_php">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-php hljs" data-lang="php">&lt;?php

$sessionSecretBase64 = "B98ODiVCebRedSwdTk51zFSaGYyHtY1H2A0ocAi3/Ps=";
$sessionSecret = base64_decode($sessionSecretBase64);

?&gt;</code></pre>
</div>
</div>
</div>
<div id="_tabs_26_python--panel" class="tabpanel" aria-labelledby="_tabs_26_python">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">import base64

session_secret_base64 = "B98ODiVCebRedSwdTk51zFSaGYyHtY1H2A0ocAi3/Ps="
session_secret_bytes = base64.b64decode(session_secret_base64)</code></pre>
</div>
</div>
</div>
<div id="_tabs_26_go--panel" class="tabpanel" aria-labelledby="_tabs_26_go">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-go hljs" data-lang="go">package main

import (
	"encoding/base64"
	"fmt"
)

func main() {
	var sessionSecretBase64 string = "B98ODiVCebRedSwdTk51zFSaGYyHtY1H2A0ocAi3/Ps="

	var sessionSecretBytes, err =
		base64.StdEncoding.DecodeString(sessionSecretBase64)
	if err != nil {
		panic(err)
	}

	fmt.Printf("%q\n", sessionSecretBytes)
}</code></pre>
</div>
</div>
</div>
<div id="_tabs_26_rust--panel" class="tabpanel" aria-labelledby="_tabs_26_rust">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-rust hljs" data-lang="rust">use base64::Engine as _;

fn main() {
    let session_secret_base64 = "B98ODiVCebRedSwdTk51zFSaGYyHtY1H2A0ocAi3/Ps=";
    let session_secret_bytes: &amp;[u8] =
      &amp;base64::engine::general_purpose::STANDARD.decode(session_secret_base64).unwrap();
}</code></pre>
</div>
</div>
</div>
<div id="_tabs_26_kotlin--panel" class="tabpanel" aria-labelledby="_tabs_26_kotlin">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">import java.util.Base64

fun main() {
    val sessionSecretBase64: String = "B98ODiVCebRedSwdTk51zFSaGYyHtY1H2A0ocAi3/Ps="
    val sessionSecretBytes: ByteArray =
        Base64.getDecoder().decode(sessionSecretBase64)
}</code></pre>
</div>
</div>
</div>
<div id="_tabs_26_c--panel" class="tabpanel" aria-labelledby="_tabs_26_c">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-cs hljs" data-lang="cs">using System;

public class Base64Decode
{
    public static void Main(string[] args)
    {
        string sessionSecretBase64 = "B98ODiVCebRedSwdTk51zFSaGYyHtY1H2A0ocAi3/Ps=";
        byte[] sessionSecretBytes = Convert.FromBase64String(sessionSecretBase64);
    }
}</code></pre>
</div>
</div>
</div>
<div id="_tabs_26_node_js--panel" class="tabpanel" aria-labelledby="_tabs_26_node_js">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-js hljs" data-lang="js">const sessionSecretBase64 = "B98ODiVCebRedSwdTk51zFSaGYyHtY1H2A0ocAi3/Ps=";
const sessionSecret = Buffer.from(sessionSecretBase64, 'base64');</code></pre>
</div>
</div>
</div>
<div id="_tabs_26_ruby--panel" class="tabpanel" aria-labelledby="_tabs_26_ruby">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby">require 'base64'

session_secret_base64 = "B98ODiVCebRedSwdTk51zFSaGYyHtY1H2A0ocAi3/Ps="
session_secret = Base64.decode64(session_secret_base64)</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="exampleblock">
<div class="title">Example 10. <code>sessionSecret</code> parameter</div>
<div class="content">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">B98ODiVCebRedSwdTk51zFSaGYyHtY1H2A0ocAi3/Ps=</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_schemename_parameter"><a class="anchor" href="#_schemename_parameter"></a><code>schemeName</code> parameter</h3>
<div class="paragraph">
<p>Scheme name that ties the link to the Smart-ID context.
The <code>schemeName</code> value depends on the environment. See <a href="../../environments.html" class="xref page">Environments</a> page for concrete values.</p>
</div>
<div class="exampleblock">
<div class="title">Example 11. <code>schemeName</code> parameter</div>
<div class="content">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">smart-id</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_signatureprotocol_parameter"><a class="anchor" href="#_signatureprotocol_parameter"></a><code>signatureProtocol</code> parameter</h3>
<div class="paragraph">
<p>The same <code>signatureProtocol</code> value that was sent in the initial authentication or signature request. Currently, the only allowed types are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>ACSP_V2</code> for authentication,</p>
</li>
<li>
<p><code>RAW_DIGEST_SIGNATURE</code> for signature requests,</p>
</li>
<li>
<p>empty - for certificate-choice session.</p>
</li>
</ul>
</div>
<div class="exampleblock">
<div class="title">Example 12. <code>signatureProtocol</code> parameter</div>
<div class="content">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">ACSP_V2</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_rpchallenge_or_digest_parameter"><a class="anchor" href="#_rpchallenge_or_digest_parameter"></a><code>rpChallenge</code> or <code>digest</code> parameter</h3>
<div class="paragraph">
<p>The same <code>rpChallenge</code> value or <code>digest</code> value that was sent in the initial authentication or signature request, respectively. This value must be empty for certificate-choice session request.</p>
</div>
<div class="paragraph">
<p><code>rpChallenge</code> and <code>digest</code> parameters are sent to RP API by RPs in Base64 encoded form. They <strong>must</strong> be used in Base64 form.</p>
</div>
<div class="exampleblock">
<div class="title">Example 13. <code>rpChallenge</code> parameter</div>
<div class="content">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">GYS+yoah6emAcVDNIajwSs6UB/M95XrDxMzXBUkwQJ9YFDipXXzGpPc7raWcuc2+TEoRc7WvIZ/7dU/iRXenYg==</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock">
<div class="title">Example 14. <code>digest</code> parameter</div>
<div class="content">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">FNZFFya5wGLv9b27fZngaWrOBqle4tGwxZuDFRBdPl1RQvxJsfoqvTbjafd+8BcehMOQGvak6zlP+F8tga4bfQ==</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_relyingpartyname_parameter"><a class="anchor" href="#_relyingpartyname_parameter"></a><code>relyingPartyName</code> parameter</h3>
<div class="paragraph">
<p>The parameter <code>relyingPartyName</code> describes the RP name as specified in the initial authentication, signature or certificate-choice request.</p>
</div>
<div class="paragraph">
<p>The string value must be <code>UTF-8</code> encoded into a byte array and Base64 encoded before use in <code>authCodePayload</code> assembly:</p>
</div>
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">relyingPartyName := BASE64-ENCODE(UTF8-ENCODE(relyingPartyName))</code></pre>
</div>
</div>
<div id="_tabs_27" class="openblock tabs is-sync is-loading">
<div class="content">
<div class="ulist tablist">
<ul>
<li id="_tabs_27_java" class="tab">
<p>Java</p>
</li>
<li id="_tabs_27_php" class="tab">
<p>PHP</p>
</li>
<li id="_tabs_27_python" class="tab">
<p>Python</p>
</li>
<li id="_tabs_27_go" class="tab">
<p>Go</p>
</li>
<li id="_tabs_27_rust" class="tab">
<p>Rust</p>
</li>
<li id="_tabs_27_kotlin" class="tab">
<p>Kotlin</p>
</li>
<li id="_tabs_27_c" class="tab">
<p>C#</p>
</li>
<li id="_tabs_27_node_js" class="tab">
<p>Node.js</p>
</li>
<li id="_tabs_27_ruby" class="tab">
<p>Ruby</p>
</li>
</ul>
</div>
<div id="_tabs_27_java--panel" class="tabpanel" aria-labelledby="_tabs_27_java">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">import java.nio.charset.StandardCharsets;
import java.util.Base64;

public class Base64Encode {

  public static void main(String[] args) {
    String relyingPartyName = "DEMO";
    String relyingPartyNameBase64 =
      Base64.getEncoder().encodeToString(
        relyingPartyName.getBytes(StandardCharsets.UTF_8)
      );

    System.out.println(relyingPartyNameBase64);
  }
}</code></pre>
</div>
</div>
</div>
<div id="_tabs_27_php--panel" class="tabpanel" aria-labelledby="_tabs_27_php">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-php hljs" data-lang="php">&lt;?php

$relyingPartyName = "DEMO";
$relyingPartyNameBase64 = base64_encode($relyingPartyName);
echo $relyingPartyNameBase64;

?&gt;</code></pre>
</div>
</div>
</div>
<div id="_tabs_27_python--panel" class="tabpanel" aria-labelledby="_tabs_27_python">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">import base64

relying_party_name = "DEMO"
relying_party_name_base64 = base64.b64encode(relying_party_name.encode('utf-8'))
print(relying_party_name_base64)</code></pre>
</div>
</div>
</div>
<div id="_tabs_27_go--panel" class="tabpanel" aria-labelledby="_tabs_27_go">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-go hljs" data-lang="go">package main

import (
	"encoding/base64"
	"fmt"
)

func main() {
	var relyingPartyName string = "DEMO"
	var relyingPartyNameBase64 []byte = []byte(base64.StdEncoding.EncodeToString([]byte(relyingPartyName)))
	fmt.Printf("%q\n", relyingPartyNameBase64)
}</code></pre>
</div>
</div>
</div>
<div id="_tabs_27_rust--panel" class="tabpanel" aria-labelledby="_tabs_27_rust">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-rust hljs" data-lang="rust">use base64::Engine as _;

fn main() {
    let relying_party_name: &amp;str = "DEMO";
    let relying_party_name_base64_string: String = base64::engine::general_purpose::STANDARD.encode(relying_party_name.as_bytes());
    let relying_party_name_base64: &amp;[u8] = relying_party_name_base64_string.as_bytes();
    println!("{:?}\n{}", relying_party_name_base64, relying_party_name_base64_string);
}</code></pre>
</div>
</div>
</div>
<div id="_tabs_27_kotlin--panel" class="tabpanel" aria-labelledby="_tabs_27_kotlin">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">import java.util.Base64

fun main() {
    val relyingPartyName: String = "DEMO"
    val relyingPartyNameBase64: String = Base64.getEncoder()
      .encodeToString(relyingPartyName.toByteArray(Charsets.UTF_8))
    println(relyingPartyNameBase64)
}</code></pre>
</div>
</div>
</div>
<div id="_tabs_27_c--panel" class="tabpanel" aria-labelledby="_tabs_27_c">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-cs hljs" data-lang="cs">using System;
using System.Text;

public class Base64Encode
{
    public static void Main(string[] args)
    {
        string relyingPartyName = "DEMO";
        byte[] relyingPartyNameBytes =
            Encoding.UTF8.GetBytes(relyingPartyName);
        string relyingPartyNameBase64 =
            Convert.ToBase64String(relyingPartyNameBytes);

        Console.WriteLine(relyingPartyNameBase64);
    }
}</code></pre>
</div>
</div>
</div>
<div id="_tabs_27_node_js--panel" class="tabpanel" aria-labelledby="_tabs_27_node_js">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-js hljs" data-lang="js">let relyingPartyName = 'DEMO';
let relyingPartyNameBase64 = Buffer.from(relyingPartyName, 'utf-8')
  .toString('base64');
console.log(relyingPartyNameBase64);</code></pre>
</div>
</div>
</div>
<div id="_tabs_27_ruby--panel" class="tabpanel" aria-labelledby="_tabs_27_ruby">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby">require 'base64'

relying_party_name = "DEMO"
relying_party_name_base64 = Base64.strict_encode64(relying_party_name.encode('UTF-8'))
puts relying_party_name_base64</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="exampleblock">
<div class="title">Example 15. <code>relyingPartyName</code> parameter</div>
<div class="content">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">REVNTw==</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_brokeredrpname_parameter"><a class="anchor" href="#_brokeredrpname_parameter"></a><code>brokeredRpName</code> parameter</h3>
<div class="paragraph">
<p>The parameter <code>brokeredRpName</code> describes the RP name as specified in the initial authentication, signature or certificate-choice request. <strong>Must only be used by RPs that act as a broker and for other RPs otherwise must be empty</strong>.</p>
</div>
<div class="paragraph">
<p>The string value must be <code>UTF-8</code> encoded into a byte array and Base64 encoded before use in <code>authCodePayload</code> assembly:</p>
</div>
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">brokeredRpName := BASE64-ENCODE(UTF8-ENCODE(brokeredRpName))</code></pre>
</div>
</div>
<div id="_tabs_28" class="openblock tabs is-sync is-loading">
<div class="content">
<div class="ulist tablist">
<ul>
<li id="_tabs_28_java" class="tab">
<p>Java</p>
</li>
<li id="_tabs_28_php" class="tab">
<p>PHP</p>
</li>
<li id="_tabs_28_python" class="tab">
<p>Python</p>
</li>
<li id="_tabs_28_go" class="tab">
<p>Go</p>
</li>
<li id="_tabs_28_rust" class="tab">
<p>Rust</p>
</li>
<li id="_tabs_28_kotlin" class="tab">
<p>Kotlin</p>
</li>
<li id="_tabs_28_c" class="tab">
<p>C#</p>
</li>
<li id="_tabs_28_node_js" class="tab">
<p>Node.js</p>
</li>
<li id="_tabs_28_ruby" class="tab">
<p>Ruby</p>
</li>
</ul>
</div>
<div id="_tabs_28_java--panel" class="tabpanel" aria-labelledby="_tabs_28_java">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">import java.nio.charset.StandardCharsets;
import java.util.Base64;

public class Base64Encode {

  public static void main(String[] args) {
    String brokeredRpName = "Example RP";
    String brokeredRpNameBase64 =
      Base64.getEncoder().encodeToString(
        brokeredRpName.getBytes(StandardCharsets.UTF_8)
      );

    System.out.println(brokeredRpNameBase64);
  }
}</code></pre>
</div>
</div>
</div>
<div id="_tabs_28_php--panel" class="tabpanel" aria-labelledby="_tabs_28_php">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-php hljs" data-lang="php">&lt;?php

$brokeredRpName = "Example RP";
$brokeredRpNameBase64 = base64_encode($brokeredRpName);
echo $brokeredRpNameBase64;

?&gt;</code></pre>
</div>
</div>
</div>
<div id="_tabs_28_python--panel" class="tabpanel" aria-labelledby="_tabs_28_python">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">import base64

brokered_rp_name = "Example RP"
brokered_rp_name_base64 = base64.b64encode(brokered_rp_name.encode('utf-8'))
print(brokered_rp_name_base64)</code></pre>
</div>
</div>
</div>
<div id="_tabs_28_go--panel" class="tabpanel" aria-labelledby="_tabs_28_go">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-go hljs" data-lang="go">package main

import (
	"encoding/base64"
	"fmt"
)

func main() {
	var brokeredRpName string = "Example RP"
	var brokeredRpNameBase64 []byte = []byte(base64.StdEncoding.EncodeToString([]byte(brokeredRpName)))
	fmt.Printf("%q\n", brokeredRpNameBase64)
}</code></pre>
</div>
</div>
</div>
<div id="_tabs_28_rust--panel" class="tabpanel" aria-labelledby="_tabs_28_rust">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-rust hljs" data-lang="rust">use base64::Engine as _;

fn main() {
    let brokered_rp_name: &amp;str = "Example RP";
    let brokered_rp_name_base64_string: String = base64::engine::general_purpose::STANDARD.encode(brokered_rp_name.as_bytes());
    let brokered_rp_name_base64: &amp;[u8] = brokered_rp_name_base64_string.as_bytes();
    println!("{:?}\n{}", brokered_rp_name_base64, brokered_rp_name_base64_string);
}</code></pre>
</div>
</div>
</div>
<div id="_tabs_28_kotlin--panel" class="tabpanel" aria-labelledby="_tabs_28_kotlin">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">import java.util.Base64

fun main() {
    val brokeredRpName: String = "Example RP"
    val brokeredRpNameBase64: String = Base64.getEncoder()
      .encodeToString(brokeredRpName.toByteArray(Charsets.UTF_8))
    println(brokeredRpNameBase64)
}</code></pre>
</div>
</div>
</div>
<div id="_tabs_28_c--panel" class="tabpanel" aria-labelledby="_tabs_28_c">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-cs hljs" data-lang="cs">using System;
using System.Text;

public class Base64Encode
{
    public static void Main(string[] args)
    {
        string brokeredRpName = "Example RP";
        byte[] brokeredRpNameBytes =
            Encoding.UTF8.GetBytes(brokeredRpName);
        string brokeredRpNameBase64 =
            Convert.ToBase64String(brokeredRpNameBytes);

        Console.WriteLine(brokeredRpNameBase64);
    }
}</code></pre>
</div>
</div>
</div>
<div id="_tabs_28_node_js--panel" class="tabpanel" aria-labelledby="_tabs_28_node_js">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-js hljs" data-lang="js">let brokeredRpName = 'Example RP';
let brokeredRpNameBase64 = Buffer.from(brokeredRpName, 'utf-8')
  .toString('base64');
console.log(brokeredRpNameBase64);</code></pre>
</div>
</div>
</div>
<div id="_tabs_28_ruby--panel" class="tabpanel" aria-labelledby="_tabs_28_ruby">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby">require 'base64'

brokered_rp_name = "Example RP"
brokered_rp_name_base64 = Base64.strict_encode64(brokered_rp_name.encode('UTF-8'))
puts brokered_rp_name_base64</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="exampleblock">
<div class="title">Example 16. <code>brokeredRpName</code> parameter</div>
<div class="content">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">RXhhbXBsZSBSUA==</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_interactions_parameter"><a class="anchor" href="#_interactions_parameter"></a><code>interactions</code> parameter</h3>
<div class="paragraph">
<p>The parameter <code>interactions</code> as described in <a href="interactions.html" class="xref page">interactions</a> section. Empty for certificate-choice session request.</p>
</div>
<div class="exampleblock">
<div class="title">Example 17. <code>interactions</code> parameter</div>
<div class="content">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">W3sidHlwZSI6ImNvbmZpcm1hdGlvbk1lc3NhZ2UiLCJkaXNwbGF5VGV4dDIwMCI6IkxvbmdlciBkZXNjcmlwdGlvbiBvZiB0aGUgdHJhbnNhY3Rpb24gY29udGV4dCJ9LHsidHlwZSI6ImRpc3BsYXlUZXh0QW5kUElOIiwiZGlzcGxheVRleHQ2MCI6IlNob3J0IGRlc2NyaXB0aW9uIG9mIHRoZSB0cmFuc2FjdGlvbiBjb250ZXh0In1d</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="initialCallbackUrl_parameter"><a class="anchor" href="#initialCallbackUrl_parameter"></a><code>initialCallbackUrl</code> parameter</h3>
<div id="_tabs_29" class="openblock tabs is-sync is-loading">
<div class="content">
<div class="ulist tablist">
<ul>
<li id="_tabs_29_web2app" class="tab">
<p>Web2App</p>
</li>
<li id="_tabs_29_app2app" class="tab">
<p>App2App</p>
</li>
<li id="_tabs_29_qr" class="tab">
<p>QR</p>
</li>
</ul>
</div>
<div id="_tabs_29_web2app--panel" class="tabpanel" aria-labelledby="_tabs_29_web2app">
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>initialCallbackUrl</code> parameter specified by the RP in the initial request. Must use <code>HTTPS</code> scheme. Must not have URL fragments (<code>#</code>). In case of QR flows, must be empty. RPs <strong>must</strong> append a unique parameter to each session in the callback URL to make the URL unpredictable.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="title">TIP</div>
<div class="paragraph">
<p>The Smart-ID app will launch the callback URL after a successful signature has been obtained in Web2App and App2App flows. For verifying the callback URL once the user successfully completes the flow, see <a href="callback_urls.html" class="xref page">Callback URLs</a> page.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The string value must be <code>UTF-8</code> encoded into a byte array before use in <code>authCodePayload</code> assembly:</p>
</div>
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">initialCallbackUrl := UTF8-ENCODE(initialCallbackUrl)</code></pre>
</div>
</div>
<div id="_tabs_30" class="openblock tabs is-sync is-loading">
<div class="content">
<div class="ulist tablist">
<ul>
<li id="_tabs_30_java" class="tab">
<p>Java</p>
</li>
<li id="_tabs_30_php" class="tab">
<p>PHP</p>
</li>
<li id="_tabs_30_python" class="tab">
<p>Python</p>
</li>
<li id="_tabs_30_go" class="tab">
<p>Go</p>
</li>
<li id="_tabs_30_rust" class="tab">
<p>Rust</p>
</li>
<li id="_tabs_30_kotlin" class="tab">
<p>Kotlin</p>
</li>
<li id="_tabs_30_c" class="tab">
<p>C#</p>
</li>
<li id="_tabs_30_node_js" class="tab">
<p>Node.js</p>
</li>
<li id="_tabs_30_ruby" class="tab">
<p>Ruby</p>
</li>
</ul>
</div>
<div id="_tabs_30_java--panel" class="tabpanel" aria-labelledby="_tabs_30_java">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">import java.nio.charset.StandardCharsets;

public class Utf8Encode {

    public static void main(String[] args) {
        String initialCallbackUrl = "https://rp.example.com/callback-url?value=RrKjjT4aggzu27YBddX1bQ";
        byte[] initialCallbackUrlBytes = initialCallbackUrl.getBytes(StandardCharsets.UTF_8);
    }
}</code></pre>
</div>
</div>
</div>
<div id="_tabs_30_php--panel" class="tabpanel" aria-labelledby="_tabs_30_php">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-php hljs" data-lang="php">&lt;?php

$initialCallbackUrl = "https://rp.example.com/callback-url?value=RrKjjT4aggzu27YBddX1bQ";
$initialCallbackUrlBytes = mb_convert_encoding($initialCallbackUrl, 'UTF-8');

?&gt;</code></pre>
</div>
</div>
</div>
<div id="_tabs_30_python--panel" class="tabpanel" aria-labelledby="_tabs_30_python">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">initial_callback_url = "https://rp.example.com/callback-url?value=RrKjjT4aggzu27YBddX1bQ"
initial_callback_url_bytes = initial_callback_url.encode('utf-8')</code></pre>
</div>
</div>
</div>
<div id="_tabs_30_go--panel" class="tabpanel" aria-labelledby="_tabs_30_go">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-go hljs" data-lang="go">package main

import (
	"fmt"
)

func main() {
	var initialCallbackUrl string = "https://rp.example.com/callback-url?value=RrKjjT4aggzu27YBddX1bQ"
	var initialCallbackUrlBytes []byte = []byte(initialCallbackUrl)

	fmt.Printf("%q\n", initialCallbackUrlBytes)
}</code></pre>
</div>
</div>
</div>
<div id="_tabs_30_rust--panel" class="tabpanel" aria-labelledby="_tabs_30_rust">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-rust hljs" data-lang="rust">fn main() {
    let initial_callback_url: &amp;str = "https://rp.example.com/callback-url?value=RrKjjT4aggzu27YBddX1bQ";
    let initial_callback_url_bytes: &amp;[u8] = initial_callback_url.as_bytes();
}</code></pre>
</div>
</div>
</div>
<div id="_tabs_30_kotlin--panel" class="tabpanel" aria-labelledby="_tabs_30_kotlin">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">import java.nio.charset.Charset

fun main() {
  val initialCallbackUrl: String = "https://rp.example.com/callback-url?value=RrKjjT4aggzu27YBddX1bQ"
  val initialCallbackUrlBytes: ByteArray = initialCallbackUrl.toByteArray(Charsets.UTF_8)
}</code></pre>
</div>
</div>
</div>
<div id="_tabs_30_c--panel" class="tabpanel" aria-labelledby="_tabs_30_c">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-cs hljs" data-lang="cs">using System.Text;

public class Utf8Encode
{
    public static void Main()
    {
        string initialCallbackUrl = "https://rp.example.com/callback-url?value=RrKjjT4aggzu27YBddX1bQ";
        byte[] initialCallbackUrlBytes = Encoding.UTF8.GetBytes(initialCallbackUrl);
    }
}</code></pre>
</div>
</div>
</div>
<div id="_tabs_30_node_js--panel" class="tabpanel" aria-labelledby="_tabs_30_node_js">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-js hljs" data-lang="js">let initialCallbackUrl = "https://rp.example.com/callback-url?value=RrKjjT4aggzu27YBddX1bQ";
let initialCallbackUrlBytes = Buffer.from(initialCallbackUrl, 'utf-8');</code></pre>
</div>
</div>
</div>
<div id="_tabs_30_ruby--panel" class="tabpanel" aria-labelledby="_tabs_30_ruby">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby">initial_callback_url = "https://rp.example.com/callback-url?value=RrKjjT4aggzu27YBddX1bQ"
initial_callback_url_bytes = initial_callback_url.encode('UTF-8')</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="exampleblock">
<div class="title">Example 18. <code>initialCallbackUrl</code> parameter</div>
<div class="content">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">https://rp.example.com/callback-url?value=RrKjjT4aggzu27YBddX1bQ</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="_tabs_29_app2app--panel" class="tabpanel" aria-labelledby="_tabs_29_app2app">
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>initialCallbackUrl</code> parameter specified by the RP in the initial request. Must use <code>HTTPS</code> scheme. Must not have URL fragments (<code>#</code>). In case of QR flows, must be empty. RPs <strong>must</strong> append a unique parameter to each session in the callback URL to make the URL unpredictable.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="title">TIP</div>
<div class="paragraph">
<p>The Smart-ID app will launch the callback URL after a successful signature has been obtained in Web2App and App2App flows. For verifying the callback URL once the user successfully completes the flow, see <a href="callback_urls.html" class="xref page">Callback URLs</a> page.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The string value must be <code>UTF-8</code> encoded into a byte array before use in <code>authCodePayload</code> assembly:</p>
</div>
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">initialCallbackUrl := UTF8-ENCODE(initialCallbackUrl)</code></pre>
</div>
</div>
<div id="_tabs_31" class="openblock tabs is-sync is-loading">
<div class="content">
<div class="ulist tablist">
<ul>
<li id="_tabs_31_java" class="tab">
<p>Java</p>
</li>
<li id="_tabs_31_php" class="tab">
<p>PHP</p>
</li>
<li id="_tabs_31_python" class="tab">
<p>Python</p>
</li>
<li id="_tabs_31_go" class="tab">
<p>Go</p>
</li>
<li id="_tabs_31_rust" class="tab">
<p>Rust</p>
</li>
<li id="_tabs_31_kotlin" class="tab">
<p>Kotlin</p>
</li>
<li id="_tabs_31_c" class="tab">
<p>C#</p>
</li>
<li id="_tabs_31_node_js" class="tab">
<p>Node.js</p>
</li>
<li id="_tabs_31_ruby" class="tab">
<p>Ruby</p>
</li>
</ul>
</div>
<div id="_tabs_31_java--panel" class="tabpanel" aria-labelledby="_tabs_31_java">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">import java.nio.charset.StandardCharsets;

public class Utf8Encode {

    public static void main(String[] args) {
        String initialCallbackUrl = "https://rp.example.com/callback-url?value=RrKjjT4aggzu27YBddX1bQ";
        byte[] initialCallbackUrlBytes = initialCallbackUrl.getBytes(StandardCharsets.UTF_8);
    }
}</code></pre>
</div>
</div>
</div>
<div id="_tabs_31_php--panel" class="tabpanel" aria-labelledby="_tabs_31_php">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-php hljs" data-lang="php">&lt;?php

$initialCallbackUrl = "https://rp.example.com/callback-url?value=RrKjjT4aggzu27YBddX1bQ";
$initialCallbackUrlBytes = mb_convert_encoding($initialCallbackUrl, 'UTF-8');

?&gt;</code></pre>
</div>
</div>
</div>
<div id="_tabs_31_python--panel" class="tabpanel" aria-labelledby="_tabs_31_python">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">initial_callback_url = "https://rp.example.com/callback-url?value=RrKjjT4aggzu27YBddX1bQ"
initial_callback_url_bytes = initial_callback_url.encode('utf-8')</code></pre>
</div>
</div>
</div>
<div id="_tabs_31_go--panel" class="tabpanel" aria-labelledby="_tabs_31_go">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-go hljs" data-lang="go">package main

import (
	"fmt"
)

func main() {
	var initialCallbackUrl string = "https://rp.example.com/callback-url?value=RrKjjT4aggzu27YBddX1bQ"
	var initialCallbackUrlBytes []byte = []byte(initialCallbackUrl)

	fmt.Printf("%q\n", initialCallbackUrlBytes)
}</code></pre>
</div>
</div>
</div>
<div id="_tabs_31_rust--panel" class="tabpanel" aria-labelledby="_tabs_31_rust">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-rust hljs" data-lang="rust">fn main() {
    let initial_callback_url: &amp;str = "https://rp.example.com/callback-url?value=RrKjjT4aggzu27YBddX1bQ";
    let initial_callback_url_bytes: &amp;[u8] = initial_callback_url.as_bytes();
}</code></pre>
</div>
</div>
</div>
<div id="_tabs_31_kotlin--panel" class="tabpanel" aria-labelledby="_tabs_31_kotlin">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">import java.nio.charset.Charset

fun main() {
  val initialCallbackUrl: String = "https://rp.example.com/callback-url?value=RrKjjT4aggzu27YBddX1bQ"
  val initialCallbackUrlBytes: ByteArray = initialCallbackUrl.toByteArray(Charsets.UTF_8)
}</code></pre>
</div>
</div>
</div>
<div id="_tabs_31_c--panel" class="tabpanel" aria-labelledby="_tabs_31_c">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-cs hljs" data-lang="cs">using System.Text;

public class Utf8Encode
{
    public static void Main()
    {
        string initialCallbackUrl = "https://rp.example.com/callback-url?value=RrKjjT4aggzu27YBddX1bQ";
        byte[] initialCallbackUrlBytes = Encoding.UTF8.GetBytes(initialCallbackUrl);
    }
}</code></pre>
</div>
</div>
</div>
<div id="_tabs_31_node_js--panel" class="tabpanel" aria-labelledby="_tabs_31_node_js">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-js hljs" data-lang="js">let initialCallbackUrl = "https://rp.example.com/callback-url?value=RrKjjT4aggzu27YBddX1bQ";
let initialCallbackUrlBytes = Buffer.from(initialCallbackUrl, 'utf-8');</code></pre>
</div>
</div>
</div>
<div id="_tabs_31_ruby--panel" class="tabpanel" aria-labelledby="_tabs_31_ruby">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby">initial_callback_url = "https://rp.example.com/callback-url?value=RrKjjT4aggzu27YBddX1bQ"
initial_callback_url_bytes = initial_callback_url.encode('UTF-8')</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="exampleblock">
<div class="title">Example 19. <code>initialCallbackUrl</code> parameter</div>
<div class="content">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">https://rp.example.com/callback-url?value=RrKjjT4aggzu27YBddX1bQ</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="_tabs_29_qr--panel" class="tabpanel" aria-labelledby="_tabs_29_qr">
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>In case of QR flows, <code>initialCallbackUrl</code> must be empty.</p>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="unprotectedDeviceLink_parameter"><a class="anchor" href="#unprotectedDeviceLink_parameter"></a><code>unprotectedDeviceLink</code> parameter</h3>
<div id="_tabs_32" class="openblock tabs is-sync is-loading">
<div class="content">
<div class="ulist tablist">
<ul>
<li id="_tabs_32_web2app" class="tab">
<p>Web2App</p>
</li>
<li id="_tabs_32_app2app" class="tab">
<p>App2App</p>
</li>
<li id="_tabs_32_qr" class="tab">
<p>QR</p>
</li>
</ul>
</div>
<div id="_tabs_32_web2app--panel" class="tabpanel" aria-labelledby="_tabs_32_web2app">
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The final device link URL without the <code>authCode</code> field. RP must use <code>deviceLinkType = Web2App</code> for flows that start from a browser, <code>deviceLinkType = App2App</code> for flows that start from an RP app, and <code>deviceLinkType = QR</code> for cross-device flows.</p>
</div>
<div class="paragraph">
<p><code>elapsedSeconds</code> value <strong>must</strong> not be added for Web2App and App2App flows.</p>
</div>
<div class="paragraph">
<p><code>unprotectedDeviceLink</code> must be assembled as follows to be used in <code>authCodePayload</code> calculation:</p>
</div>
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">unprotectedDeviceLink := STR-CONCAT(
        deviceLinkBase, "?",
        "deviceLinkType=", deviceLinkType,
        "&amp;sessionToken=", sessionToken,
        "&amp;sessionType=", sessionType,
        "&amp;version=", version,
        "&amp;lang=", lang)</code></pre>
</div>
</div>
<div id="_tabs_33" class="openblock tabs is-sync is-loading">
<div class="content">
<div class="ulist tablist">
<ul>
<li id="_tabs_33_java" class="tab">
<p>Java</p>
</li>
<li id="_tabs_33_php" class="tab">
<p>PHP</p>
</li>
<li id="_tabs_33_python" class="tab">
<p>Python</p>
</li>
<li id="_tabs_33_go" class="tab">
<p>Go</p>
</li>
<li id="_tabs_33_rust" class="tab">
<p>Rust</p>
</li>
<li id="_tabs_33_kotlin" class="tab">
<p>Kotlin</p>
</li>
<li id="_tabs_33_c" class="tab">
<p>C#</p>
</li>
<li id="_tabs_33_node_js" class="tab">
<p>Node.js</p>
</li>
<li id="_tabs_33_ruby" class="tab">
<p>Ruby</p>
</li>
</ul>
</div>
<div id="_tabs_33_java--panel" class="tabpanel" aria-labelledby="_tabs_33_java">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public class UnprotectedDeviceLink {

  public static void main(String[] args) {

    String deviceLinkBase = "https://smart-id.com";
    String deviceLinkType = "Web2App";
    String sessionToken = "wGIrqveE6AuGDATZKmR1mtAZ";
    String sessionType = "auth";
    String version = "1.0";
    String lang = "eng";

    String unprotectedDeviceLink = deviceLinkBase + "?" +
      "deviceLinkType=" + deviceLinkType +
      "&amp;sessionToken=" + sessionToken +
      "&amp;sessionType=" + sessionType +
      "&amp;version=" + version +
      "&amp;lang=" + lang;

    System.out.println(unprotectedDeviceLink);
  }
}</code></pre>
</div>
</div>
</div>
<div id="_tabs_33_php--panel" class="tabpanel" aria-labelledby="_tabs_33_php">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-php hljs" data-lang="php">&lt;?php

$deviceLinkBase = "https://smart-id.com";
$deviceLinkType = "Web2App";
$sessionToken = "wGIrqveE6AuGDATZKmR1mtAZ";
$sessionType = "auth";
$version = "1.0";
$lang = "eng";

$unprotectedDeviceLink = $deviceLinkBase . "?" .
'deviceLinkType=' . $deviceLinkType .
'&amp;sessionToken=' . $sessionToken .
'&amp;sessionType=' . $sessionType .
'&amp;version=' . $version .
'&amp;lang=' . $lang;

echo $unprotectedDeviceLink . PHP_EOL;

?&gt;</code></pre>
</div>
</div>
</div>
<div id="_tabs_33_python--panel" class="tabpanel" aria-labelledby="_tabs_33_python">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">device_link_base = "https://smart-id.com"
device_link_type = "Web2App" # One of "Web2App", "App2App", "QR"
session_token = "wGIrqveE6AuGDATZKmR1mtAZ"
session_type = "auth"
version = "1.0"
lang = "eng"
unprotected_device_link = device_link_base + "?" + \
  "deviceLinkType=" + device_link_type + \
  "&amp;sessionToken=" + session_token + \
  "&amp;sessionType=" + session_type + \
  "&amp;version=" + version + \
  "&amp;lang=" + lang

print(unprotected_device_link)</code></pre>
</div>
</div>
</div>
<div id="_tabs_33_go--panel" class="tabpanel" aria-labelledby="_tabs_33_go">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-go hljs" data-lang="go">package main

import (
	"fmt"
	"strconv"
)

func main() {
	var deviceLinkBase string = "https://smart-id.com"
	var deviceLinkType string = "Web2App" // One of "Web2App", "App2App", "QR"
	var sessionToken string = "wGIrqveE6AuGDATZKmR1mtAZ"
	var sessionType string = "auth"
	var version string = "1.0"
	var lang string = "eng"

	var unprotectedDeviceLink string = deviceLinkBase + "?" +
		"deviceLinkType=" + deviceLinkType +
		"&amp;sessionToken=" + sessionToken +
		"&amp;sessionType=" + sessionType +
		"&amp;version=" + version +
		"&amp;lang=" + lang

	fmt.Printf("%q\n", unprotectedDeviceLink)
}</code></pre>
</div>
</div>
</div>
<div id="_tabs_33_rust--panel" class="tabpanel" aria-labelledby="_tabs_33_rust">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-rust hljs" data-lang="rust">fn main() {
    let device_link_base: &amp;str = "https://smart-id.com";
    let device_link_type: &amp;str = "Web2App"; // One of "Web2App", "App2App", "QR"
    let session_token: &amp;str = "wGIrqveE6AuGDATZKmR1mtAZ";
    let session_type: &amp;str = "auth";
    let version: &amp;str = "1.0";
    let lang: &amp;str = "eng";

    let unprotected_device_link: String = format!("{}?deviceLinkType={}&amp;sessionToken={}&amp;sessionType={}&amp;version={}&amp;lang={}", device_link_base, device_link_type, session_token, session_type, version, lang);

    println!("{}", unprotected_device_link);
}</code></pre>
</div>
</div>
</div>
<div id="_tabs_33_kotlin--panel" class="tabpanel" aria-labelledby="_tabs_33_kotlin">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">package main

fun main() {
    val deviceLinkBase: String = "https://smart-id.com"
    val deviceLinkType: String = "Web2App"
    val sessionToken: String = "wGIrqveE6AuGDATZKmR1mtAZ"
    val sessionType: String = "auth"
    val version: String = "1.0"
    val lang: String = "eng"

    val unprotectedDeviceLink: String = "$deviceLinkBase" + "?" +
      "deviceLinkType=$deviceLinkType" +
      "&amp;sessionToken=$sessionToken" +
      "&amp;sessionType=$sessionType" +
      "&amp;version=$version" +
      "&amp;lang=$lang"

    println(unprotectedDeviceLink)
}</code></pre>
</div>
</div>
</div>
<div id="_tabs_33_c--panel" class="tabpanel" aria-labelledby="_tabs_33_c">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-cs hljs" data-lang="cs">using System;

public class UnprotectedDeviceLink
{
    public static void Main(string[] args)
    {
        string deviceLinkBase = "https://smart-id.com";
        string deviceLinkType = "Web2App";
        string sessionToken = "wGIrqveE6AuGDATZKmR1mtAZ";
        string sessionType = "auth";
        string version = "1.0";
        string lang = "eng";

        string unprotectedDeviceLink = deviceLinkBase + "?" +
          "deviceLinkType=" + deviceLinkType +
          "&amp;sessionToken=" + sessionToken +
          "&amp;sessionType=" + sessionType +
          "&amp;version=" + version +
          "&amp;lang=" + lang;

        Console.WriteLine(unprotectedDeviceLink);
    }
}</code></pre>
</div>
</div>
</div>
<div id="_tabs_33_node_js--panel" class="tabpanel" aria-labelledby="_tabs_33_node_js">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-js hljs" data-lang="js">const deviceLinkBase = "https://smart-id.com";
const deviceLinkType = "Web2App";
const sessionToken = "wGIrqveE6AuGDATZKmR1mtAZ";
const sessionType = "auth";
const version = "1.0";
const lang = "eng";

const unprotectedDeviceLink = deviceLinkBase + '?' +
  'deviceLinkType=' + deviceLinkType +
  '&amp;sessionToken=' + sessionToken +
  '&amp;sessionType=' + sessionType +
  '&amp;version=' + version +
  '&amp;lang=' + lang;

console.log(unprotectedDeviceLink);</code></pre>
</div>
</div>
</div>
<div id="_tabs_33_ruby--panel" class="tabpanel" aria-labelledby="_tabs_33_ruby">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby">device_link_base = "https://smart-id.com"
device_link_type = "Web2App" # One of "Web2App", "App2App", "QR"
session_token = "wGIrqveE6AuGDATZKmR1mtAZ"
session_type = "auth"
version = "1.0"
lang = "eng"

unprotected_device_link = device_link_base + "?" +
  "deviceLinkType=" + device_link_type +
  "&amp;sessionToken=" + session_token +
  "&amp;sessionType=" + session_type +
  "&amp;version=" + version +
  "&amp;lang=" + lang

puts unprotected_device_link</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="exampleblock">
<div class="title">Example 20. <code>unprotectedDeviceLink</code> parameter (Web2App authentication)</div>
<div class="content">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">https://smart-id.com/device-link?deviceLinkType=Web2App&amp;sessionToken=wGIrqveE6AuGDATZKmR1mtAZ&amp;sessionType=auth&amp;version=1.0&amp;lang=eng</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock">
<div class="title">Example 21. <code>unprotectedDeviceLink</code> parameter (Web2App signature)</div>
<div class="content">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">https://smart-id.com/device-link?deviceLinkType=Web2App&amp;sessionToken=wGIrqveE6AuGDATZKmR1mtAZ&amp;sessionType=sign&amp;version=1.0&amp;lang=eng</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock">
<div class="title">Example 22. <code>unprotectedDeviceLink</code> parameter (Web2App certificate-choice)</div>
<div class="content">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">https://smart-id.com/device-link?deviceLinkType=Web2App&amp;sessionToken=wGIrqveE6AuGDATZKmR1mtAZ&amp;sessionType=cert&amp;version=1.0&amp;lang=eng</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="_tabs_32_app2app--panel" class="tabpanel" aria-labelledby="_tabs_32_app2app">
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The final device link URL without the <code>authCode</code> field. RP must use <code>deviceLinkType = Web2App</code> for flows that start from a browser, <code>deviceLinkType = App2App</code> for flows that start from an RP app, and <code>deviceLinkType = QR</code> for cross-device flows.</p>
</div>
<div class="paragraph">
<p><code>elapsedSeconds</code> value <strong>must</strong> not be added for Web2App and App2App flows.</p>
</div>
<div class="paragraph">
<p><code>unprotectedDeviceLink</code> must be assembled as follows to be used in <code>authCodePayload</code> calculation:</p>
</div>
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">unprotectedDeviceLink := STR-CONCAT(
        deviceLinkBase, "?",
        "deviceLinkType=", deviceLinkType,
        "&amp;sessionToken=", sessionToken,
        "&amp;sessionType=", sessionType,
        "&amp;version=", version,
        "&amp;lang=", lang)</code></pre>
</div>
</div>
<div id="_tabs_34" class="openblock tabs is-sync is-loading">
<div class="content">
<div class="ulist tablist">
<ul>
<li id="_tabs_34_java" class="tab">
<p>Java</p>
</li>
<li id="_tabs_34_php" class="tab">
<p>PHP</p>
</li>
<li id="_tabs_34_python" class="tab">
<p>Python</p>
</li>
<li id="_tabs_34_go" class="tab">
<p>Go</p>
</li>
<li id="_tabs_34_rust" class="tab">
<p>Rust</p>
</li>
<li id="_tabs_34_kotlin" class="tab">
<p>Kotlin</p>
</li>
<li id="_tabs_34_c" class="tab">
<p>C#</p>
</li>
<li id="_tabs_34_node_js" class="tab">
<p>Node.js</p>
</li>
<li id="_tabs_34_ruby" class="tab">
<p>Ruby</p>
</li>
</ul>
</div>
<div id="_tabs_34_java--panel" class="tabpanel" aria-labelledby="_tabs_34_java">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public class UnprotectedDeviceLink {

  public static void main(String[] args) {

    String deviceLinkBase = "https://smart-id.com";
    String deviceLinkType = "App2App";
    String sessionToken = "wGIrqveE6AuGDATZKmR1mtAZ";
    String sessionType = "auth";
    String version = "1.0";
    String lang = "eng";

    String unprotectedDeviceLink = deviceLinkBase + "?" +
      "deviceLinkType=" + deviceLinkType +
      "&amp;sessionToken=" + sessionToken +
      "&amp;sessionType=" + sessionType +
      "&amp;version=" + version +
      "&amp;lang=" + lang;

    System.out.println(unprotectedDeviceLink);
  }
}</code></pre>
</div>
</div>
</div>
<div id="_tabs_34_php--panel" class="tabpanel" aria-labelledby="_tabs_34_php">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-php hljs" data-lang="php">&lt;?php

$deviceLinkBase = "https://smart-id.com";
$deviceLinkType = "App2App";
$sessionToken = "wGIrqveE6AuGDATZKmR1mtAZ";
$sessionType = "auth";
$version = "1.0";
$lang = "eng";

$unprotectedDeviceLink = $deviceLinkBase . "?" .
'deviceLinkType=' . $deviceLinkType .
'&amp;sessionToken=' . $sessionToken .
'&amp;sessionType=' . $sessionType .
'&amp;version=' . $version .
'&amp;lang=' . $lang;

echo $unprotectedDeviceLink . PHP_EOL;

?&gt;</code></pre>
</div>
</div>
</div>
<div id="_tabs_34_python--panel" class="tabpanel" aria-labelledby="_tabs_34_python">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">device_link_base = "https://smart-id.com"
device_link_type = "App2App" # One of "Web2App", "App2App", "QR"
session_token = "wGIrqveE6AuGDATZKmR1mtAZ"
session_type = "auth"
version = "1.0"
lang = "eng"
unprotected_device_link = device_link_base + "?" + \
  "deviceLinkType=" + device_link_type + \
  "&amp;sessionToken=" + session_token + \
  "&amp;sessionType=" + session_type + \
  "&amp;version=" + version + \
  "&amp;lang=" + lang

print(unprotected_device_link)</code></pre>
</div>
</div>
</div>
<div id="_tabs_34_go--panel" class="tabpanel" aria-labelledby="_tabs_34_go">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-go hljs" data-lang="go">package main

import (
	"fmt"
	"strconv"
)

func main() {
	var deviceLinkBase string = "https://smart-id.com"
	var deviceLinkType string = "App2App" // One of "Web2App", "App2App", "QR"
	var sessionToken string = "wGIrqveE6AuGDATZKmR1mtAZ"
	var sessionType string = "auth"
	var version string = "1.0"
	var lang string = "eng"

	var unprotectedDeviceLink string = deviceLinkBase + "?" +
		"deviceLinkType=" + deviceLinkType +
		"&amp;sessionToken=" + sessionToken +
		"&amp;sessionType=" + sessionType +
		"&amp;version=" + version +
		"&amp;lang=" + lang

	fmt.Printf("%q\n", unprotectedDeviceLink)
}</code></pre>
</div>
</div>
</div>
<div id="_tabs_34_rust--panel" class="tabpanel" aria-labelledby="_tabs_34_rust">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-rust hljs" data-lang="rust">fn main() {
    let device_link_base: &amp;str = "https://smart-id.com";
    let device_link_type: &amp;str = "App2App"; // One of "Web2App", "App2App", "QR"
    let session_token: &amp;str = "wGIrqveE6AuGDATZKmR1mtAZ";
    let session_type: &amp;str = "auth";
    let version: &amp;str = "1.0";
    let lang: &amp;str = "eng";

    let unprotected_device_link: String = format!("{}?deviceLinkType={}&amp;sessionToken={}&amp;sessionType={}&amp;version={}&amp;lang={}", device_link_base, device_link_type, session_token, session_type, version, lang);

    println!("{}", unprotected_device_link);
}</code></pre>
</div>
</div>
</div>
<div id="_tabs_34_kotlin--panel" class="tabpanel" aria-labelledby="_tabs_34_kotlin">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">package main

fun main() {
    val deviceLinkBase: String = "https://smart-id.com"
    val deviceLinkType: String = "App2App"
    val sessionToken: String = "wGIrqveE6AuGDATZKmR1mtAZ"
    val sessionType: String = "auth"
    val version: String = "1.0"
    val lang: String = "eng"

    val unprotectedDeviceLink: String = "$deviceLinkBase" + "?" +
      "deviceLinkType=$deviceLinkType" +
      "&amp;sessionToken=$sessionToken" +
      "&amp;sessionType=$sessionType" +
      "&amp;version=$version" +
      "&amp;lang=$lang"

    println(unprotectedDeviceLink)
}</code></pre>
</div>
</div>
</div>
<div id="_tabs_34_c--panel" class="tabpanel" aria-labelledby="_tabs_34_c">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-cs hljs" data-lang="cs">using System;

public class UnprotectedDeviceLink
{
    public static void Main(string[] args)
    {
        string deviceLinkBase = "https://smart-id.com";
        string deviceLinkType = "App2App";
        string sessionToken = "wGIrqveE6AuGDATZKmR1mtAZ";
        string sessionType = "auth";
        string version = "1.0";
        string lang = "eng";

        string unprotectedDeviceLink = deviceLinkBase + "?" +
          "deviceLinkType=" + deviceLinkType +
          "&amp;sessionToken=" + sessionToken +
          "&amp;sessionType=" + sessionType +
          "&amp;version=" + version +
          "&amp;lang=" + lang;

        Console.WriteLine(unprotectedDeviceLink);
    }
}</code></pre>
</div>
</div>
</div>
<div id="_tabs_34_node_js--panel" class="tabpanel" aria-labelledby="_tabs_34_node_js">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-js hljs" data-lang="js">const deviceLinkBase = "https://smart-id.com";
const deviceLinkType = "App2App";
const sessionToken = "wGIrqveE6AuGDATZKmR1mtAZ";
const sessionType = "auth";
const version = "1.0";
const lang = "eng";

const unprotectedDeviceLink = deviceLinkBase + '?' +
  'deviceLinkType=' + deviceLinkType +
  '&amp;sessionToken=' + sessionToken +
  '&amp;sessionType=' + sessionType +
  '&amp;version=' + version +
  '&amp;lang=' + lang;

console.log(unprotectedDeviceLink);</code></pre>
</div>
</div>
</div>
<div id="_tabs_34_ruby--panel" class="tabpanel" aria-labelledby="_tabs_34_ruby">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby">device_link_base = "https://smart-id.com"
device_link_type = "App2App" # One of "Web2App", "App2App", "QR"
session_token = "wGIrqveE6AuGDATZKmR1mtAZ"
session_type = "auth"
version = "1.0"
lang = "eng"

unprotected_device_link = device_link_base + "?" +
  "deviceLinkType=" + device_link_type +
  "&amp;sessionToken=" + session_token +
  "&amp;sessionType=" + session_type +
  "&amp;version=" + version +
  "&amp;lang=" + lang

puts unprotected_device_link</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="exampleblock">
<div class="title">Example 23. <code>unprotectedDeviceLink</code> parameter (App2App authentication)</div>
<div class="content">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">https://smart-id.com/device-link?deviceLinkType=App2App&amp;sessionToken=wGIrqveE6AuGDATZKmR1mtAZ&amp;sessionType=auth&amp;version=1.0&amp;lang=eng</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock">
<div class="title">Example 24. <code>unprotectedDeviceLink</code> parameter (App2App signature)</div>
<div class="content">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">https://smart-id.com/device-link?deviceLinkType=App2App&amp;sessionToken=wGIrqveE6AuGDATZKmR1mtAZ&amp;sessionType=sign&amp;version=1.0&amp;lang=eng</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock">
<div class="title">Example 25. <code>unprotectedDeviceLink</code> parameter (App2App certificate-choice)</div>
<div class="content">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">https://smart-id.com/device-link?deviceLinkType=App2App&amp;sessionToken=wGIrqveE6AuGDATZKmR1mtAZ&amp;sessionType=cert&amp;version=1.0&amp;lang=eng</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="_tabs_32_qr--panel" class="tabpanel" aria-labelledby="_tabs_32_qr">
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The final device link URL without the <code>authCode</code> field. RP must use <code>deviceLinkType = Web2App</code> for flows that start from a browser, <code>deviceLinkType = App2App</code> for flows that start from an RP app, and <code>deviceLinkType = QR</code> for cross-device flows.</p>
</div>
<div class="paragraph">
<p><code>elapsedSeconds</code> value <strong>must</strong> not be added for Web2App and App2App flows.</p>
</div>
<div class="paragraph">
<p><code>unprotectedDeviceLink</code> must be assembled as follows to be used in <code>authCodePayload</code> calculation:</p>
</div>
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">unprotectedDeviceLink := STR-CONCAT(
        deviceLinkBase, "?",
        "deviceLinkType=", deviceLinkType,
        "&amp;elapsedSeconds=", TO-STRING(elapsedSeconds),
        "&amp;sessionToken=", sessionToken,
        "&amp;sessionType=", sessionType,
        "&amp;version=", version,
        "&amp;lang=", lang)</code></pre>
</div>
</div>
<div id="_tabs_35" class="openblock tabs is-sync is-loading">
<div class="content">
<div class="ulist tablist">
<ul>
<li id="_tabs_35_java" class="tab">
<p>Java</p>
</li>
<li id="_tabs_35_php" class="tab">
<p>PHP</p>
</li>
<li id="_tabs_35_python" class="tab">
<p>Python</p>
</li>
<li id="_tabs_35_go" class="tab">
<p>Go</p>
</li>
<li id="_tabs_35_rust" class="tab">
<p>Rust</p>
</li>
<li id="_tabs_35_kotlin" class="tab">
<p>Kotlin</p>
</li>
<li id="_tabs_35_c" class="tab">
<p>C#</p>
</li>
<li id="_tabs_35_node_js" class="tab">
<p>Node.js</p>
</li>
<li id="_tabs_35_ruby" class="tab">
<p>Ruby</p>
</li>
</ul>
</div>
<div id="_tabs_35_java--panel" class="tabpanel" aria-labelledby="_tabs_35_java">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public class UnprotectedDeviceLink {

  public static void main(String[] args) {

    String deviceLinkBase = "https://smart-id.com";
    String deviceLinkType = "QR";
    int elapsedSeconds = 22;
    String sessionToken = "wGIrqveE6AuGDATZKmR1mtAZ";
    String sessionType = "auth";
    String version = "1.0";
    String lang = "eng";

    String unprotectedDeviceLink = deviceLinkBase + "?" +
      "deviceLinkType=" + deviceLinkType +
      "&amp;elapsedSeconds=" + elapsedSeconds +
      "&amp;sessionToken=" + sessionToken +
      "&amp;sessionType=" + sessionType +
      "&amp;version=" + version +
      "&amp;lang=" + lang;

    System.out.println(unprotectedDeviceLink);
  }
}</code></pre>
</div>
</div>
</div>
<div id="_tabs_35_php--panel" class="tabpanel" aria-labelledby="_tabs_35_php">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-php hljs" data-lang="php">&lt;?php

$deviceLinkBase = "https://smart-id.com";
$deviceLinkType = "QR";
$elapsedSeconds = 22;
$sessionToken = "wGIrqveE6AuGDATZKmR1mtAZ";
$sessionType = "auth";
$version = "1.0";
$lang = "eng";

$unprotectedDeviceLink = $deviceLinkBase . "?" .
'deviceLinkType=' . $deviceLinkType .
'&amp;elapsedSeconds=' . $elapsedSeconds .
'&amp;sessionToken=' . $sessionToken .
'&amp;sessionType=' . $sessionType .
'&amp;version=' . $version .
'&amp;lang=' . $lang;

echo $unprotectedDeviceLink . PHP_EOL;

?&gt;</code></pre>
</div>
</div>
</div>
<div id="_tabs_35_python--panel" class="tabpanel" aria-labelledby="_tabs_35_python">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">device_link_base = "https://smart-id.com"
device_link_type = "QR"
elapsed_seconds = 22
session_token = "wGIrqveE6AuGDATZKmR1mtAZ"
session_type = "auth"
version = "1.0"
lang = "eng"
unprotected_device_link = device_link_base + "?" + \
  "deviceLinkType=" + device_link_type + \
  "&amp;elapsedSeconds=" + str(elapsed_seconds) + \
  "&amp;sessionToken=" + session_token + \
  "&amp;sessionType=" + session_type + \
  "&amp;version=" + version + \
  "&amp;lang=" + lang

print(unprotected_device_link)</code></pre>
</div>
</div>
</div>
<div id="_tabs_35_go--panel" class="tabpanel" aria-labelledby="_tabs_35_go">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-go hljs" data-lang="go">package main

import (
	"fmt"
	"strconv"
)

func main() {
	var deviceLinkBase string = "https://smart-id.com"
	var deviceLinkType string = "QR"
	var elapsedSeconds int = 22
	var sessionToken string = "wGIrqveE6AuGDATZKmR1mtAZ"
	var sessionType string = "auth"
	var version string = "1.0"
	var lang string = "eng"

	var unprotectedDeviceLink string = deviceLinkBase + "?" +
		"deviceLinkType=" + deviceLinkType +
		"&amp;elapsedSeconds=" + strconv.Itoa(elapsedSeconds) +
		"&amp;sessionToken=" + sessionToken +
		"&amp;sessionType=" + sessionType +
		"&amp;version=" + version +
		"&amp;lang=" + lang

	fmt.Printf("%q\n", unprotectedDeviceLink)
}</code></pre>
</div>
</div>
</div>
<div id="_tabs_35_rust--panel" class="tabpanel" aria-labelledby="_tabs_35_rust">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-rust hljs" data-lang="rust">fn main() {
    let device_link_base: &amp;str = "https://smart-id.com";
    let device_link_type: &amp;str = "QR";
    let elapsed_seconds: i32 = 22;
    let session_token: &amp;str = "wGIrqveE6AuGDATZKmR1mtAZ";
    let session_type: &amp;str = "auth";
    let version: &amp;str = "1.0";
    let lang: &amp;str = "eng";

    let unprotected_device_link: String = format!("{}?deviceLinkType={}&amp;elapsedSeconds={}&amp;sessionToken={}&amp;sessionType={}&amp;version={}&amp;lang={}", device_link_base, device_link_type, elapsed_seconds, session_token, session_type, version, lang);

    println!("{}", unprotected_device_link);
}</code></pre>
</div>
</div>
</div>
<div id="_tabs_35_kotlin--panel" class="tabpanel" aria-labelledby="_tabs_35_kotlin">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">package main

fun main() {
    val deviceLinkBase: String = "https://smart-id.com"
    val deviceLinkType: String = "QR"
    val elapsedSeconds: Int = 22
    val sessionToken: String = "wGIrqveE6AuGDATZKmR1mtAZ"
    val sessionType: String = "auth"
    val version: String = "1.0"
    val lang: String = "eng"

    val unprotectedDeviceLink: String = "$deviceLinkBase" + "?" +
      "deviceLinkType=$deviceLinkType" +
      "&amp;elapsedSeconds=$elapsedSeconds" +
      "&amp;sessionToken=$sessionToken" +
      "&amp;sessionType=$sessionType" +
      "&amp;version=$version" +
      "&amp;lang=$lang"

    println(unprotectedDeviceLink)
}</code></pre>
</div>
</div>
</div>
<div id="_tabs_35_c--panel" class="tabpanel" aria-labelledby="_tabs_35_c">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-cs hljs" data-lang="cs">using System;

public class UnprotectedDeviceLink
{
    public static void Main(string[] args)
    {
        string deviceLinkBase = "https://smart-id.com";
        string deviceLinkType = "QR";
        int elapsedSeconds = 22;
        string sessionToken = "wGIrqveE6AuGDATZKmR1mtAZ";
        string sessionType = "auth";
        string version = "1.0";
        string lang = "eng";

        string unprotectedDeviceLink = deviceLinkBase + "?" +
          "deviceLinkType=" + deviceLinkType +
          "&amp;elapsedSeconds=" + elapsedSeconds.ToString() +
          "&amp;sessionToken=" + sessionToken +
          "&amp;sessionType=" + sessionType +
          "&amp;version=" + version +
          "&amp;lang=" + lang;

        Console.WriteLine(unprotectedDeviceLink);
    }
}</code></pre>
</div>
</div>
</div>
<div id="_tabs_35_node_js--panel" class="tabpanel" aria-labelledby="_tabs_35_node_js">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-js hljs" data-lang="js">const deviceLinkBase = "https://smart-id.com";
const deviceLinkType = "QR";
const elapsedSeconds = 22;
const sessionToken = "wGIrqveE6AuGDATZKmR1mtAZ";
const sessionType = "auth";
const version = "1.0";
const lang = "eng";

const unprotectedDeviceLink = deviceLinkBase + '?' +
  'deviceLinkType=' + deviceLinkType +
  '&amp;elapsedSeconds=' + elapsedSeconds +
  '&amp;sessionToken=' + sessionToken +
  '&amp;sessionType=' + sessionType +
  '&amp;version=' + version +
  '&amp;lang=' + lang;

console.log(unprotectedDeviceLink);</code></pre>
</div>
</div>
</div>
<div id="_tabs_35_ruby--panel" class="tabpanel" aria-labelledby="_tabs_35_ruby">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby">device_link_base = "https://smart-id.com"
device_link_type = "QR"
elapsed_seconds = 22
session_token = "wGIrqveE6AuGDATZKmR1mtAZ"
session_type = "auth"
version = "1.0"
lang = "eng"

unprotected_device_link = device_link_base + "?" +
  "deviceLinkType=" + device_link_type +
  "&amp;elapsedSeconds=" + elapsed_seconds.to_s +
  "&amp;sessionToken=" + session_token +
  "&amp;sessionType=" + session_type +
  "&amp;version=" + version +
  "&amp;lang=" + lang

puts unprotected_device_link</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="exampleblock">
<div class="title">Example 26. <code>unprotectedDeviceLink</code> parameter (QR authentication)</div>
<div class="content">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">https://smart-id.com/device-link?deviceLinkType=QR&amp;elapsedSeconds=22&amp;sessionToken=wGIrqveE6AuGDATZKmR1mtAZ&amp;sessionType=auth&amp;version=1.0&amp;lang=eng</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock">
<div class="title">Example 27. <code>unprotectedDeviceLink</code> parameter (QR signature)</div>
<div class="content">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">https://smart-id.com/device-link?deviceLinkType=QR&amp;elapsedSeconds=22&amp;sessionToken=wGIrqveE6AuGDATZKmR1mtAZ&amp;sessionType=sign&amp;version=1.0&amp;lang=eng</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock">
<div class="title">Example 28. <code>unprotectedDeviceLink</code> parameter (QR certificate-choice)</div>
<div class="content">
<div class="listingblock wrap">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">https://smart-id.com/device-link?deviceLinkType=QR&amp;elapsedSeconds=22&amp;sessionToken=wGIrqveE6AuGDATZKmR1mtAZ&amp;sessionType=cert&amp;version=1.0&amp;lang=eng</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_authcode_validation_form"><a class="anchor" href="#_authcode_validation_form"></a><code>authCode</code> validation form</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The following web form can be used to validate <code>authCode</code> values.</p>
</div>
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AuthCode Calculator</title>
    <style>
      .authcode-calculator {
        --calc-white: #fff;
        --calc-smoke-30: #fafafa;
        --calc-smoke-90: #e1e1e1;
        --calc-gray-30: #9c9c9c;
        --calc-gray-70: #5d5d5d;
        --calc-jet-70: #222;
        --calc-jet-80: #191919;
        --calc-main-color: #ff3c12;
        --calc-accent-color: #e97257;
        --calc-validation-error-color: #e33;
        --calc-validation-error-background-color: #fee;
        --calc-match-color: #390;
        --calc-match-background-color: #d4edda;
        line-height: 1.6;
        margin: 0;
        padding: 20px;
        background-color: var(--calc-smoke-90);
        color: var(--calc-main-color);
        display: flex;
        flex-direction: column;
        align-items: center;
        box-sizing: border-box;
      }

      .authcode-calculator .container {
        background-color: var(--calc-white);
        padding: 25px;
        border-radius: 12px;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        width: 100%;
        max-width: none;
        min-width: 450px;
      }

      .authcode-calculator h2 {
        color: var(--calc-main-color);
        text-align: center;
        margin-top: 0;
        margin-bottom: 25px;
      }

      .authcode-calculator fieldset {
        border: none;
      }

      .authcode-calculator fieldset label {
        display: inline-block;
        font-weight: normal;
      }

      .authcode-calculator label {
        display: block;
        margin-bottom: 8px;
        font-weight: 600;
        color: var(--calc-gray-70);
      }

      .authcode-calculator label.required::after {
        content: " *";
        color: var(--calc-validation-error-color);
        font-weight: bold;
      }

      .authcode-calculator input[type="text"],
      .authcode-calculator textarea,
      .authcode-calculator select {
        width: calc(100% - 24px);
        padding: 12px;
        border: 1px solid var(--calc-gray-30);
        border-radius: 6px;
        box-sizing: border-box;
        font-size: 16px;
        transition: border-color 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
        background-color: var(--calc-white);
      }

      .authcode-calculator input[type="text"]:focus,
      .authcode-calculator textarea:focus,
      .authcode-calculator select:focus {
        border-color: var(--calc-main-color);
        box-shadow: 0 0 0 2px rgba(0, 123, 255, 0.25);
        outline: none;
      }

      .authcode-calculator textarea {
        resize: vertical;
        min-height: 120px;
      }

      .authcode-calculator .form-group {
        margin-bottom: 18px;
        max-width: 480px;
        margin-left: auto;
        margin-right: auto;
      }

      .authcode-calculator .hidden {
        display: none !important;
      }

      .authcode-calculator .validation-error {
        color: var(--calc-validation-error-color);
        font-size: 0.9em;
        margin-top: 4px;
        display: block;
        min-height: 1.2em;
      }

      .authcode-calculator input.invalid,
      .authcode-calculator textarea.invalid,
      .authcode-calculator select.invalid {
        border-color: var(--calc-validation-error-color) !important;
      }

      .authcode-calculator button {
        background-color: var(--calc-main-color);
        color: var(--calc-white);
        padding: 12px 20px;
        border: none;
        border-radius: 6px;
        cursor: pointer;
        font-size: 16px;
        font-weight: 600;
        width: 100%;
        transition: background-color 0.3s ease;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        max-width: 480px;
        margin-left: auto;
        margin-right: auto;
        display: block;
      }

      .authcode-calculator button:hover {
        background-color: var(--calc-accent-color);
      }

      .authcode-calculator button:active {
        background-color: var(--calc-main-color);
      }

      .authcode-calculator #results {
        margin-top: 25px;
        padding: 15px;
        border: 1px dashed var(--calc-smoke-90);
        border-radius: 6px;
        justify-content: center;
        align-items: center;
        min-height: 100px;
        background-color: var(--calc-smoke-30);
      }

      .authcode-calculator #results code {
        display: block;
        background-color: var(--calc-smoke-90);
        color: var(--calc-jet-70);
        padding: 10px;
        margin-top: 8px;
        border-radius: 4px;
        word-wrap: break-word;
        white-space: pre-wrap;
        font-size: 0.95em;
        border: 1px solid var(--calc-gray-30);
      }

      .authcode-calculator #results p {
        margin-bottom: 10px;
        color: var(--calc-jet-70);
      }

      .authcode-calculator #comparisonResult {
        font-weight: bold;
        padding: 3px 6px;
        border-radius: 3px;
        display: inline-block;
        margin-top: 5px;
      }

      .authcode-calculator .match {
        color: var(--calc-match-color);
        background-color: var(--calc-match-background-color);
        font-weight: bold;
        border: 1px solid var(--calc-match-color);
      }

      .authcode-calculator .mismatch {
        color: var(--calc-validation-error-color);
        font-weight: bold;
        background-color: var(--calc-validation-error-background-color);
        border: 1px solid var(--calc-validation-error-color);
      }
    </style>
  </head>
  <body>
    <div class="authcode-calculator">
      <div class="container">
        <h2>AuthCode Calculator & Comparator</h2>
        <div class="form-group">
          <label class="required">Session Type:</label>
          <fieldset>
            <input type="radio" id="sessionAuth" name="sessionType" value="authentication" checked>
            <label for="sessionAuth">Authentication</label>
            <input type="radio" id="sessionSign" name="sessionType" value="signature">
            <label for="sessionSign">Signature</label>
            <input type="radio" id="sessionCert" name="sessionType" value="certificate-choice">
            <label for="sessionCert">Certificate-Choice</label>
          </fieldset>
        </div>
        <div class="form-group">
          <label for="sessionSecretBase64" class="required">Session Secret (Base64):</label>
          <input type="text" id="sessionSecretBase64" value="B98ODiVCebRedSwdTk51zFSaGYyHtY1H2A0ocAi3/Ps=">
          <span id="sessionSecretBase64-error" class="validation-error"></span>
        </div>
        <div class="form-group">
          <label for="schemeName" class="required">Scheme Name:</label>
          <input type="text" id="schemeName" value="smart-id">
          <span id="schemeName-error" class="validation-error"></span>
        </div>
        <div class="form-group" id="signatureProtocolGroup">
          <label for="signatureProtocol" id="signatureProtocolLabel" class="required">Signature Protocol:</label>
          <select id="signatureProtocol" disabled>
            <option value="ACSP_V2" selected>ACSP_V2</option>
          </select>
          <span id="signatureProtocol-error" class="validation-error"></span>
        </div>
        <div class="form-group" id="challengeDigestGroup">
          <label for="challengeOrDigest" id="challengeOrDigestLabel" class="required">RP Challenge (Base64):</label>
          <input type="text" id="challengeOrDigest" value="GYS+yoah6emAcVDNIajwSs6UB/M95XrDxMzXBUkwQJ9YFDipXXzGpPc7raWcuc2+TEoRc7WvIZ/7dU/iRXenYg==">
          <span id="challengeOrDigest-error" class="validation-error"></span>
        </div>
        <div class="form-group">
          <label for="relyingPartyName" class="required">Relying Party Name:</label>
          <input type="text" id="relyingPartyName" value="DEMO">
          <span id="relyingPartyName-error" class="validation-error"></span>
        </div>
        <div id="brokeredRpContainer" class="form-group">
          <label for="brokeredRpName">Brokered RP Name:</label>
          <input type="text" id="brokeredRpName" value="Example RP">
          <span id="brokeredRpName-error" class="validation-error"></span>
        </div>
        <div class="form-group" id="interactionsGroup">
          <label for="interactions" id="interactionsLabel" class="required">Interactions (Base64 JSON):</label>
          <textarea id="interactions">W3sidHlwZSI6ImNvbmZpcm1hdGlvbk1lc3NhZ2UiLCJkaXNwbGF5VGV4dDIwMCI6IkxvbmdlciBkZXNjcmlwdGlvbiBvZiB0aGUgdHJhbnNhY3Rpb24gY29udGV4dCJ9LHsidHlwZSI6ImRpc3BsYXlUZXh0QW5kUElOIiwiZGlzcGxheVRleHQ2MCI6IlNob3J0IGRlc2NyaXB0aW9uIG9mIHRoZSB0cmFuc2FjdGlvbiBjb250ZXh0In1d</textarea>
          <span id="interactions-error" class="validation-error"></span>
        </div>
        <div class="form-group" id="initialCallbackUrlGroup">
          <label for="initialCallbackUrl">Initial Callback URL:</label>
          <input type="text" id="initialCallbackUrl" value="https://rp.example.com/callback-url?value=RrKjjT4aggzu27YBddX1bQ">
          <span id="initialCallbackUrl-error" class="validation-error"></span>
        </div>
        <div class="form-group">
          <label for="unprotectedDeviceLink" class="required">Unprotected Device Link:</label>
          <input type="text" id="unprotectedDeviceLink" value="https://smart-id.com/device-link?deviceLinkType=Web2App&amp;sessionToken=wGIrqveE6AuGDATZKmR1mtAZ&amp;sessionType=auth&amp;version=1.0&amp;lang=eng">
          <span id="unprotectedDeviceLink-error" class="validation-error"></span>
        </div>
        <hr>
        <div class="form-group">
          <label for="authCodeInput">Auth Code (User Input - Compare Against):</label>
          <input type="text" id="authCodeInput" placeholder="Enter the Auth Code to compare">
          <span id="authCodeInput-error" class="validation-error"></span>
        </div>
        <button type="button" id="calculateButton">Calculate & Compare AuthCode</button>
        <div id="results" class="hidden">
          <h2>Results</h2>
          <p>
            <strong>Calculated Auth Code (Base64URL):</strong>
          </p>
          <span>
            <code id="calculatedAuthCode"></code>
          </span>
          <p>
            <strong>Comparison Result:</strong>
            <span id="comparisonResult"></span>
          </p>
          <p>
            <strong>Payload Used for Calculation (Processed):</strong>
          </p>
          <span>
            <code id="payloadUsed"></code>
          </span>
        </div>
      </div>
    </div>
    <script>
      const separator = '|';
      const calculatorContainer = document.querySelector('.authcode-calculator');
      const form = document.getElementById('authForm');
      const sessionTypeRadios = calculatorContainer.querySelectorAll('input[name="sessionType"]');
      const sessionSecretInput = document.getElementById('sessionSecretBase64');
      const schemeNameInput = document.getElementById('schemeName');
      const signatureProtocolGroup = document.getElementById('signatureProtocolGroup');
      const signatureProtocolLabel = document.getElementById('signatureProtocolLabel');
      const signatureProtocolSelect = document.getElementById('signatureProtocol');
      const challengeDigestGroup = document.getElementById('challengeDigestGroup');
      const challengeOrDigestLabel = document.getElementById('challengeOrDigestLabel');
      const challengeOrDigestInput = document.getElementById('challengeOrDigest');
      const relyingPartyNameInput = document.getElementById('relyingPartyName');
      const brokeredRpContainer = document.getElementById('brokeredRpContainer');
      const brokeredRpNameInput = document.getElementById('brokeredRpName');
      const brokeredRpNameLabel = brokeredRpContainer.querySelector('label');
      const interactionsGroup = document.getElementById('interactionsGroup');
      const interactionsLabel = document.getElementById('interactionsLabel');
      const interactionsInput = document.getElementById('interactions');
      const initialCallbackUrlGroup = document.getElementById('initialCallbackUrlGroup');
      const initialCallbackUrlInput = document.getElementById('initialCallbackUrl');
      const unprotectedDeviceLinkInput = document.getElementById('unprotectedDeviceLink');
      const authCodeInput = document.getElementById('authCodeInput');
      const calculateButton = document.getElementById('calculateButton');
      const resultsDiv = calculatorContainer.querySelector('#results');
      const calculatedAuthCodeElement = document.getElementById('calculatedAuthCode');
      const comparisonResultElement = document.getElementById('comparisonResult');
      const payloadUsedElement = document.getElementById('payloadUsed');

      function base64ToUint8Array(base64) {
        try {
          const binaryString = atob(base64);
          const len = binaryString.length;
          const bytes = new Uint8Array(len);
          for (let i = 0; i < len; i++) {
            bytes[i] = binaryString.charCodeAt(i);
          }
          return bytes;
        } catch (e) {
          console.error("Failed to decode input sessionSecret string:", e);
          throw new Error("Failed to decode input sessionSecret string.");
        }
      }

      function arrayBufferToBase64Url(buffer) {
        const bytes = new Uint8Array(buffer);
        let binary = '';
        for (let i = 0; i < bytes.byteLength; i++) {
          binary += String.fromCharCode(bytes[i]);
        }
        let base64 = btoa(binary);
        return base64.replace(/\+/g, '-').replace(/\//g, '_').replace(/=+$/, '');
      }

      function utf8ToBase64(str) {
        try {
          const bytes = new TextEncoder().encode(str);
          let binaryString = '';
          bytes.forEach(byte => {
            binaryString += String.fromCharCode(byte);
          });
          return btoa(binaryString);
        } catch (e) {
          console.error("Failed to encode string to Base64:", str, e);
          throw new Error("Could not encode one of the name fields to Base64.");
        }
      }

      function updateSignatureProtocol() {
        const sessionType = calculatorContainer.querySelector('input[name="sessionType"]:checked').value;
        if (sessionType === 'certificate-choice') {
          signatureProtocolLabel.classList.remove('required');
          signatureProtocolGroup.classList.add('hidden');
        } else if (sessionType === 'signature') {
          signatureProtocolLabel.classList.add('required');
          signatureProtocolSelect.innerHTML = '';
          const option = document.createElement('option');
          option.value = 'RAW_DIGEST_SIGNATURE';
          option.textContent = 'RAW_DIGEST_SIGNATURE';
          signatureProtocolSelect.appendChild(option);
          signatureProtocolGroup.classList.remove('hidden');
        } else if (sessionType === 'authentication') {
          signatureProtocolLabel.classList.add('required');
          signatureProtocolSelect.innerHTML = '';
          const option = document.createElement('option');
          option.value = 'ACSP_V2';
          option.textContent = 'ACSP_V2';
          signatureProtocolSelect.appendChild(option);
          signatureProtocolGroup.classList.remove('hidden');
        }
        if (signatureProtocolGroup.classList.contains('hidden')) {
          clearValidationError(initialCallbackUrlInput);
        }
      }

      function updateFormForSessionType() {
        const selectedType = calculatorContainer.querySelector('input[name="sessionType"]:checked').value;
        signatureProtocolGroup.classList.remove('hidden');
        signatureProtocolLabel.classList.add('required');
        updateSignatureProtocol();
        challengeDigestGroup.classList.remove('hidden');
        challengeOrDigestLabel.classList.add('required');
        interactionsGroup.classList.remove('hidden');
        interactionsLabel.classList.add('required');
        initialCallbackUrlGroup.classList.remove('hidden');
        brokeredRpNameLabel.classList.remove('required');
        clearAllValidation();
        switch (selectedType) {
          case 'authentication':
            challengeOrDigestLabel.textContent = 'RP Challenge (Base64):';
            challengeOrDigestLabel.classList.add('required');
            interactionsLabel.classList.add('required');
            signatureProtocolLabel.classList.add('required');
            break;
          case 'signature':
            challengeOrDigestLabel.textContent = 'Digest (Base64):';
            challengeOrDigestLabel.classList.add('required');
            interactionsLabel.classList.add('required');
            signatureProtocolLabel.classList.add('required');
            break;
          case 'certificate-choice':
            challengeDigestGroup.classList.add('hidden');
            challengeOrDigestLabel.classList.remove('required');
            interactionsGroup.classList.add('hidden');
            interactionsLabel.classList.remove('required');
            signatureProtocolGroup.classList.add('hidden');
            signatureProtocolLabel.classList.remove('required');
            break;
        }
      }

      function clearValidationError(inputElement) {
        const errorEl = calculatorContainer.querySelector(`#${ inputElement.id }-error`);
        if (errorEl) errorEl.textContent = '';
        inputElement.classList.remove('invalid');
      }

      function clearAllValidation() {
        calculatorContainer.querySelectorAll('.validation-error').forEach(el => el.textContent = '');
        calculatorContainer.querySelectorAll('input, textarea, select').forEach(el => el.classList.remove('invalid'));
      }

      function isBase64(str) {
        if (str === '' || str.trim() === '') {
          return false;
        }
        try {
          return btoa(atob(str)) == str;
        } catch (err) {
          return false;
        }
      }

      function validateForm() {
        let isValid = true;
        clearAllValidation();
        const sessionType = calculatorContainer.querySelector('input[name="sessionType"]:checked').value;
        const checkField = (field) => {
          const {
            el,
            name
          } = field;
          if (!el.closest('.form-group, #brokeredRpContainer')?.classList.contains('hidden')) {
            if (!el.value.trim()) {
              isValid = false;
              const errorEl = calculatorContainer.querySelector(`#${ el.id }-error`);
              if (errorEl) errorEl.textContent = `${ name } is required.`;
              el.classList.add('invalid');
            }
          }
        };
        const isBase64 = (field) => {
          const {
            el,
            name
          } = field;
          if (el.value === '' || el.value.trim() === '') {
            isValid = false;
            const errorEl = calculatorContainer.querySelector(`#${ el.id }-error`);
            if (errorEl) errorEl.textContent = `${ name } must be Base64 encoded.`;
            el.classList.add('invalid');
          }
          try {
            return btoa(atob(el.value)) == el.value;
          } catch (err) {
            isValid = false;
            const errorEl = calculatorContainer.querySelector(`#${ el.id }-error`);
            if (errorEl) errorEl.textContent = `${ name } must be Base64 encoded.`;
            el.classList.add('invalid');
          }
        };
        checkField({
          el: sessionSecretInput,
          name: "Session Secret"
        });
        isBase64({
          el: sessionSecretInput,
          name: "Session Secret"
        });
        checkField({
          el: schemeNameInput,
          name: "Scheme Name"
        });
        checkField({
          el: relyingPartyNameInput,
          name: "Relying Party Name"
        });
        checkField({
          el: unprotectedDeviceLinkInput,
          name: "Unprotected Device Link"
        });
        if (sessionType === 'authentication') {
          checkField({
            el: signatureProtocolSelect,
            name: "Signature Protocol"
          });
          checkField({
            el: challengeOrDigestInput,
            name: "RP Challenge"
          });
          checkField({
            el: interactionsInput,
            name: "Interactions"
          });
        } else if (sessionType === 'signature') {
          checkField({
            el: signatureProtocolSelect,
            name: "Signature Protocol"
          });
          checkField({
            el: challengeOrDigestInput,
            name: "Digest"
          });
          checkField({
            el: interactionsInput,
            name: "Interactions"
          });
        }
        return isValid;
      }
      async function calculateAndCompareAuthCode() {
        if (!validateForm()) {
          alert("Please check all required fields indicated by *.");
          resultsDiv.classList.add('hidden');
          return;
        }
        resultsDiv.classList.add('hidden');
        calculatedAuthCodeElement.textContent = '';
        comparisonResultElement.textContent = '';
        payloadUsedElement.textContent = '';
        try {
          const sessionType = calculatorContainer.querySelector('input[name="sessionType"]:checked').value;
          const sessionSecretBase64 = sessionSecretInput.value.trim();
          const schemeName = schemeNameInput.value;
          const relyingPartyName = relyingPartyNameInput.value;
          const includeBrokeredRp = true;
          const brokeredRpName = includeBrokeredRp ? brokeredRpNameInput.value : '';
          let initialCallbackUrl = initialCallbackUrlInput.value;
          const unprotectedDeviceLink = unprotectedDeviceLinkInput.value;
          const userInputAuthCode = authCodeInput.value.trim();
          const relyingPartyNameBase64 = utf8ToBase64(relyingPartyName);
          const brokeredRpNameBase64 = includeBrokeredRp ? utf8ToBase64(brokeredRpName) : '';
          let authCodePayloadArray = [];
          let signatureProtocol = '';
          let challengeOrDigest = '';
          let interactions = '';
          switch (sessionType) {
            case 'authentication':
              signatureProtocol = signatureProtocolSelect.value;
              // signatureProtocol = 'ACSP_V2';
              challengeOrDigest = challengeOrDigestInput.value;
              interactions = interactionsInput.value;
              authCodePayloadArray = [schemeName, signatureProtocol, challengeOrDigest, relyingPartyNameBase64];
              authCodePayloadArray.push(brokeredRpNameBase64);
              authCodePayloadArray.push(interactions, initialCallbackUrl, unprotectedDeviceLink);
              break;
            case 'signature':
              signatureProtocol = signatureProtocolSelect.value;
              // signatureProtocol = 'RAW_DIGEST_SIGNATURE';
              challengeOrDigest = challengeOrDigestInput.value;
              interactions = interactionsInput.value;
              authCodePayloadArray = [schemeName, signatureProtocol, challengeOrDigest, relyingPartyNameBase64];
              authCodePayloadArray.push(brokeredRpNameBase64);
              authCodePayloadArray.push(interactions, initialCallbackUrl, unprotectedDeviceLink);
              break;
            case 'certificate-choice':
              signatureProtocol = '';
              challengeOrDigest = '';
              interactions = '';
              authCodePayloadArray = [schemeName, signatureProtocol, challengeOrDigest, relyingPartyNameBase64];
              authCodePayloadArray.push(brokeredRpNameBase64);
              authCodePayloadArray.push(interactions, initialCallbackUrl, unprotectedDeviceLink);
              break;
          }
          const authCodePayload = authCodePayloadArray.join(separator);
          payloadUsedElement.textContent = authCodePayload;
          const sessionSecretBytes = base64ToUint8Array(sessionSecretBase64);
          const payloadBytes = new TextEncoder().encode(authCodePayload);
          const cryptoKey = await window.crypto.subtle.importKey('raw', sessionSecretBytes, {
            name: 'HMAC',
            hash: 'SHA-256'
          }, false, ['sign']);
          const signatureBuffer = await window.crypto.subtle.sign('HMAC', cryptoKey, payloadBytes);
          const calculatedAuthCode = arrayBufferToBase64Url(signatureBuffer);
          calculatedAuthCodeElement.textContent = calculatedAuthCode;
          if (!userInputAuthCode) {
            comparisonResultElement.textContent = "Enter an Auth Code above to compare.";
            comparisonResultElement.className = "";
          } else if (calculatedAuthCode === userInputAuthCode) {
            comparisonResultElement.textContent = "Match!";
            comparisonResultElement.className = "match";
          } else {
            comparisonResultElement.textContent = "Mismatch!";
            comparisonResultElement.className = "mismatch";
          }
          resultsDiv.classList.remove('hidden');
        } catch (error) {
          console.error("Error during AuthCode calculation:", error);
          alert(`An error occurred during calculation: ${ error.message }. Check the console for details.`);
          resultsDiv.classList.add('hidden');
        }
      }
      if (calculatorContainer) {
        updateFormForSessionType();
        sessionTypeRadios.forEach(radio => radio.addEventListener('change', updateFormForSessionType));
        calculateButton.addEventListener('click', calculateAndCompareAuthCode);
      } else {
        console.error("Calculator container '.authcode-calculator' not found.");
      }
    </script>
  </body>
</html>
</div>
</div>
</article>
  </div>
</main>
</div>
<footer class="footer">
  <p> 2026 SK ID Solutions AS</p>
</footer>
<script id="site-script" src="../../_/js/site.js" data-ui-root-path="../../_"></script>
<script async src="../../_/js/vendor/highlight.js"></script>
<script async src="../../_/js/vendor/tabs.js" data-sync-storage-key="language"></script>
<script src="../../_/js/vendor/lunr.js"></script>
<script src="../../_/js/search-ui.js" id="search-ui-script" data-site-root-path="../.." data-snippet-length="100" data-stylesheet="../../_/css/search.css"></script>
<script async src="../../search-index.js"></script>
  </body>
</html>
